/home/admin_/.local/lib/python3.12/site-packages/pydantic/_internal/_fields.py:198: UserWarning: Field name "schema" in "DemoAssetsResponse" shadows an attribute in parent "BaseModel"
  warnings.warn(
/home/admin_/final_demo/capi/demo-gen-capi/backend/api.py:227: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [22087]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 10 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for customer_segments...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ customer_segments: 50 rows → /tmp/synthetic_data/customer_segments.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for campaigns...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ campaigns: 800 rows → /tmp/synthetic_data/campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for product_launch_events...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ product_launch_events: 800 rows → /tmp/synthetic_data/product_launch_events.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for forecasts...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ forecasts: 800 rows → /tmp/synthetic_data/forecasts.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for products...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ products: 3,000 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for customers...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for inventory...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ inventory: 3,500 rows → /tmp/synthetic_data/inventory.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for orders...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for order_items...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ order_items: 3,500 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for daily_sales_summary...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ daily_sales_summary: 15,000 rows → /tmp/synthetic_data/daily_sales_summary.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 10 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
WARNING:agentic_service.agents.infrastructure_agent:Dataset nike_capi_demo_20251005 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent:Created table: customers
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent:Created table: products
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: available_colors
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: available_colors
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: available_colors
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: available_colors
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job a4f1df7d-8a7f-4c02-9302-b3323d1f34e3: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: available_colors
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: available_colors
During task with name 'infrastructure_node' and id '2be75c8c-396f-9be2-4a5b-d63aa554315c'
INFO:routes.provisioning:Job a4f1df7d-8a7f-4c02-9302-b3323d1f34e3 finished with status failed
INFO:routes.provisioning:Client unsubscribed from job a4f1df7d-8a7f-4c02-9302-b3323d1f34e3
INFO:routes.provisioning:Created provisioning job 563048c8-615e-47f0-92e9-418faa4602b1 for https://www.nike.com/
INFO:routes.provisioning:Starting provisioning workflow for job 563048c8-615e-47f0-92e9-418faa4602b1
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 563048c8-615e-47f0-92e9-418faa4602b1
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.nike.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.nike.com/
INFO:agentic_service.tools.web_research:Scraped 2067 characters from https://www.nike.com/
INFO:agentic_service.agents.research_agent:Scraped 2067 characters
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: E-commerce / Retail
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 29.9s (1 queries)
INFO:routes.provisioning:Created provisioning job 41b7ff4b-24bd-4105-b044-a3b312a737f8 for https://www.bbc.com/
INFO:routes.provisioning:Starting provisioning workflow for job 41b7ff4b-24bd-4105-b044-a3b312a737f8
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 41b7ff4b-24bd-4105-b044-a3b312a737f8
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.bbc.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.bbc.com/
INFO:agentic_service.tools.web_research:Scraped 12744 characters from https://www.bbc.com/
INFO:agentic_service.agents.research_agent:Scraped 12744 characters
INFO:routes.provisioning:SSE stream cancelled for job 563048c8-615e-47f0-92e9-418faa4602b1
INFO:routes.provisioning:Client unsubscribed from job 563048c8-615e-47f0-92e9-418faa4602b1
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: Media & Broadcasting
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 23.4s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 86.7s (4 entities)
INFO:routes.provisioning:SSE stream cancelled for job 563048c8-615e-47f0-92e9-418faa4602b1
INFO:routes.provisioning:Client unsubscribed from job 563048c8-615e-47f0-92e9-418faa4602b1
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 122.4s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 122.4s: 'From Dashboard Delays to Real-Time Retail Intelligence: Nike's Conversational Analytics Revolution'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 6 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 85.0s (4 entities)
INFO:routes.provisioning:SSE stream cancelled for job 41b7ff4b-24bd-4105-b044-a3b312a737f8
INFO:routes.provisioning:Client unsubscribed from job 41b7ff4b-24bd-4105-b044-a3b312a737f8
INFO:routes.provisioning:SSE stream cancelled for job 41b7ff4b-24bd-4105-b044-a3b312a737f8
INFO:routes.provisioning:Client unsubscribed from job 41b7ff4b-24bd-4105-b044-a3b312a737f8
INFO:routes.provisioning:SSE stream cancelled for job 41b7ff4b-24bd-4105-b044-a3b312a737f8
INFO:routes.provisioning:Client unsubscribed from job 41b7ff4b-24bd-4105-b044-a3b312a737f8
INFO:routes.provisioning:Created provisioning job 23551ab7-0dc7-41b8-8772-65358a80fc6a for https://www.nike.com/
INFO:routes.provisioning:Starting provisioning workflow for job 23551ab7-0dc7-41b8-8772-65358a80fc6a
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 23551ab7-0dc7-41b8-8772-65358a80fc6a
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.nike.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.nike.com/
INFO:agentic_service.tools.web_research:Scraped 2067 characters from https://www.nike.com/
INFO:agentic_service.agents.research_agent:Scraped 2067 characters
INFO:routes.provisioning:SSE stream cancelled for job 23551ab7-0dc7-41b8-8772-65358a80fc6a
INFO:routes.provisioning:Client unsubscribed from job 23551ab7-0dc7-41b8-8772-65358a80fc6a
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: E-commerce Retail
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:routes.provisioning:SSE stream cancelled for job 23551ab7-0dc7-41b8-8772-65358a80fc6a
INFO:routes.provisioning:Client unsubscribed from job 23551ab7-0dc7-41b8-8772-65358a80fc6a
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 144.0s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 144.0s: 'BBC: From Dashboard Delays to Real-Time Editorial Intelligence in Natural Language'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 10 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 22.5s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 10 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for product_launches...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ product_launches: 50 rows → /tmp/synthetic_data/product_launches.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for promotions...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ promotions: 50 rows → /tmp/synthetic_data/promotions.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for product_lines...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ product_lines: 800 rows → /tmp/synthetic_data/product_lines.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for carts...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ carts: 3,000 rows → /tmp/synthetic_data/carts.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for wishlists...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ wishlists: 3,000 rows → /tmp/synthetic_data/wishlists.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for inventory...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ inventory: 3,000 rows → /tmp/synthetic_data/inventory.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for customers...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ customers: 3,500 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for orders...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.synthetic_data_generator:  ✓ orders: 15,000 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for order_items...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ order_items: 40,000 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for notifications...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ notifications: 40,000 rows → /tmp/synthetic_data/notifications.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 10 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 81.4s (4 entities)
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
WARNING:agentic_service.agents.infrastructure_agent:Dataset nike_capi_demo_20251005 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent:Created table: customers
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into customers
INFO:agentic_service.agents.infrastructure_agent:Created table: product_lines
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 800 rows into product_lines
INFO:agentic_service.agents.infrastructure_agent:Created table: orders
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 423 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 669 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 929 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 1177 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 1426 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 2193 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 2442 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 2694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 2937 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 3187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 3430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 3676 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 3925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 4175 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 4428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 4685 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 4928 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 5185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 5430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 5684 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 5925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 6172 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 6428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 6688 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 6939 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 7195 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 7448 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 7694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 7941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 8186 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 8432 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 8679 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 8931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 9180 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-19 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 9439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-09 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 9682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 9931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 10181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 10433 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 10689 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 10931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 11185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 11429 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 11673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 11920 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 12166 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 12419 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 12687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 12941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 13187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 13435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 13687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 13941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 14188 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 14435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 14680 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 14934 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 15181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 15428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 15682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 15932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 16174 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 16428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-10-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 16682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 16927 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 17183 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 17438 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 17697 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 17958 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 18207 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 18458 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 18709 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 18955 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 19215 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 19465 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 19718 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 19957 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 20219 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 20472 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 20713 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 20960 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 21206 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 21453 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 21703 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 21965 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 22218 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 22461 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 22707 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 22950 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 23191 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 23440 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 23696 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 23945 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 24192 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 24439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 24691 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 24947 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-14 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 25197 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-01 16:57:..."
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 291, in _create_and_load_tables
    bq_schema = self._convert_schema_to_bigquery(table_def["schema"])
    ^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 423 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 669 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 929 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 1177 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 1426 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 2193 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 2442 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 2694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 2937 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 3187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 3430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 3676 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 3925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 4175 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 4428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 4685 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 4928 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 5185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 5430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 5684 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 5925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 6172 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 6428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 6688 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 6939 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 7195 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 7448 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 7694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 7941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 8186 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 8432 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 8679 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 8931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 9180 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-19 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 9439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-09 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 9682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 9931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 10181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 10433 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 10689 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 10931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 11185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 11429 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 11673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 11920 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 12166 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 12419 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 12687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 12941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 13187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 13435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 13687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 13941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 14188 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 14435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 14680 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 14934 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 15181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 15428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 15682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 15932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 16174 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 16428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-10-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 16682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 16927 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 17183 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 17438 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 17697 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 17958 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 18207 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 18458 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 18709 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 18955 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 19215 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 19465 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 19718 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 19957 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 20219 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 20472 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 20713 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 20960 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 21206 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 21453 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 21703 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 21965 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 22218 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 22461 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 22707 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 22950 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 23191 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 23440 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 23696 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 23945 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 24192 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 24439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 24691 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 24947 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-14 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 25197 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-01 16:57:..."
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 423 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 669 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 929 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 1177 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 1426 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 2193 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 2442 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 2694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 2937 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 3187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 3430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 3676 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 3925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 4175 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 4428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 4685 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 4928 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 5185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 5430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 5684 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 5925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 6172 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 6428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 6688 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 6939 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 7195 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 7448 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 7694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 7941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 8186 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 8432 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 8679 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 8931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 9180 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-19 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 9439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-09 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 9682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 9931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 10181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 10433 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 10689 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 10931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 11185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 11429 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 11673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 11920 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 12166 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 12419 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 12687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 12941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 13187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 13435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 13687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 13941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 14188 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 14435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 14680 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 14934 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 15181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 15428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 15682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 15932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 16174 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 16428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-10-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 16682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 16927 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 17183 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 17438 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 17697 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 17958 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 18207 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 18458 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 18709 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 18955 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 19215 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 19465 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 19718 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 19957 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 20219 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 20472 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 20713 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 20960 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 21206 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 21453 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 21703 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 21965 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 22218 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 22461 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 22707 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 22950 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 23191 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 23440 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 23696 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 23945 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 24192 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 24439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 24691 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 24947 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-14 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 25197 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-01 16:57:..."
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 291, in _create_and_load_tables
    bq_schema = self._convert_schema_to_bigquery(table_def["schema"])
    ^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 423 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 669 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 929 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 1177 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 1426 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 2193 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 2442 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 2694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 2937 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 3187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 3430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 3676 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 3925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 4175 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 4428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 4685 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 4928 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 5185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 5430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 5684 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 5925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 6172 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 6428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 6688 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 6939 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 7195 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 7448 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 7694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 7941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 8186 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 8432 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 8679 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 8931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 9180 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-19 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 9439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-09 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 9682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 9931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 10181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 10433 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 10689 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 10931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 11185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 11429 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 11673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 11920 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 12166 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 12419 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 12687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 12941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 13187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 13435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 13687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 13941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 14188 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 14435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 14680 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 14934 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 15181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 15428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 15682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 15932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 16174 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 16428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-10-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 16682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 16927 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 17183 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 17438 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 17697 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 17958 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 18207 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 18458 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 18709 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 18955 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 19215 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 19465 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 19718 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 19957 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 20219 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 20472 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 20713 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 20960 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 21206 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 21453 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 21703 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 21965 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 22218 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 22461 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 22707 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 22950 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 23191 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 23440 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 23696 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 23945 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 24192 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 24439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 24691 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 24947 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-14 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 25197 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-01 16:57:..."
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 563048c8-615e-47f0-92e9-418faa4602b1: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 423 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 669 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 929 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 1177 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 1426 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 2193 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 2442 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 2694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 2937 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 3187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 3430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 3676 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 3925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 4175 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 4428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 4685 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 4928 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 5185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 5430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 5684 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 5925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 6172 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 6428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 6688 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 6939 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 7195 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 7448 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 7694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 7941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 8186 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 8432 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 8679 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 8931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 9180 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-19 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 9439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-09 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 9682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 9931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 10181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 10433 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 10689 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 10931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 11185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 11429 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 11673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 11920 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 12166 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 12419 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 12687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 12941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 13187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 13435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 13687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 13941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 14188 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 14435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 14680 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 14934 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 15181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 15428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 15682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 15932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 16174 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 16428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-10-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 16682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 16927 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 17183 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 17438 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 17697 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 17958 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 18207 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 18458 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 18709 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 18955 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 19215 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 19465 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 19718 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 19957 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 20219 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 20472 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 20713 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 20960 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 21206 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 21453 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 21703 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 21965 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 22218 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 22461 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 22707 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 22950 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 23191 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 23440 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 23696 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 23945 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 24192 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 24439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 24691 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 24947 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-14 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 25197 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-01 16:57:..."
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 291, in _create_and_load_tables
    bq_schema = self._convert_schema_to_bigquery(table_def["schema"])
    ^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 423 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 669 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 929 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 1177 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 1426 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 2193 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 2442 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 2694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 2937 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 3187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 3430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 3676 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 3925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 4175 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 4428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 4685 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 4928 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 5185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 5430 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 5684 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-05 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 5925 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 6172 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 6428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 6688 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 6939 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 7195 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 7448 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 7694 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 7941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 8186 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 8432 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 8679 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 8931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 9180 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-19 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 9439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-09 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 9682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 9931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 10181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 10433 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 10689 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 10931 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 11185 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 11429 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-27 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 11673 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 11920 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 12166 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 12419 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-15 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 12687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 12941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 13187 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 13435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 13687 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 13941 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 14188 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 14435 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 14680 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-31 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 14934 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-30 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 15181 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-20 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 15428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 15682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 15932 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-07 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 16174 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 16428 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-10-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 16682 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 16927 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 17183 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-08-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 17438 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-02-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 17697 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 17958 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-23 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 18207 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 18458 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-25 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 18709 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-01 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 18955 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-11 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 19215 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 19465 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-03 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 19718 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-29 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 19957 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-18 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 20219 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 20472 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 20713 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-06 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 20960 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 21206 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-10-16 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 21453 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 21703 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-10 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 21965 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-02 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 22218 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-05-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 22461 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-09-26 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 22707 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-28 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 22950 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-17 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 23191 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-24 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 23440 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-08 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 23696 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-11-21 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 23945 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-04-22 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 24192 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-03-04 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 24439 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-06-13 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 24691 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-07-12 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 24947 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2025-01-14 16:57:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 25197 column_index: 20 column_name: "customer_lifetime..." column_type: DOUBLE value: "2024-12-01 16:57:..."
During task with name 'infrastructure_node' and id 'ba0f7e50-4b06-84d6-95cd-457da3df730c'
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 118.2s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 118.2s: 'From Dashboards to Decisions: How Nike Democratizes Data Insights Across Every Team'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 6 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 11 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for newsletters...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ newsletters: 50 rows → /tmp/synthetic_data/newsletters.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for live_events...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ live_events: 800 rows → /tmp/synthetic_data/live_events.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for authors...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ authors: 800 rows → /tmp/synthetic_data/authors.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for audio_content...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ audio_content: 3,000 rows → /tmp/synthetic_data/audio_content.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for videos...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ videos: 3,000 rows → /tmp/synthetic_data/videos.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for newsletter_subscriptions...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ newsletter_subscriptions: 3,000 rows → /tmp/synthetic_data/newsletter_subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for saved_content...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ saved_content: 3,500 rows → /tmp/synthetic_data/saved_content.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for users...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ users: 3,500 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for articles...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ articles: 3,500 rows → /tmp/synthetic_data/articles.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for user_engagement...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ user_engagement: 15,000 rows → /tmp/synthetic_data/user_engagement.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for content_tags...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ content_tags: 15,000 rows → /tmp/synthetic_data/content_tags.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 11 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "bbc_(british_broadcasting_corporation)" has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 48, in execute
    if "job_manager" in state and "job_id" in state:
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 229, in _create_dataset
    The data enables natural language queries that showcase:
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "bbc_(british_broadcasting_corporation)" has invalid characters.
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "bbc_(british_broadcasting_corporation)" has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 48, in execute
    if "job_manager" in state and "job_id" in state:
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 229, in _create_dataset
    The data enables natural language queries that showcase:
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "bbc_(british_broadcasting_corporation)" has invalid characters.
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 41b7ff4b-24bd-4105-b044-a3b312a737f8: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "bbc_(british_broadcasting_corporation)" has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 48, in execute
    if "job_manager" in state and "job_id" in state:
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 229, in _create_dataset
    The data enables natural language queries that showcase:
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "bbc_(british_broadcasting_corporation)" has invalid characters.
During task with name 'infrastructure_node' and id 'ee5026c5-a873-2756-d41e-12fb200e3cec'
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 12 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for warehouses...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ warehouses: 50 rows → /tmp/synthetic_data/warehouses.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for product_categories...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ product_categories: 50 rows → /tmp/synthetic_data/product_categories.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for campaigns...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ campaigns: 50 rows → /tmp/synthetic_data/campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for product_releases...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ product_releases: 800 rows → /tmp/synthetic_data/product_releases.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for products...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ products: 3,000 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for shopping_carts...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ shopping_carts: 3,000 rows → /tmp/synthetic_data/shopping_carts.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for wishlists...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ wishlists: 3,500 rows → /tmp/synthetic_data/wishlists.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for inventory...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ inventory: 3,500 rows → /tmp/synthetic_data/inventory.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for customers...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ customers: 3,500 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for release_notifications...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ release_notifications: 3,500 rows → /tmp/synthetic_data/release_notifications.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for orders...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for order_items...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ order_items: 15,000 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 12 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
WARNING:agentic_service.agents.infrastructure_agent:Dataset nike_capi_demo_20251005 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent:Created table: customers
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into customers
INFO:agentic_service.agents.infrastructure_agent:Created table: orders
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 15,000 rows into order_items
INFO:agentic_service.agents.infrastructure_agent:Created table: products
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into products
INFO:agentic_service.agents.infrastructure_agent:Created table: product_categories
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 50 rows into product_categories
INFO:agentic_service.agents.infrastructure_agent:Created table: product_releases
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 800 rows into product_releases
INFO:agentic_service.agents.infrastructure_agent:Created table: release_notifications
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into release_notifications
INFO:agentic_service.agents.infrastructure_agent:Created table: shopping_carts
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into shopping_carts
INFO:agentic_service.agents.infrastructure_agent:Created table: wishlists
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into wishlists
INFO:agentic_service.agents.infrastructure_agent:Created table: inventory
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into inventory
INFO:agentic_service.agents.infrastructure_agent:Created table: warehouses
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 50 rows into warehouses
INFO:agentic_service.agents.infrastructure_agent:Created table: campaigns
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 202 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 365 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 523 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 691 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 850 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1015 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1172 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1333 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-30 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1496 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1665 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1836 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1995 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2159 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2325 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2479 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-09 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2646 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2808 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-10 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2972 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3134 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3297 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3471 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3632 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3795 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3962 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 4117 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4278 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4446 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4606 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4770 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4936 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 5095 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5256 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-10-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5415 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5578 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5736 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-13 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5896 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 6054 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6215 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6373 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-07 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6535 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6698 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-28 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6859 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 7034 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 7191 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7359 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7530 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7692 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7860 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 8024 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 8189 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 291, in _create_and_load_tables
    bq_schema = self._convert_schema_to_bigquery(table_def["schema"])
    ^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 202 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 365 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 523 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 691 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 850 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1015 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1172 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1333 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-30 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1496 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1665 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1836 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1995 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2159 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2325 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2479 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-09 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2646 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2808 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-10 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2972 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3134 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3297 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3471 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3632 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3795 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3962 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 4117 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4278 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4446 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4606 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4770 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4936 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 5095 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5256 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-10-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5415 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5578 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5736 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-13 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5896 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 6054 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6215 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6373 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-07 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6535 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6698 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-28 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6859 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 7034 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 7191 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7359 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7530 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7692 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7860 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 8024 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 8189 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 202 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 365 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 523 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 691 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 850 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1015 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1172 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1333 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-30 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1496 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1665 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1836 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1995 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2159 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2325 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2479 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-09 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2646 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2808 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-10 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2972 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3134 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3297 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3471 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3632 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3795 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3962 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 4117 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4278 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4446 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4606 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4770 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4936 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 5095 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5256 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-10-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5415 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5578 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5736 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-13 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5896 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 6054 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6215 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6373 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-07 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6535 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6698 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-28 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6859 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 7034 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 7191 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7359 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7530 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7692 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7860 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 8024 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 8189 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 291, in _create_and_load_tables
    bq_schema = self._convert_schema_to_bigquery(table_def["schema"])
    ^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 202 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 365 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 523 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 691 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 850 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1015 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1172 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1333 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-30 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1496 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1665 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1836 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1995 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2159 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2325 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2479 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-09 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2646 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2808 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-10 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2972 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3134 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3297 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3471 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3632 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3795 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3962 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 4117 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4278 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4446 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4606 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4770 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4936 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 5095 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5256 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-10-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5415 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5578 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5736 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-13 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5896 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 6054 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6215 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6373 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-07 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6535 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6698 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-28 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6859 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 7034 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 7191 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7359 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7530 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7692 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7860 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 8024 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 8189 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 23551ab7-0dc7-41b8-8772-65358a80fc6a: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 202 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 365 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 523 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 691 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 850 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1015 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1172 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1333 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-30 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1496 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1665 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1836 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1995 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2159 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2325 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2479 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-09 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2646 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2808 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-10 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2972 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3134 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3297 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3471 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3632 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3795 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3962 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 4117 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4278 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4446 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4606 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4770 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4936 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 5095 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5256 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-10-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5415 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5578 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5736 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-13 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5896 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 6054 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6215 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6373 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-07 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6535 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6698 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-28 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6859 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 7034 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 7191 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7359 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7530 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7692 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7860 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 8024 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 8189 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 291, in _create_and_load_tables
    bq_schema = self._convert_schema_to_bigquery(table_def["schema"])
    ^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 50; errors: 50; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 202 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 365 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 523 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 691 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 850 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-27 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1015 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1172 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1333 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-30 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1496 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1665 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-19 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1836 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1995 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2159 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2325 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2479 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-06-09 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2646 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2808 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-10 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2972 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3134 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3297 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3471 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3632 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3795 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3962 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-04 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 4117 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-01-06 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4278 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4446 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-10-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4606 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4770 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4936 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-17 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 5095 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5256 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-10-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5415 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-02-05 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5578 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-25 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5736 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-13 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5896 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-20 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 6054 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-12 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6215 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6373 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-07 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6535 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-11-15 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6698 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-28 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6859 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-07-01 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 7034 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 7191 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-23 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7359 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-04-16 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7530 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-24 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7692 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2024-12-11 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7860 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-08-02 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 8024 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-05-29 16:59:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 8189 column_index: 13 column_name: "revenue_attributed" column_type: DOUBLE value: "2025-03-16 16:59:..."
During task with name 'infrastructure_node' and id '2cd1c1bd-4ea1-1640-586a-abc53b1ad7a0'
INFO:routes.provisioning:SSE stream cancelled for job a4f1df7d-8a7f-4c02-9302-b3323d1f34e3
INFO:routes.provisioning:Client unsubscribed from job a4f1df7d-8a7f-4c02-9302-b3323d1f34e3
INFO:routes.provisioning:Created provisioning job 023ba525-04af-44f0-86b7-e3a26e24310a for https://www.clickup.com/
INFO:routes.provisioning:Starting provisioning workflow for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.clickup.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.clickup.com/
INFO:agentic_service.tools.web_research:Scraped 7303 characters from https://www.clickup.com/
INFO:agentic_service.agents.research_agent:Scraped 7303 characters
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: SaaS - Project Management & Productivity
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 24.4s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 75.3s (4 entities)
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 156.8s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 156.8s: 'From Dashboard Paralysis to Instant Insights: How ClickUp Leaders Get Answers in Seconds, Not Sprints'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 10 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 14 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for teams...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ teams: 800 rows → /tmp/synthetic_data/teams.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for workspaces...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ workspaces: 800 rows → /tmp/synthetic_data/workspaces.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for sprints...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ sprints: 800 rows → /tmp/synthetic_data/sprints.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for projects...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ projects: 3,000 rows → /tmp/synthetic_data/projects.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for automations...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ automations: 3,000 rows → /tmp/synthetic_data/automations.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for integrations...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ integrations: 3,000 rows → /tmp/synthetic_data/integrations.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for documents...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ documents: 3,000 rows → /tmp/synthetic_data/documents.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for users...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ users: 3,000 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for team_members...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ team_members: 3,500 rows → /tmp/synthetic_data/team_members.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for feature_usage...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ feature_usage: 3,500 rows → /tmp/synthetic_data/feature_usage.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for tasks...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ tasks: 3,500 rows → /tmp/synthetic_data/tasks.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for time_entries...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ time_entries: 15,000 rows → /tmp/synthetic_data/time_entries.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for task_activity...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ task_activity: 40,000 rows → /tmp/synthetic_data/task_activity.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for workspace_metrics_daily...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ workspace_metrics_daily: 40,000 rows → /tmp/synthetic_data/workspace_metrics_daily.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 14 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
INFO:agentic_service.agents.infrastructure_agent:Created dataset: clickup_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent:Created table: workspaces
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 800 rows into workspaces
INFO:agentic_service.agents.infrastructure_agent:Created table: users
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into users
INFO:agentic_service.agents.infrastructure_agent:Created table: teams
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 800 rows into teams
INFO:agentic_service.agents.infrastructure_agent:Created table: team_members
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into team_members
INFO:agentic_service.agents.infrastructure_agent:Created table: projects
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into projects
INFO:agentic_service.agents.infrastructure_agent:Created table: sprints
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 800 rows into sprints
INFO:agentic_service.agents.infrastructure_agent:Created table: tasks
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: tags
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: tags
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: tags
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: tags
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 023ba525-04af-44f0-86b7-e3a26e24310a: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: tags
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: tags
During task with name 'infrastructure_node' and id '7c1c48b2-771c-e40e-0e76-faeb9f6b6624'
INFO:routes.provisioning:Job 023ba525-04af-44f0-86b7-e3a26e24310a finished with status failed
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:SSE stream cancelled for job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Client unsubscribed from job 023ba525-04af-44f0-86b7-e3a26e24310a
INFO:routes.provisioning:Created provisioning job 30150ba6-9d6c-43e1-9003-2e24192dfccf for https://www.offerup.com/
INFO:routes.provisioning:Starting provisioning workflow for job 30150ba6-9d6c-43e1-9003-2e24192dfccf
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 30150ba6-9d6c-43e1-9003-2e24192dfccf
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.offerup.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.offerup.com/
INFO:agentic_service.tools.web_research:Scraped 5500 characters from https://www.offerup.com/
INFO:agentic_service.agents.research_agent:Scraped 5500 characters
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: C2C Marketplace Platform
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 25.9s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 75.0s (4 entities)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 111.5s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 111.5s: 'From Dashboard Paralysis to Marketplace Intelligence: How OfferUp Unlocks Hidden Revenue with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 6 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 7 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for reviews...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ reviews: 3,000 rows → /tmp/synthetic_data/reviews.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for transactions...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ transactions: 3,500 rows → /tmp/synthetic_data/transactions.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for users...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ users: 3,500 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for market_metrics...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ market_metrics: 3,500 rows → /tmp/synthetic_data/market_metrics.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for listings...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ listings: 15,000 rows → /tmp/synthetic_data/listings.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for messages...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ messages: 15,000 rows → /tmp/synthetic_data/messages.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for searches...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ searches: 40,000 rows → /tmp/synthetic_data/searches.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 7 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
WARNING:agentic_service.agents.infrastructure_agent:Dataset offerup_capi_demo_20251005 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent:Created table: users
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into users
INFO:agentic_service.agents.infrastructure_agent:Created table: listings
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 15,000 rows into listings
INFO:agentic_service.agents.infrastructure_agent:Created table: transactions
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into transactions
INFO:agentic_service.agents.infrastructure_agent:Created table: messages
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 15,000 rows into messages
INFO:agentic_service.agents.infrastructure_agent:Created table: searches
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: clicked_listing_ids
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: clicked_listing_ids
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: clicked_listing_ids
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: clicked_listing_ids
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 30150ba6-9d6c-43e1-9003-2e24192dfccf: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: clicked_listing_ids
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: clicked_listing_ids
During task with name 'infrastructure_node' and id 'a691aad2-be3b-9b3e-aece-a253796588b4'
INFO:routes.provisioning:Job 30150ba6-9d6c-43e1-9003-2e24192dfccf finished with status failed
INFO:routes.provisioning:Client unsubscribed from job 30150ba6-9d6c-43e1-9003-2e24192dfccf
INFO:routes.provisioning:Created provisioning job 77b17f2b-9f00-41af-8867-199e6c4c447f for https://www.airbnb.com/
INFO:routes.provisioning:Starting provisioning workflow for job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.airbnb.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.airbnb.com/
INFO:agentic_service.tools.web_research:Scraped 2892 characters from https://www.airbnb.com/
INFO:agentic_service.agents.research_agent:Scraped 2892 characters
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: Online Marketplace / Sharing Economy Platform
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 21.9s (1 queries)
INFO:routes.provisioning:SSE stream cancelled for job 30150ba6-9d6c-43e1-9003-2e24192dfccf
INFO:routes.provisioning:Client unsubscribed from job 30150ba6-9d6c-43e1-9003-2e24192dfccf
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 113.2s (4 entities)
INFO:routes.provisioning:SSE stream cancelled for job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:routes.provisioning:Client unsubscribed from job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 160.1s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 160.1s: 'From Dashboard Delays to Real-Time Answers: How Airbnb Democratizes Data Across 7M+ Listings'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 10 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
WARNING:agentic_service.utils.vertex_llm_client:Initial JSON parse failed: Unterminated string starting at: line 1861 column 7 (char 60671)
WARNING:agentic_service.utils.vertex_llm_client:Attempting JSON repair for unterminated strings/objects...
INFO:agentic_service.utils.vertex_llm_client:Repaired JSON by truncating at position 58480 and closing 1 arrays and 2 objects
INFO:agentic_service.utils.vertex_llm_client:✅ JSON repair successful! Fixed 2189 characters
ERROR:agentic_service.utils.vertex_llm_client:JSON repair failed: Expecting ',' delimiter: line 1823 column 29 (char 58480)
ERROR:agentic_service.utils.vertex_llm_client:Response text (first 500 chars): ```json
{
  "tables": [
    {
      "name": "guests",
      "description": "Core customer entity representing travelers who search for and book accommodations on the Airbnb platform",
      "purpose_in_demo": "Essential for customer lifetime value analysis (Scene 7), guest segmentation, first-time guest filtering (Scene 2), cancellation pattern analysis by guest type (Scene 3), and retention cohort analysis. Enables queries about guest behavior evolution, booking frequency, and lifetime value pr...
ERROR:agentic_service.utils.vertex_llm_client:Extracted JSON text (first 500 chars): {
  "tables": [
    {
      "name": "guests",
      "description": "Core customer entity representing travelers who search for and book accommodations on the Airbnb platform",
      "purpose_in_demo": "Essential for customer lifetime value analysis (Scene 7), guest segmentation, first-time guest filtering (Scene 2), cancellation pattern analysis by guest type (Scene 3), and retention cohort analysis. Enables queries about guest behavior evolution, booking frequency, and lifetime value progressio...
ERROR:agentic_service.utils.vertex_llm_client:Extracted JSON text length: 60672
ERROR:agentic_service.utils.vertex_llm_client:Last 200 chars: ...rted by guests + bookings with cohort analysis and temporal aggregations",
      "scene_8_market_opportunity": "Supported by locations + searches + properties with supply-demand calculations",
      "
ERROR:agentic_service.agents.data_modeling_agent:Data modeling failed: Invalid JSON response: Unterminated string starting at: line 1861 column 7 (char 60671)
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 182, in parse_json_response
    temperature=temperature,
           ^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Unterminated string starting at: line 1861 column 7 (char 60671)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 191, in parse_json_response
    return response.content[0].text
                   ^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting ',' delimiter: line 1823 column 29 (char 58480)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/data_modeling_agent.py", line 34, in execute
    schema = await self._design_schema(customer_info, demo_story, state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/data_modeling_agent.py", line 69, in _design_schema
    "data modeling agent",
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 198, in parse_json_response
    ) -> str:
              
ValueError: Invalid JSON response: Unterminated string starting at: line 1861 column 7 (char 60671)
ERROR:agentic_service.demo_orchestrator:❌ Data Modeling Agent failed: Invalid JSON response: Unterminated string starting at: line 1861 column 7 (char 60671)
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 182, in parse_json_response
    temperature=temperature,
           ^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Unterminated string starting at: line 1861 column 7 (char 60671)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 191, in parse_json_response
    return response.content[0].text
                   ^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting ',' delimiter: line 1823 column 29 (char 58480)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/data_modeling_agent.py", line 34, in execute
    schema = await self._design_schema(customer_info, demo_story, state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/data_modeling_agent.py", line 69, in _design_schema
    "data modeling agent",
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 198, in parse_json_response
    ) -> str:
              
ValueError: Invalid JSON response: Unterminated string starting at: line 1861 column 7 (char 60671)
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 77b17f2b-9f00-41af-8867-199e6c4c447f: Invalid JSON response: Unterminated string starting at: line 1861 column 7 (char 60671)
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 182, in parse_json_response
    temperature=temperature,
           ^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Unterminated string starting at: line 1861 column 7 (char 60671)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 191, in parse_json_response
    return response.content[0].text
                   ^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting ',' delimiter: line 1823 column 29 (char 58480)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/data_modeling_agent.py", line 34, in execute
    schema = await self._design_schema(customer_info, demo_story, state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/data_modeling_agent.py", line 69, in _design_schema
    "data modeling agent",
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 198, in parse_json_response
    ) -> str:
              
ValueError: Invalid JSON response: Unterminated string starting at: line 1861 column 7 (char 60671)
During task with name 'data_modeling_node' and id '3d0e6a5a-5f43-4504-dd7c-570dcd4d129d'
INFO:routes.provisioning:Job 77b17f2b-9f00-41af-8867-199e6c4c447f finished with status failed
INFO:routes.provisioning:Client unsubscribed from job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:routes.provisioning:Created provisioning job f2d96373-d2da-45dd-bee1-60868a163539 for https://www.dhl.com/
INFO:routes.provisioning:Starting provisioning workflow for job f2d96373-d2da-45dd-bee1-60868a163539
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job f2d96373-d2da-45dd-bee1-60868a163539
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.dhl.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.dhl.com/
ERROR:agentic_service.agents.research_agent:Research failed: Timeout while scraping https://www.dhl.com/
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client_reqrep.py", line 532, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/streams.py", line 672, in read
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/tools/web_research.py", line 38, in scrape_website
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 1488, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 748, in _connect_and_send_request
    await resp.start(conn)
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client_reqrep.py", line 527, in start
    with self._timer:
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/helpers.py", line 685, in __exit__
    raise asyncio.TimeoutError from exc_val
TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent.py", line 28, in execute
    website_content = await scrape_website(state["customer_url"])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/tools/web_research.py", line 64, in scrape_website
    soup = BeautifulSoup(html, 'html.parser')
ValueError: Timeout while scraping https://www.dhl.com/
ERROR:agentic_service.demo_orchestrator:❌ Research Agent failed: Timeout while scraping https://www.dhl.com/
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client_reqrep.py", line 532, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/streams.py", line 672, in read
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/tools/web_research.py", line 38, in scrape_website
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 1488, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 748, in _connect_and_send_request
    await resp.start(conn)
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client_reqrep.py", line 527, in start
    with self._timer:
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/helpers.py", line 685, in __exit__
    raise asyncio.TimeoutError from exc_val
TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent.py", line 28, in execute
    website_content = await scrape_website(state["customer_url"])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/tools/web_research.py", line 64, in scrape_website
    soup = BeautifulSoup(html, 'html.parser')
ValueError: Timeout while scraping https://www.dhl.com/
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job f2d96373-d2da-45dd-bee1-60868a163539: Timeout while scraping https://www.dhl.com/
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client_reqrep.py", line 532, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/streams.py", line 672, in read
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/tools/web_research.py", line 38, in scrape_website
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 1488, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 770, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client.py", line 748, in _connect_and_send_request
    await resp.start(conn)
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/client_reqrep.py", line 527, in start
    with self._timer:
  File "/home/admin_/.local/lib/python3.12/site-packages/aiohttp/helpers.py", line 685, in __exit__
    raise asyncio.TimeoutError from exc_val
TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent.py", line 28, in execute
    website_content = await scrape_website(state["customer_url"])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/tools/web_research.py", line 64, in scrape_website
    soup = BeautifulSoup(html, 'html.parser')
ValueError: Timeout while scraping https://www.dhl.com/
During task with name 'research_node' and id '31ee1dd8-8c28-cc8a-e434-880eda1bc3c3'
INFO:routes.provisioning:Job f2d96373-d2da-45dd-bee1-60868a163539 finished with status failed
INFO:routes.provisioning:Client unsubscribed from job f2d96373-d2da-45dd-bee1-60868a163539
INFO:routes.provisioning:SSE stream cancelled for job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:routes.provisioning:Client unsubscribed from job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:routes.provisioning:SSE stream cancelled for job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:routes.provisioning:Client unsubscribed from job 77b17f2b-9f00-41af-8867-199e6c4c447f
INFO:routes.provisioning:SSE stream cancelled for job f2d96373-d2da-45dd-bee1-60868a163539
INFO:routes.provisioning:Client unsubscribed from job f2d96373-d2da-45dd-bee1-60868a163539
INFO:routes.provisioning:SSE stream cancelled for job f2d96373-d2da-45dd-bee1-60868a163539
INFO:routes.provisioning:Client unsubscribed from job f2d96373-d2da-45dd-bee1-60868a163539
INFO:routes.provisioning:Created provisioning job c9fec8f6-2bf2-4370-bdf9-178eccde55b1 for https://www.offerup.com/
INFO:routes.provisioning:Starting provisioning workflow for job c9fec8f6-2bf2-4370-bdf9-178eccde55b1
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job c9fec8f6-2bf2-4370-bdf9-178eccde55b1
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.offerup.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.offerup.com/
INFO:agentic_service.tools.web_research:Scraped 5504 characters from https://www.offerup.com/
INFO:agentic_service.agents.research_agent:Scraped 5504 characters
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: C2C Marketplace Platform
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 30.1s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 86.1s (4 entities)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 100.4s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 100.4s: 'From Dashboard Paralysis to Marketplace Mastery: How OfferUp Empowers Every Team to Unlock Growth Insights'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 5 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 10 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for locations...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ locations: 50 rows → /tmp/synthetic_data/locations.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for categories...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ categories: 50 rows → /tmp/synthetic_data/categories.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for category_performance...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ category_performance: 3,000 rows → /tmp/synthetic_data/category_performance.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for users...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ users: 3,000 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for user_engagement...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ user_engagement: 3,500 rows → /tmp/synthetic_data/user_engagement.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for reviews...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ reviews: 3,500 rows → /tmp/synthetic_data/reviews.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for transactions...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ transactions: 3,500 rows → /tmp/synthetic_data/transactions.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for payments...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ payments: 3,500 rows → /tmp/synthetic_data/payments.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for listings...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ listings: 3,500 rows → /tmp/synthetic_data/listings.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for messages...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ messages: 15,000 rows → /tmp/synthetic_data/messages.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 10 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
WARNING:agentic_service.agents.infrastructure_agent:Dataset offerup_capi_demo_20251005 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent:Created table: users
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into users
INFO:agentic_service.agents.infrastructure_agent:Created table: categories
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 50 rows into categories
INFO:agentic_service.agents.infrastructure_agent:Created table: locations
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 50 rows into locations
INFO:agentic_service.agents.infrastructure_agent:Created table: listings
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into listings
INFO:agentic_service.agents.infrastructure_agent:Created table: messages
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 15,000 rows into messages
INFO:agentic_service.agents.infrastructure_agent:Created table: transactions
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into transactions
INFO:agentic_service.agents.infrastructure_agent:Created table: reviews
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into reviews
INFO:agentic_service.agents.infrastructure_agent:Created table: user_engagement
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: categories_browsed
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: categories_browsed
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: categories_browsed
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: categories_browsed
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job c9fec8f6-2bf2-4370-bdf9-178eccde55b1: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: categories_browsed
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: categories_browsed
During task with name 'infrastructure_node' and id 'd49997e8-b299-0c76-f8b2-d472831d328e'
INFO:routes.provisioning:Job c9fec8f6-2bf2-4370-bdf9-178eccde55b1 finished with status failed
INFO:routes.provisioning:Client unsubscribed from job c9fec8f6-2bf2-4370-bdf9-178eccde55b1
INFO:routes.provisioning:Created provisioning job 6cb908d2-2dbe-47b1-90d1-05e2d74eea26 for https://www.offerup.com/
INFO:routes.provisioning:Starting provisioning workflow for job 6cb908d2-2dbe-47b1-90d1-05e2d74eea26
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 6cb908d2-2dbe-47b1-90d1-05e2d74eea26
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.offerup.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.offerup.com/
INFO:agentic_service.tools.web_research:Scraped 5432 characters from https://www.offerup.com/
INFO:agentic_service.agents.research_agent:Scraped 5432 characters
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: C2C Marketplace Platform
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 27.0s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 69.9s (4 entities)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 113.5s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 113.5s: 'From Dashboard Paralysis to Marketplace Intelligence: How OfferUp Democratizes Data for Every Team'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 7 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for categories...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ categories: 800 rows → /tmp/synthetic_data/categories.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for reviews...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ reviews: 3,000 rows → /tmp/synthetic_data/reviews.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for transactions...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ transactions: 3,500 rows → /tmp/synthetic_data/transactions.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for users...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ users: 3,500 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for seller_behavior_snapshots...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ seller_behavior_snapshots: 3,500 rows → /tmp/synthetic_data/seller_behavior_snapshots.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for listings...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ listings: 3,500 rows → /tmp/synthetic_data/listings.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for messages...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ messages: 15,000 rows → /tmp/synthetic_data/messages.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for category_performance_daily...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ category_performance_daily: 15,000 rows → /tmp/synthetic_data/category_performance_daily.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
WARNING:agentic_service.agents.infrastructure_agent:Dataset offerup_capi_demo_20251005 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent:Created table: users
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into users
INFO:agentic_service.agents.infrastructure_agent:Created table: categories
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 800 rows into categories
INFO:agentic_service.agents.infrastructure_agent:Created table: listings
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into listings
INFO:agentic_service.agents.infrastructure_agent:Created table: transactions
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into transactions
INFO:agentic_service.agents.infrastructure_agent:Created table: messages
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 15,000 rows into messages
INFO:agentic_service.agents.infrastructure_agent:Created table: reviews
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into reviews
INFO:agentic_service.agents.infrastructure_agent:Created table: seller_behavior_snapshots
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into seller_behavior_snapshots
INFO:agentic_service.agents.infrastructure_agent:Created table: category_performance_daily
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 15,000 rows into category_performance_daily
INFO:agentic_service.agents.infrastructure_agent:📄 Demo report generated: /tmp/DEMO_REPORT_offerup_capi_demo_20251005.md
INFO:agentic_service.agents.infrastructure_agent:Creating CAPI Data Agent...
WARNING:agentic_service.agents.infrastructure_agent:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent:Failed to create CAPI agent: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 146, in _create_capi_agent
    state: Dict
                
AttributeError: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'. Did you mean: 'Datasource'?
WARNING:agentic_service.agents.infrastructure_agent:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent:✅ Infrastructure provisioned: offerup_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent:   Dataset: bq-demos-469816.offerup_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent:   Tables: 8
INFO:agentic_service.agents.infrastructure_agent:   Total rows: 47,800
INFO:agentic_service.agents.infrastructure_agent:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator:Generating CAPI system instructions (YAML)
INFO:agentic_service.agents.capi_instruction_generator:Calling Claude 4.5 to generate YAML...
INFO:routes.provisioning:SSE stream cancelled for job c9fec8f6-2bf2-4370-bdf9-178eccde55b1
INFO:routes.provisioning:Client unsubscribed from job c9fec8f6-2bf2-4370-bdf9-178eccde55b1
INFO:routes.provisioning:Created provisioning job 8fdc8959-609e-4b7c-b773-a13de5bbb58f for https://www.shopify.com/
INFO:routes.provisioning:Starting provisioning workflow for job 8fdc8959-609e-4b7c-b773-a13de5bbb58f
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 8fdc8959-609e-4b7c-b773-a13de5bbb58f
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.shopify.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.shopify.com/
INFO:agentic_service.tools.web_research:Scraped 4901 characters from https://www.shopify.com/
INFO:agentic_service.agents.research_agent:Scraped 4901 characters
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: E-commerce Platform (SaaS)
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator:Saved YAML to /tmp/capi_instructions_offerup.yaml
INFO:agentic_service.agents.capi_instruction_generator:✅ CAPI system instructions generated
INFO:agentic_service.agents.capi_instruction_generator:   YAML file: /tmp/capi_instructions_offerup.yaml
INFO:agentic_service.agents.capi_instruction_generator:   Size: 67,445 characters
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator:Validating demo queries...
INFO:agentic_service.agents.demo_validator:
Validating query 1: Show me the top 10 categories by total transaction value whe...
ERROR:agentic_service.agents.demo_validator:  ❌ SQL failed: 400 Table "categories" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: categories, message: Table "categories" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 50526392-e3aa-4e78-921b-083f90d7b584

INFO:agentic_service.agents.demo_validator:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator:✅ Validation complete
INFO:agentic_service.agents.demo_validator:   Queries tested: 1
INFO:agentic_service.agents.demo_validator:   SQL validated: 0
INFO:agentic_service.agents.demo_validator:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 6cb908d2-2dbe-47b1-90d1-05e2d74eea26
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 25.6s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 89.3s (4 entities)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 115.8s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 115.8s: 'From Dashboard Fatigue to Data Democracy: How Shopify Merchants Get Instant Answers Without SQL'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 5 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for marketing_campaigns...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ marketing_campaigns: 3,000 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for merchants...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ merchants: 3,000 rows → /tmp/synthetic_data/merchants.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for stores...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ stores: 3,000 rows → /tmp/synthetic_data/stores.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for support_interactions...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ support_interactions: 3,000 rows → /tmp/synthetic_data/support_interactions.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for products...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ products: 3,500 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for customers...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ customers: 3,500 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for orders...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ orders: 15,000 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for order_line_items...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ order_line_items: 40,000 rows → /tmp/synthetic_data/order_line_items.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
INFO:agentic_service.agents.infrastructure_agent:Created dataset: shopify_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent:Created table: merchants
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into merchants
INFO:agentic_service.agents.infrastructure_agent:Created table: stores
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: enabled_channels
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: enabled_channels
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: enabled_channels
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: enabled_channels
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 8fdc8959-609e-4b7c-b773-a13de5bbb58f: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: enabled_channels
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: enabled_channels
During task with name 'infrastructure_node' and id '755f4a66-e162-b0ab-be31-469eff9ac01c'
INFO:routes.provisioning:Job 8fdc8959-609e-4b7c-b773-a13de5bbb58f finished with status failed
INFO:routes.provisioning:Client unsubscribed from job 8fdc8959-609e-4b7c-b773-a13de5bbb58f
INFO:routes.provisioning:Created provisioning job e3db8d72-6b98-4f17-999e-c5575b151744 for https://www.nike.com/
INFO:routes.provisioning:Starting provisioning workflow for job e3db8d72-6b98-4f17-999e-c5575b151744
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job e3db8d72-6b98-4f17-999e-c5575b151744
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.nike.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.nike.com/
INFO:agentic_service.tools.web_research:Scraped 2067 characters from https://www.nike.com/
INFO:agentic_service.agents.research_agent:Scraped 2067 characters
INFO:routes.provisioning:SSE stream cancelled for job 8fdc8959-609e-4b7c-b773-a13de5bbb58f
INFO:routes.provisioning:Client unsubscribed from job 8fdc8959-609e-4b7c-b773-a13de5bbb58f
INFO:routes.provisioning:SSE stream cancelled for job 8fdc8959-609e-4b7c-b773-a13de5bbb58f
INFO:routes.provisioning:Client unsubscribed from job 8fdc8959-609e-4b7c-b773-a13de5bbb58f
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: E-commerce / Retail
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:routes.provisioning:Created provisioning job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f for https://www.offerup.com/
INFO:routes.provisioning:Starting provisioning workflow for job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.demo_orchestrator:Using Research Agent V1 (fast mode)
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent:Research Agent initialized with Claude via Vertex AI
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent:Demo Story Agent initialized with Claude 4.5 (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.agents.synthetic_data_generator:Synthetic Data Generator initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent:Infrastructure Agent initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator:CAPI Instruction Generator initialized
INFO:agentic_service.agents.demo_validator:Demo Validator initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent:Researching https://www.offerup.com/ with Claude (Vertex AI)
INFO:agentic_service.tools.web_research:Scraping https://www.offerup.com/
INFO:agentic_service.tools.web_research:Scraped 5465 characters from https://www.offerup.com/
INFO:agentic_service.agents.research_agent:Scraped 5465 characters
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.research_agent:Claude analysis complete. Domain: C2C Marketplace Platform
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Claude 4.5 calls)
INFO:agentic_service.agents.demo_story_agent:  → Launching 3 parallel generation tasks...
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 23.6s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 2/3] Golden Queries: Complete in 32.4s (1 queries)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 71.5s (4 entities)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 3/3] Data Specifications: Complete in 103.5s (4 entities)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 107.2s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 107.2s: 'From Dashboard Paralysis to Instant Insights: Nike's Conversational Analytics Revolution'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 6 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.demo_story_agent:    [Task 1/3] Core Narrative: Complete in 131.6s
INFO:agentic_service.agents.demo_story_agent:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent:✅ Demo story complete in 131.6s: 'From Dashboard Paralysis to Marketplace Intelligence: How OfferUp Empowers Every Team Member to Drive Growth'
INFO:agentic_service.agents.demo_story_agent:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent:  - 7 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for product_lines...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ product_lines: 50 rows → /tmp/synthetic_data/product_lines.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for product_releases...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ product_releases: 800 rows → /tmp/synthetic_data/product_releases.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for products...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ products: 3,000 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for customers...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ customers: 3,500 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for inventory...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ inventory: 3,500 rows → /tmp/synthetic_data/inventory.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for orders...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for product_notifications...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ product_notifications: 15,000 rows → /tmp/synthetic_data/product_notifications.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for order_items...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ order_items: 15,000 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
WARNING:agentic_service.agents.infrastructure_agent:Dataset nike_capi_demo_20251005 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent:Created table: customers
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into customers
INFO:agentic_service.agents.infrastructure_agent:Created table: product_lines
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 50 rows into product_lines
INFO:agentic_service.agents.infrastructure_agent:Created table: products
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,000 rows into products
INFO:agentic_service.agents.infrastructure_agent:Created table: orders
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 15,000 rows into order_items
INFO:agentic_service.agents.infrastructure_agent:Created table: inventory
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 3,500 rows into inventory
INFO:agentic_service.agents.infrastructure_agent:Created table: product_releases
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 800 rows into product_releases
INFO:agentic_service.agents.infrastructure_agent:Created table: product_notifications
INFO:agentic_service.agents.infrastructure_agent:  ✓ Loaded 15,000 rows into product_notifications
INFO:agentic_service.agents.infrastructure_agent:📄 Demo report generated: /tmp/DEMO_REPORT_nike_capi_demo_20251005.md
INFO:agentic_service.agents.infrastructure_agent:Creating CAPI Data Agent...
WARNING:agentic_service.agents.infrastructure_agent:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent:Failed to create CAPI agent: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 146, in _create_capi_agent
    state: Dict
                
AttributeError: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'. Did you mean: 'Datasource'?
WARNING:agentic_service.agents.infrastructure_agent:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent:✅ Infrastructure provisioned: nike_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent:   Dataset: bq-demos-469816.nike_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent:   Tables: 8
INFO:agentic_service.agents.infrastructure_agent:   Total rows: 44,350
INFO:agentic_service.agents.infrastructure_agent:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator:Generating CAPI system instructions (YAML)
INFO:agentic_service.agents.capi_instruction_generator:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 9 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator:Generating synthetic data with smart volume strategy
INFO:agentic_service.agents.synthetic_data_generator:Generating data for categories...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ categories: 800 rows → /tmp/synthetic_data/categories.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for locations...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ locations: 800 rows → /tmp/synthetic_data/locations.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for date_dimension...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ date_dimension: 800 rows → /tmp/synthetic_data/date_dimension.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for reviews...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ reviews: 3,500 rows → /tmp/synthetic_data/reviews.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for users...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ users: 3,500 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for transactions...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ transactions: 3,500 rows → /tmp/synthetic_data/transactions.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for messages...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ messages: 3,500 rows → /tmp/synthetic_data/messages.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for listings...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ listings: 3,500 rows → /tmp/synthetic_data/listings.csv
INFO:agentic_service.agents.synthetic_data_generator:Generating data for user_engagement...
INFO:agentic_service.agents.synthetic_data_generator:  ✓ user_engagement: 15,000 rows → /tmp/synthetic_data/user_engagement.csv
INFO:agentic_service.agents.synthetic_data_generator:✅ Data generation complete. 9 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent:Provisioning BigQuery infrastructure
WARNING:agentic_service.agents.infrastructure_agent:Dataset offerup_capi_demo_20251005 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent:Created table: users
ERROR:agentic_service.agents.infrastructure_agent:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: preferred_categories
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: preferred_categories
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: preferred_categories
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: preferred_categories
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: preferred_categories
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2678, in load_table_from_file
    response = self._do_resumable_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3098, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 3167, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.12/dist-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 461, in run_demo_orchestrator
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 333, in wrapped
    state["current_stage"] = stage_name
                        ^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 51, in execute
    job_manager.add_log(
              ^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent.py", line 284, in _create_and_load_tables
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/bq-demos-469816/jobs?uploadType=resumable: Cannot load CSV data with a repeated field. Field: preferred_categories
During task with name 'infrastructure_node' and id '71844a49-9dd2-2929-8f7e-dcc26ac5b897'
INFO:routes.provisioning:Job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f finished with status failed
INFO:routes.provisioning:Client unsubscribed from job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator:Saved YAML to /tmp/capi_instructions_nike.yaml
INFO:agentic_service.agents.capi_instruction_generator:✅ CAPI system instructions generated
INFO:agentic_service.agents.capi_instruction_generator:   YAML file: /tmp/capi_instructions_nike.yaml
INFO:agentic_service.agents.capi_instruction_generator:   Size: 90,169 characters
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator:Validating demo queries...
INFO:agentic_service.agents.demo_validator:
Validating query 1: Which product lines have the highest customer retention rate...
ERROR:agentic_service.agents.demo_validator:  ❌ SQL failed: 400 Table "customers" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: customers, message: Table "customers" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 70cbde14-e6ae-4fc3-aba4-b41f230fa8bd

INFO:agentic_service.agents.demo_validator:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator:✅ Validation complete
INFO:agentic_service.agents.demo_validator:   Queries tested: 1
INFO:agentic_service.agents.demo_validator:   SQL validated: 0
INFO:agentic_service.agents.demo_validator:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job e3db8d72-6b98-4f17-999e-c5575b151744
INFO:routes.provisioning:SSE stream cancelled for job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f
INFO:routes.provisioning:Client unsubscribed from job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f
INFO:routes.provisioning:SSE stream cancelled for job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f
INFO:routes.provisioning:Client unsubscribed from job 0cdc71e1-fb01-4e52-a15a-5a30d38a203f
INFO:routes.provisioning:SSE stream cancelled for job 14fa980f-1c25-4dae-8a56-feacd6e46557
INFO:routes.provisioning:Client unsubscribed from job 14fa980f-1c25-4dae-8a56-feacd6e46557
INFO:routes.provisioning:SSE stream cancelled for job a13eb90b-37b3-4fc7-9083-5afe7fe1b23f
INFO:routes.provisioning:Client unsubscribed from job a13eb90b-37b3-4fc7-9083-5afe7fe1b23f
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:routes.provisioning:Created provisioning job 82ff9a79-c993-462f-8d79-c8556659d6c4 for https://www.sendbird.com/
INFO:routes.provisioning:Starting provisioning workflow for job 82ff9a79-c993-462f-8d79-c8556659d6c4
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 82ff9a79-c993-462f-8d79-c8556659d6c4
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.demo_orchestrator:✨ Using Research Agent V2 with Gemini 2.5 Pro (pages=30, depth=2)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:Data Modeling Agent initialized with Gemini 2.5 Pro (Vertex AI)
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 OPTIMIZED Pipeline: Research (2.5 Pro), Story (2.5 Pro), Modeling (2.5 Pro), Data (Parallel), Infra (Parallel), CAPI (Async), Validator (Parallel)
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.demo_orchestrator:✨ Using Research Agent V2 with Gemini 2.5 Pro (pages=30, depth=2)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:Data Modeling Agent initialized with Gemini 2.5 Pro (Vertex AI)
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 OPTIMIZED Pipeline: Research (2.5 Pro), Story (2.5 Pro), Modeling (2.5 Pro), Data (Parallel), Infra (Parallel), CAPI (Async), Validator (Parallel)
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.sendbird.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.sendbird.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.sendbird.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Sendbird
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.sendbird.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 11 URLs in sitemap
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.web_research:Scraped 6481 characters from https://www.sendbird.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 24 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.sendbird.com/zendesk-ai-alternative
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.sendbird.com/ai-agent/builder
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.sendbird.com/ai-agent/industries/retail
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.sendbird.com/pricing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.sendbird.com/products/customer-support
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.sendbird.com/ai-agent/industries/on-demand
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.sendbird.com/form/free-trial
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.sendbird.com/products/voice-and-video
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.sendbird.com/ai-agent/sms
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.sendbird.com/products/advanced-chat-content-moderation
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.sendbird.com/ai-agent/why-choose-sendbird
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.sendbird.com/ai/contact-sales
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.sendbird.com/ai-agent/performance
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.sendbird.com/products/salesforce-connector
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.sendbird.com/ai-agent
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.sendbird.com/ai-agent/voice
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.sendbird.com/ai-agent/product-release
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.sendbird.com/ai-agent/industries/b2b
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.sendbird.com/ai-agent/enterprise-grade
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.sendbird.com/products/business-messaging
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.sendbird.com/products/chat-messaging
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.sendbird.com/ai-agent/integrations
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.sendbird.com/ai-agent/omnipresent
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.sendbird.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.sendbird.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.sendbird.com/ai-agent/integrations
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.sendbird.com/products/chat-messaging
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.sendbird.com/products/business-messaging
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.sendbird.com/ai-agent/product-release
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.sendbird.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.sendbird.com/ai-agent/product-release/salesforce-knowledge-source
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.sendbird.com/resources?content-type=case-study&product=desk
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.sendbird.com/resources?content-type=case-study
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.sendbird.com/solutions/financial-services
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.sendbird.com/customers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.sendbird.com/news
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (31/30): https://www.sendbird.com/about
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (32/30): https://www.sendbird.com/resources?content-type=guide
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (33/30): https://www.sendbird.com/docs
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (34/30): https://www.sendbird.com/roi-calculator
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (34/30): https://www.sendbird.com/resources?content-type=case-study
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (34/30): https://www.sendbird.com/solutions/financial-services
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (34/30): https://www.sendbird.com/customers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (34/30): https://www.sendbird.com/news
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (34/30): https://www.sendbird.com/about
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 2/3 key categories, 45 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 45 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 5.29s. Visited 34 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 5.32s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 5.32s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 28.85s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 90.37s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 124.55s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 5.32s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 28.85s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 90.37s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 25.5s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 34.7s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 35.5s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 35.5s: 'From Dashboards to Decisions: Supercharging Sendbird's AI Analytics with Conversational Insights'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:🚀 Designing BigQuery schema with Gemini 2.5 Pro
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:✅ Schema design complete in 43.83s. Created 7 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 7 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 7 tables (customers, ai_agents, channels, intents, conversations, messages, message_topics)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 7 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 50 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ ai_agents: 800 rows → /tmp/synthetic_data/ai_agents.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ channels: 50 rows → /tmp/synthetic_data/channels.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ intents: 50 rows → /tmp/synthetic_data/intents.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversations: 3,500 rows → /tmp/synthetic_data/conversations.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ messages: 15,000 rows → /tmp/synthetic_data/messages.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ message_topics: 15,000 rows → /tmp/synthetic_data/message_topics.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 0.91s. 7 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: sendbird_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 7 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: messages
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: channels
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: message_topics
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: intents
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: ai_agents
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into channels
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into ai_agents
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 15,000 rows into messages
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into intents
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 15,000 rows into message_topics
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_sendbird_capi_demo_20251005.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 212, in _create_capi_agent_sync
    data_source = geminidataanalytics.DataSource()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'. Did you mean: 'Datasource'?
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 5.02s: sendbird_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.sendbird_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 7
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 34,450
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_sendbird.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 128.40s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_sendbird.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 32,486 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 821
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:sendbird_analytics was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:sendbird_analytics was not found in location US

Location: US
Job ID: c6af4d96-0bd0-4884-b330-6345684fb43a

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.40s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 82ff9a79-c993-462f-8d79-c8556659d6c4
INFO:routes.provisioning:Job 82ff9a79-c993-462f-8d79-c8556659d6c4 finished with status completed
INFO:routes.provisioning:Client unsubscribed from job 82ff9a79-c993-462f-8d79-c8556659d6c4
INFO:routes.provisioning:SSE stream cancelled for job 82ff9a79-c993-462f-8d79-c8556659d6c4
INFO:routes.provisioning:Client unsubscribed from job 82ff9a79-c993-462f-8d79-c8556659d6c4
INFO:routes.provisioning:SSE stream cancelled for job 82ff9a79-c993-462f-8d79-c8556659d6c4
INFO:routes.provisioning:Client unsubscribed from job 82ff9a79-c993-462f-8d79-c8556659d6c4
INFO:root:Received request: what are the ai agents that people have created
INFO:root:Using agent: shopify_demo_agent, dataset: sendbird_capi_demo_20251005
INFO:root:Sending response: {'response': 'I am sorry, I cannot answer this question as I do not have access to the requested information. I can only answer questions related to Shopify merchant data.', 'chartData': None, 'sqlQuery': None}
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:routes.provisioning:Created provisioning job 83c63b6f-69dc-48f2-99ed-bfbe7ea0b34d for https://www.stripe.com/
INFO:routes.provisioning:Starting provisioning workflow for job 83c63b6f-69dc-48f2-99ed-bfbe7ea0b34d
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 83c63b6f-69dc-48f2-99ed-bfbe7ea0b34d
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.demo_orchestrator:✨ Using Research Agent V2 with Gemini 2.5 Pro (pages=30, depth=2)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:Data Modeling Agent initialized with Gemini 2.5 Pro (Vertex AI)
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 OPTIMIZED Pipeline: Research (2.5 Pro), Story (2.5 Pro), Modeling (2.5 Pro), Data (Parallel), Infra (Parallel), CAPI (Async), Validator (Parallel)
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.demo_orchestrator:✨ Using Research Agent V2 with Gemini 2.5 Pro (pages=30, depth=2)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:Data Modeling Agent initialized with Gemini 2.5 Pro (Vertex AI)
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 OPTIMIZED Pipeline: Research (2.5 Pro), Story (2.5 Pro), Modeling (2.5 Pro), Data (Parallel), Infra (Parallel), CAPI (Async), Validator (Parallel)
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.stripe.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.stripe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.stripe.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Stripe
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.stripe.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.web_research:Scraped 11076 characters from https://www.stripe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 65 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.stripe.com/identity
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.stripe.com/payments/link
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.stripe.com/payments/checkout
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.stripe.com/pricing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.stripe.com/contact/sales
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.stripe.com/issuing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.stripe.com/revenue-recognition
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.stripe.com/climate
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.stripe.com/jobs
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.stripe.com/industries/retail
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.stripe.com/payments/payment-methods
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.stripe.com/use-cases/creator-economy
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.stripe.com/payouts
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.stripe.com/use-cases/ai
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.stripe.com/us/newsroom/stories/maersk-and-stripe
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 3/3 key categories, 15 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 15 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 10.77s. Visited 15 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 10.77s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 10.77s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 30.40s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 78.17s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 119.34s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 10.77s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 30.40s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 78.17s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 34.5s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 36.0s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 43.0s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 43.0s: 'Stripe: Accelerating Growth with Conversational Data Intelligence'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 3 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:🚀 Designing BigQuery schema with Gemini 2.5 Pro
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:✅ Schema design complete in 50.00s. Created 7 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 7 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 7 tables (accounts, products, customers, payments, subscriptions, payouts, support_tickets)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 7 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ accounts: 800 rows → /tmp/synthetic_data/accounts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 50 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,500 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ payments: 3,500 rows → /tmp/synthetic_data/payments.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 3,500 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ payouts: 3,000 rows → /tmp/synthetic_data/payouts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,000 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 0.48s. 7 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: stripe_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 7 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: accounts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: payouts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: payments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into payouts
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into accounts
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into payments
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_stripe_capi_demo_20251005.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 212, in _create_capi_agent_sync
    data_source = geminidataanalytics.DataSource()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'. Did you mean: 'Datasource'?
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 6.15s: stripe_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.stripe_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 7
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 17,350
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_stripe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 204.07s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_stripe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 53,860 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,261
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 400 Table "payments" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: payments, message: Table "payments" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: a934ba9f-7ec4-4307-9831-409d78cf5f24

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.21s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 83c63b6f-69dc-48f2-99ed-bfbe7ea0b34d
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 83c63b6f-69dc-48f2-99ed-bfbe7ea0b34d with demo_title=Stripe: Accelerating Growth with Conversational Data Intelligence
INFO:routes.provisioning:✅ set_results completed for job 83c63b6f-69dc-48f2-99ed-bfbe7ea0b34d
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:routes.provisioning:Getting demo assets for job 83c63b6f-69dc-48f2-99ed-bfbe7ea0b34d
ERROR:routes.provisioning:Job 83c63b6f-69dc-48f2-99ed-bfbe7ea0b34d not found
INFO:routes.provisioning:Created provisioning job 8673370b-0937-4d4d-a6aa-c5dfb76ba34b for https://www.kijiji.ca/
INFO:routes.provisioning:Starting provisioning workflow for job 8673370b-0937-4d4d-a6aa-c5dfb76ba34b
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 8673370b-0937-4d4d-a6aa-c5dfb76ba34b
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.demo_orchestrator:✨ Using Research Agent V2 with Gemini 2.5 Pro (pages=30, depth=2)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:Data Modeling Agent initialized with Gemini 2.5 Pro (Vertex AI)
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 OPTIMIZED Pipeline: Research (2.5 Pro), Story (2.5 Pro), Modeling (2.5 Pro), Data (Parallel), Infra (Parallel), CAPI (Async), Validator (Parallel)
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.demo_orchestrator:✨ Using Research Agent V2 with Gemini 2.5 Pro (pages=30, depth=2)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:Data Modeling Agent initialized with Gemini 2.5 Pro (Vertex AI)
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 OPTIMIZED Pipeline: Research (2.5 Pro), Story (2.5 Pro), Modeling (2.5 Pro), Data (Parallel), Infra (Parallel), CAPI (Async), Validator (Parallel)
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.kijiji.ca/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.kijiji.ca/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.kijiji.ca/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Kijiji
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 10 header/footer navigation links
INFO:agentic_service.tools.web_research:Scraped 1995 characters from https://www.kijiji.ca/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.kijiji.ca/b-real-estate/canada/c34l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.kijiji.ca/b-cars-vehicles/canada/c27l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.kijiji.ca/b-tires-rims/c320
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.kijiji.ca/b-services/canada/c72l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.kijiji.ca/b-jobs/canada/c45l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.kijiji.ca/b-vacation-rentals/canada/c800l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.kijiji.ca/b-community/canada/c1l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.kijiji.ca/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.kijiji.ca/b-pets/canada/c112l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.kijiji.ca/b-buy-sell/canada/c10l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.kijiji.ca/
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.kijiji.ca/b-jobs/canada/c45l0
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.kijiji.ca/b-real-estate-service/canada/c170l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.kijiji.ca/v-real-estate-service/cambridge/home-inspection/1725203275
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.kijiji.ca/b-for-sale/canada/c30353001l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.kijiji.ca/b-for-rent/canada/c30349001l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.kijiji.ca/v-room-rental-roommate/winnipeg/room-for-rent-walk-to-university/1726497237
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.kijiji.ca/v-apartments-condos/city-of-toronto/apartments-for-rent/1711095890
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.kijiji.ca/b-real-estate/canada/2-bedroom-apartment/k0c34l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.kijiji.ca/v-room-rental-roommate/cambridge/room-for-rent-in-3-bhk-townhouse/1726497248
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.kijiji.ca/b-real-estate/canada/room-for-rent/k0c34l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.kijiji.ca/b-heavy-equipment/canada/c301l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.kijiji.ca/b-motorcycles/canada/c30l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.kijiji.ca/b-cars-trucks/canada/c174l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.kijiji.ca/b-rv-camper-trailer/canada/c172l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.kijiji.ca/b-auto-parts-tires/canada/c31l0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.kijiji.ca/v-cars-trucks/bedford/2021-ford-e-series-cutaway-e450/1724332697?imageNumber=1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 2/3 key categories, 26 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 26 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 5.78s. Visited 25 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 5.78s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 5.78s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 26.23s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 74.08s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 106.09s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 5.78s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 26.23s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 74.08s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 34.6s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 37.5s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 37.5s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 37.5s: 'Kijiji: From Static Reports to Dynamic Revenue Insights with Conversational AI'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:🚀 Designing BigQuery schema with Gemini 2.5 Pro
INFO:agentic_service.agents.data_modeling_agent_gemini_pro:✅ Schema design complete in 42.04s. Created 5 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 4 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 1 tables (categories)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 4 tables (users, ads, ad_upgrades, messages)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 1 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ categories: 800 rows → /tmp/synthetic_data/categories.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 4 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ users: 3,000 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ ads: 3,500 rows → /tmp/synthetic_data/ads.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ ad_upgrades: 3,000 rows → /tmp/synthetic_data/ad_upgrades.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ messages: 3,500 rows → /tmp/synthetic_data/messages.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 0.97s. 5 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: kijiji_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 5 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: categories
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: messages
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: users
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: ads
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: ad_upgrades
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into users
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into categories
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into ads
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into ad_upgrades
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into messages
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_kijiji_capi_demo_20251005.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 212, in _create_capi_agent_sync
    data_source = geminidataanalytics.DataSource()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'. Did you mean: 'Datasource'?
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 5.13s: kijiji_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.kijiji_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 5
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 13,800
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_kijiji.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 195.13s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_kijiji.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 47,462 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,090
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:kijiji was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:kijiji was not found in location US

Location: US
Job ID: 715b14e1-e4ae-4725-983d-3340b2491b72

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.32s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 8673370b-0937-4d4d-a6aa-c5dfb76ba34b
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 8673370b-0937-4d4d-a6aa-c5dfb76ba34b with demo_title=Kijiji: From Static Reports to Dynamic Revenue Insights with Conversational AI
INFO:routes.provisioning:✅ set_results completed for job 8673370b-0937-4d4d-a6aa-c5dfb76ba34b
INFO:routes.provisioning:Job 8673370b-0937-4d4d-a6aa-c5dfb76ba34b finished with status completed
INFO:routes.provisioning:Client unsubscribed from job 8673370b-0937-4d4d-a6aa-c5dfb76ba34b
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:routes.provisioning:Created provisioning job 5c3d152b-841f-4f11-9fd2-d7174f2483ac for https://www.rome2rio.com/
INFO:routes.provisioning:Starting provisioning workflow for job 5c3d152b-841f-4f11-9fd2-d7174f2483ac
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 5c3d152b-841f-4f11-9fd2-d7174f2483ac
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.rome2rio.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.rome2rio.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.rome2rio.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Rome2Rio
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.rome2rio.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_job_scraper:No job listings found
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 0.31s. Visited 0 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 0.31s
WARNING:agentic_service.agents.research_agent_v2_gemini_pro:✗ Failed homepage: Failed to scrape https://www.rome2rio.com/: 403, message='Forbidden', url='https://www.rome2rio.com/'
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 2 succeeded, 1 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 0.31s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 8.97s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 70.91s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 80.19s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 0.31s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 8.97s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 70.91s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 24.7s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 29.4s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 39.5s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 39.5s: 'From Data Bottlenecks to Business Breakthroughs: The Conversational Analytics Revolution'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 9 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 8 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 1 tables (sales_transactions)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 8 tables (users, sessions, subscriptions, conversations, conversation_insights, products, agents, support_tickets)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 1 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ sales_transactions: 3,500 rows → /tmp/synthetic_data/sales_transactions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 8 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ users: 3,000 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ sessions: 3,500 rows → /tmp/synthetic_data/sessions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 3,000 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversations: 3,500 rows → /tmp/synthetic_data/conversations.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversation_insights: 3,500 rows → /tmp/synthetic_data/conversation_insights.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 50 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ agents: 800 rows → /tmp/synthetic_data/agents.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,500 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 2.32s. 9 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: not_available_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 9 tables IN PARALLEL...
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table users: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table support_tickets: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table sessions: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table subscriptions: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table conversations: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table products: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table sales_transactions: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table agents: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table conversation_insights: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: Unexpected response from metadata server: service account info is missing 'email' field.
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_not_available_capi_demo_20251005.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 212, in _create_capi_agent_sync
    data_source = geminidataanalytics.DataSource()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'. Did you mean: 'Datasource'?
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 17.00s: not_available_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.not_available_capi_demo_20251005
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 0
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 0
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
ERROR:agentic_service.utils.vertex_llm_client:Generation failed with CLAUDE_45: Unexpected response from metadata server: service account info is missing 'email' field.
WARNING:agentic_service.utils.vertex_llm_client:Attempt 1 failed, retrying: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.utils.vertex_llm_client:Generation failed with CLAUDE_45: Unexpected response from metadata server: service account info is missing 'email' field.
WARNING:agentic_service.utils.vertex_llm_client:Attempt 2 failed, retrying: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.utils.vertex_llm_client:Generation failed with CLAUDE_45: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.capi_instruction_generator_optimized:CAPI instruction generation failed: Unexpected response from metadata server: service account info is missing 'email' field.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/capi_instruction_generator_optimized.py", line 63, in execute
    yaml_content = await self._generate_system_instructions(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/capi_instruction_generator_optimized.py", line 143, in _generate_system_instructions
    yaml_content = await self.client.generate_with_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 204, in generate_with_retry
    return await self.generate_content(prompt, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 93, in generate_content
    return await self._generate_claude_vertex(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 178, in _generate_claude_vertex
    response = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_utils/_utils.py", line 282, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/resources/messages/messages.py", line 930, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_base_client.py", line 1324, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_base_client.py", line 1034, in request
    self._prepare_request(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_client.py", line 156, in _prepare_request
    request.headers["Authorization"] = f"Bearer {self._ensure_access_token()}"
                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_client.py", line 163, in _ensure_access_token
    self.credentials, project_id = load_auth(project_id=self.project_id)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_auth.py", line 30, in load_auth
    credentials.refresh(Request())
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 365, in refresh
    self._refresh_token(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 140, in _refresh_token
    self._retrieve_info(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 112, in _retrieve_info
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.demo_orchestrator:❌ CAPI Instruction Generator failed: Unexpected response from metadata server: service account info is missing 'email' field.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/capi_instruction_generator_optimized.py", line 63, in execute
    yaml_content = await self._generate_system_instructions(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/capi_instruction_generator_optimized.py", line 143, in _generate_system_instructions
    yaml_content = await self.client.generate_with_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 204, in generate_with_retry
    return await self.generate_content(prompt, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 93, in generate_content
    return await self._generate_claude_vertex(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 178, in _generate_claude_vertex
    response = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_utils/_utils.py", line 282, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/resources/messages/messages.py", line 930, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_base_client.py", line 1324, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_base_client.py", line 1034, in request
    self._prepare_request(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_client.py", line 156, in _prepare_request
    request.headers["Authorization"] = f"Bearer {self._ensure_access_token()}"
                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_client.py", line 163, in _ensure_access_token
    self.credentials, project_id = load_auth(project_id=self.project_id)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_auth.py", line 30, in load_auth
    credentials.refresh(Request())
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 365, in refresh
    self._refresh_token(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 140, in _refresh_token
    self._retrieve_info(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 112, in _retrieve_info
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 5c3d152b-841f-4f11-9fd2-d7174f2483ac: Unexpected response from metadata server: service account info is missing 'email' field.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 497, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/capi_instruction_generator_optimized.py", line 63, in execute
    yaml_content = await self._generate_system_instructions(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/capi_instruction_generator_optimized.py", line 143, in _generate_system_instructions
    yaml_content = await self.client.generate_with_retry(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 204, in generate_with_retry
    return await self.generate_content(prompt, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 93, in generate_content
    return await self._generate_claude_vertex(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 178, in _generate_claude_vertex
    response = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_utils/_utils.py", line 282, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/resources/messages/messages.py", line 930, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_base_client.py", line 1324, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/_base_client.py", line 1034, in request
    self._prepare_request(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_client.py", line 156, in _prepare_request
    request.headers["Authorization"] = f"Bearer {self._ensure_access_token()}"
                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_client.py", line 163, in _ensure_access_token
    self.credentials, project_id = load_auth(project_id=self.project_id)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/anthropic/lib/vertex/_auth.py", line 30, in load_auth
    credentials.refresh(Request())
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 365, in refresh
    self._refresh_token(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 140, in _refresh_token
    self._retrieve_info(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 112, in _retrieve_info
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: Unexpected response from metadata server: service account info is missing 'email' field.
During task with name 'capi_instructions_node' and id '183d4b1a-b7b2-5aed-0ea8-ac2e7b643343'
INFO:routes.provisioning:Orchestrator result status: failed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'error']
INFO:routes.provisioning:Has demo_title: False
INFO:routes.provisioning:Has golden_queries: False
INFO:routes.provisioning:Has schema: False
INFO:routes.provisioning:Job 5c3d152b-841f-4f11-9fd2-d7174f2483ac finished with status failed
INFO:routes.provisioning:Client unsubscribed from job 5c3d152b-841f-4f11-9fd2-d7174f2483ac
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:routes.provisioning:Created provisioning job a558155e-bc9c-4025-bec8-b77602306070 for https://www.runnercity.com/
INFO:routes.provisioning:Starting provisioning workflow for job a558155e-bc9c-4025-bec8-b77602306070
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job a558155e-bc9c-4025-bec8-b77602306070
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.runnercity.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.runnercity.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.runnercity.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Runnercity
INFO:agentic_service.tools.web_research:Scraped 10 characters from https://www.runnercity.com/
INFO:agentic_service.tools.v2_job_scraper:No careers page found on website
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 0 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.runnercity.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 3.23s. Visited 1 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 3.23s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 No careers page found, trying Google job search...
INFO:agentic_service.tools.v2_google_search:🔍 Searching Google for Runnercity job postings...
INFO:agentic_service.tools.v2_google_search:Found 0 unique job postings via Google search
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 9.45s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 30.01s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 67.09s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 106.55s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 9.45s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 30.01s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 67.09s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 31.5s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 33.8s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 35.9s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 35.9s: 'RunnerCity: Outpace the Competition with Conversational Data Insights'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 3 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 6 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 2 tables (date_dimension, marketing_campaigns)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 6 tables (customers, products, orders, order_items, sessions, product_inventory_history)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 2 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ date_dimension: 800 rows → /tmp/synthetic_data/date_dimension.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_campaigns: 50 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 6 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 3,500 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ sessions: 3,500 rows → /tmp/synthetic_data/sessions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_inventory_history: 3,500 rows → /tmp/synthetic_data/product_inventory_history.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 1.69s. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: runnercity_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 8 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: date_dimension
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: product_inventory_history
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into product_inventory_history
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into date_dimension
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_runnercity_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 212, in _create_capi_agent_sync
    data_source = geminidataanalytics.DataSource()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'google.cloud.geminidataanalytics' has no attribute 'DataSource'. Did you mean: 'Datasource'?
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 5.80s: runnercity_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.runnercity_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 8
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 18,650
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_runnercity.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 193.96s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_runnercity.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 58,096 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,758
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 400 Table "customers" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: customers, message: Table "customers" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 8e7eeca7-ed0e-466b-95e3-dc50489385d7

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.20s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job a558155e-bc9c-4025-bec8-b77602306070
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job a558155e-bc9c-4025-bec8-b77602306070 with demo_title=RunnerCity: Outpace the Competition with Conversational Data Insights
INFO:routes.provisioning:✅ set_results completed for job a558155e-bc9c-4025-bec8-b77602306070
INFO:routes.provisioning:Job a558155e-bc9c-4025-bec8-b77602306070 finished with status completed
INFO:routes.provisioning:Client unsubscribed from job a558155e-bc9c-4025-bec8-b77602306070
INFO:routes.provisioning:SSE stream cancelled for job a558155e-bc9c-4025-bec8-b77602306070
INFO:routes.provisioning:Client unsubscribed from job a558155e-bc9c-4025-bec8-b77602306070
INFO:routes.provisioning:Getting demo assets for job a558155e-bc9c-4025-bec8-b77602306070
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
ERROR:routes.provisioning:Error getting demo assets for job a558155e-bc9c-4025-bec8-b77602306070: 3 validation errors for DemoAssetsResponse
business_challenges.0
  Input should be a valid string [type=string_type, input_value={'challenge': 'Slow, reac... inventory management.'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
business_challenges.1
  Input should be a valid string [type=string_type, input_value={'challenge': "Inability ...ize-fits-all approach.'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
talking_track
  Input should be a valid string [type=string_type, input_value={'opening': "RunnerCity i...n your team would ask?"}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/routes/provisioning.py", line 498, in get_demo_assets
    return DemoAssetsResponse(
           ^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 3 validation errors for DemoAssetsResponse
business_challenges.0
  Input should be a valid string [type=string_type, input_value={'challenge': 'Slow, reac... inventory management.'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
business_challenges.1
  Input should be a valid string [type=string_type, input_value={'challenge': "Inability ...ize-fits-all approach.'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
talking_track
  Input should be a valid string [type=string_type, input_value={'opening': "RunnerCity i...n your team would ask?"}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
INFO:root:Received request: What is the total revenue?
INFO:root:Using agent: shopify_demo_agent, dataset: runnercity_capi_demo_20251006
ERROR:root:Error processing chat request: 400 SCHEMA_RESOLUTION: Invalid table ID "merchants;stores;orders;payments;customers;apps;store_app_installs;channels;product_categories;products;order_line_items;merchant_subscription_history;merchant_events;payment_methods;categories;customer_addresses;inventory;order_items;subscription_plans".
INFO:routes.provisioning:Getting demo assets for job a558155e-bc9c-4025-bec8-b77602306070
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
ERROR:routes.provisioning:Error getting demo assets for job a558155e-bc9c-4025-bec8-b77602306070: 3 validation errors for DemoAssetsResponse
business_challenges.0
  Input should be a valid string [type=string_type, input_value={'challenge': 'Slow, reac... inventory management.'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
business_challenges.1
  Input should be a valid string [type=string_type, input_value={'challenge': "Inability ...ize-fits-all approach.'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
talking_track
  Input should be a valid string [type=string_type, input_value={'opening': "RunnerCity i...n your team would ask?"}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/routes/provisioning.py", line 498, in get_demo_assets
    return DemoAssetsResponse(
           ^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 3 validation errors for DemoAssetsResponse
business_challenges.0
  Input should be a valid string [type=string_type, input_value={'challenge': 'Slow, reac... inventory management.'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
business_challenges.1
  Input should be a valid string [type=string_type, input_value={'challenge': "Inability ...ize-fits-all approach.'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
talking_track
  Input should be a valid string [type=string_type, input_value={'opening': "RunnerCity i...n your team would ask?"}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
INFO:routes.provisioning:SSE stream cancelled for job a558155e-bc9c-4025-bec8-b77602306070
INFO:routes.provisioning:Client unsubscribed from job a558155e-bc9c-4025-bec8-b77602306070
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:routes.provisioning:Created provisioning job fc7e1f69-f264-4ccc-b60f-392a420511d1 for https://www.stripe.com/
INFO:routes.provisioning:Starting provisioning workflow for job fc7e1f69-f264-4ccc-b60f-392a420511d1
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job fc7e1f69-f264-4ccc-b60f-392a420511d1
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.stripe.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.stripe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.stripe.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Stripe
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.stripe.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.web_research:Scraped 11076 characters from https://www.stripe.com/
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 65 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.stripe.com/startups
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.stripe.com/terminal
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.stripe.com/capital/platforms
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.stripe.com/newsroom
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.stripe.com/industries/media-entertainment
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.stripe.com/industries/insurance
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.stripe.com/use-cases/marketplaces
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.stripe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.stripe.com/use-cases/creator-economy
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.stripe.com/issuing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.stripe.com/payments/payment-links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.stripe.com/payments
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.stripe.com/authorization-boost
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.stripe.com/use-cases/global-businesses
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.stripe.com/use-cases/ecommerce
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.stripe.com/pricing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.stripe.com/financial-connections
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.stripe.com/industries/travel
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.stripe.com/blog
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.stripe.com/financial-accounts
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.stripe.com/industries/retail
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.stripe.com/connect/payouts
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.stripe.com/us/newsroom/news/bmw-and-stripe
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.stripe.com/identity
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.stripe.com/revenue-recognition
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.stripe.com/payments/elements
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.stripe.com/use-cases/ai
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.stripe.com/climate
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.stripe.com/use-cases/platforms
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.stripe.com/industries/nonprofits
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 2/3 key categories, 30 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 30 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 20.33s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 20.34s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 20.34s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:routes.provisioning:Created provisioning job 15298ded-a74a-4f9c-ae24-41081752204a for https://www.offerup.com/
INFO:routes.provisioning:Starting provisioning workflow for job 15298ded-a74a-4f9c-ae24-41081752204a
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 15298ded-a74a-4f9c-ae24-41081752204a
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.offerup.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.offerup.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.offerup.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Offerup
INFO:agentic_service.tools.v2_job_scraper:No careers page found on website
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.web_research:Scraped 5476 characters from https://www.offerup.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 0 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.offerup.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.offerup.com/explore/state
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.offerup.com/item/detail/2062c720-e793-3658-abde-2103c06e725f
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.offerup.com/item/detail/d30e5313-802e-30da-a4e7-78f22f8a63ef
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.offerup.com/item/detail/20aabba5-1db9-35d4-9bd4-d6bc7fb3c627
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.offerup.com/item/detail/30c3891a-cfc3-3cea-b900-a98b33b81948
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.offerup.com/item/detail/6e76df6f-8414-396b-8e08-4ceda31a18e7
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.offerup.com/explore/k/10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.offerup.com/item/detail/f84e9a3d-2454-3c9c-a2e9-5a657954684b
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.offerup.com/item/detail/8dd4e65d-0de8-3210-8c68-4a11cb5abbb5
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.offerup.com/explore/k/5
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.offerup.com/explore/state/mi
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.offerup.com/explore/state/vt
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.offerup.com/explore/state/nv
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.offerup.com/explore/state/oh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.offerup.com/explore/k/12
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.offerup.com/explore/k/14
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.offerup.com/explore/state/il
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.offerup.com/explore/state/ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.offerup.com/explore/state/wa
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.offerup.com/explore/state/md
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.offerup.com/explore/k/1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.offerup.com/explore/k/13
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.offerup.com/explore/k/2
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.offerup.com/explore/k/7
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.offerup.com/explore/k/6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.offerup.com/explore/k/8
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/11
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/8
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/11
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/8
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/11
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/8
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/11
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/8
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/11
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.offerup.com/item/detail/ca311a7e-e7d2-388b-9384-18ccb2dcbeee?cid=10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/item/detail/433b5391-94e2-33fc-ac99-c50937b69555?cid=10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (31/30): https://www.offerup.com/item/detail/62e481be-72c6-35b0-b926-5eec1ce86e3c?cid=10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (32/30): https://www.offerup.com/item/detail/f4aac30f-38e7-3c25-9c36-409e2f978b8e?cid=10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (33/30): https://www.offerup.com/explore/k/henna
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 6.58s. Visited 33 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 6.58s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 No careers page found, trying Google job search...
INFO:agentic_service.tools.v2_google_search:🔍 Searching Google for Offerup job postings...
INFO:agentic_service.tools.v2_google_search:Found 0 unique job postings via Google search
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 12.78s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 34.75s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 27.49s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 85.88s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 140.98s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 20.34s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 34.75s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 85.88s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 72.05s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 112.32s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 12.78s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 27.49s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 72.05s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 29.7s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 24.2s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 35.9s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 37.8s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 37.8s: 'Stripe: From Data Dependency to Data Democracy with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 3 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 30.3s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 36.2s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 36.2s: 'From Dashboards to Dialogue: Unlocking Marketplace Liquidity at OfferUp'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 3 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 7 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 5 tables (accounts, customers, subscriptions, connected_accounts, subscription_events)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 2 tables (payments, disputes)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 5 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ accounts: 3,000 rows → /tmp/synthetic_data/accounts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 3,500 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ connected_accounts: 3,000 rows → /tmp/synthetic_data/connected_accounts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscription_events: 3,500 rows → /tmp/synthetic_data/subscription_events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 2 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ payments: 3,500 rows → /tmp/synthetic_data/payments.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ disputes: 3,000 rows → /tmp/synthetic_data/disputes.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 1.93s. 7 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 7 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: accounts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: connected_accounts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: disputes
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: payments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscription_events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into accounts
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into subscription_events
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into disputes
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into connected_accounts
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into payments
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_stripe_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: Unknown field for Datasource: bigquery_dataset
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 213, in _create_capi_agent_sync
    data_source.bigquery_dataset = f"projects/{self.project_id}/datasets/{dataset_id}"
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/proto/message.py", line 902, in __setattr__
    raise AttributeError(
AttributeError: Unknown field for Datasource: bigquery_dataset
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 5.45s: stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 7
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 22,500
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 8 tables (operational.user_profiles, operational.listings, transactional.transactions, behavioral.messages, behavioral.search_queries, analytical.weekly_category_performance, analytical.listing_performance_metrics, reference.categories)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 8 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ operational.user_profiles: 3,000 rows → /tmp/synthetic_data/operational.user_profiles.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ operational.listings: 3,500 rows → /tmp/synthetic_data/operational.listings.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ transactional.transactions: 3,500 rows → /tmp/synthetic_data/transactional.transactions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ behavioral.messages: 3,500 rows → /tmp/synthetic_data/behavioral.messages.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ behavioral.search_queries: 15,000 rows → /tmp/synthetic_data/behavioral.search_queries.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ analytical.weekly_category_performance: 3,000 rows → /tmp/synthetic_data/analytical.weekly_category_performance.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ analytical.listing_performance_metrics: 3,500 rows → /tmp/synthetic_data/analytical.listing_performance_metrics.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ reference.categories: 800 rows → /tmp/synthetic_data/reference.categories.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 3.79s. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: offerup_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 8 tables IN PARALLEL...
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table operational.user_profiles: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "operational.user_profiles".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table behavioral.search_queries: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "behavioral.search_queries".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table reference.categories: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "reference.categories".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table transactional.transactions: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "transactional.transactions".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table behavioral.messages: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "behavioral.messages".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table operational.listings: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "operational.listings".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table analytical.listing_performance_metrics: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "analytical.listing_performance_metrics".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create table analytical.weekly_category_performance: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "analytical.weekly_category_performance".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "operational.user_profiles".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "operational.listings".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "transactional.transactions".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "behavioral.messages".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "behavioral.search_queries".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "analytical.weekly_category_performance".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "analytical.listing_performance_metrics".
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets/offerup_capi_demo_20251006/tables?prettyPrint=false: Invalid table ID "reference.categories".
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_offerup_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: Unknown field for Datasource: bigquery_dataset
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 213, in _create_capi_agent_sync
    table_names = [table["name"] for table in schema["tables"]]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/proto/message.py", line 902, in __setattr__
    raise AttributeError(
AttributeError: Unknown field for Datasource: bigquery_dataset
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 0.77s: offerup_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.offerup_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 0
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 0
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_stripe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 161.88s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_stripe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 43,821 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,098
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: 868ab146-9f15-4b47-8c9e-78948a7ae945

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.34s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job fc7e1f69-f264-4ccc-b60f-392a420511d1
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job fc7e1f69-f264-4ccc-b60f-392a420511d1 with demo_title=Stripe: From Data Dependency to Data Democracy with Conversational Analytics
INFO:routes.provisioning:✅ set_results completed for job fc7e1f69-f264-4ccc-b60f-392a420511d1
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_offerup.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 220.89s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_offerup.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 58,698 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,569
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:behavioral was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:behavioral was not found in location US

Location: US
Job ID: cc89f1cb-0edc-4b02-b9a7-cee5ee1c7dc5

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.35s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 15298ded-a74a-4f9c-ae24-41081752204a
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 15298ded-a74a-4f9c-ae24-41081752204a with demo_title=From Dashboards to Dialogue: Unlocking Marketplace Liquidity at OfferUp
INFO:routes.provisioning:✅ set_results completed for job 15298ded-a74a-4f9c-ae24-41081752204a
INFO:routes.provisioning:Job 15298ded-a74a-4f9c-ae24-41081752204a finished with status completed
INFO:routes.provisioning:Client unsubscribed from job 15298ded-a74a-4f9c-ae24-41081752204a
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
WARNING:root:⚠️  LOCAL MODE: Skipping CAPI agent creation (ADC not required)
INFO:root:✅ Server ready for local development
INFO:routes.provisioning:Created provisioning job 7a61773c-e3fc-4d8d-b12e-46f94b70e601 for https://www.nike.com/
INFO:routes.provisioning:Starting provisioning workflow for job 7a61773c-e3fc-4d8d-b12e-46f94b70e601
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 7a61773c-e3fc-4d8d-b12e-46f94b70e601
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.nike.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.nike.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Nike
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.nike.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 335 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.web_research:Scraped 2067 characters from https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.nike.com/w/running-clothing-37v7jz6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.nike.com/ch/en/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.nike.com/w/gifts-jordan-37eefz3b0uf
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.nike.com/w/football-shoes-3hj8mzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.nike.com/gift-cards
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.nike.com/w/kobe-pgd6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.nike.com/w/womens-sale-shoes-3yaepz5e1x6zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.nike.com/w/jordan-heat-check-1n7xt
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.nike.com/w/kids-hats-visors-and-headbands-52r49zv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.nike.com/eg/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.nike.com/w/new-upcoming-drops-k0gk
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.nike.com/il/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.nike.com/w/converse-akmjx
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.nike.com/ca/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.nike.com/sg/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.nike.com/help/a/teacher-discount
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.nike.com/w/new-kids-3n82yzv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.nike.com/at/en/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.nike.com/us/en/accessibility
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.nike.com/w/mens-sale-accessories-equipment-3yaepzawwpwznik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.nike.com/w/womens-basketball-3glsmz5e1x6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.nike.com
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.nike.com/w/joggers-sweatpants-aepf0
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.nike.com/help/a/student-discount
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.nike.com/w/baby-toddler-kids-shoes-2j488zv4dhzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.nike.com/w/acg-93bsd
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.nike.com/w/kids-accessories-equipment-awwpwzv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.nike.com/w/pegasus-shoes-8nexhzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.nike.com/w/soccer-clubs-6fu9q
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.nike.com/w/womens-color-shop-metallics-2yk8ez5e1x6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 9.99s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 9.99s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 9.99s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:routes.provisioning:Created provisioning job 0d0c5319-cb9d-478c-92f6-380b82c24ad1 for https://www.adobe.com/
INFO:routes.provisioning:Starting provisioning workflow for job 0d0c5319-cb9d-478c-92f6-380b82c24ad1
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 0d0c5319-cb9d-478c-92f6-380b82c24ad1
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.adobe.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.adobe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.adobe.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Adobe
INFO:agentic_service.tools.web_research:Scraped 1437 characters from https://www.adobe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 0 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.adobe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.adobe.com/products/premiere/app.html
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.adobe.com/homepage/fragments/loggedout/pods/news/news-pod-10-25-23-104498
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.adobe.com/acrobat.html
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.adobe.com/creativecloud/plans.html
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.adobe.com/homepage/fragments/loggedout/pods/9-18-25-ff-crtr-home/ff-crtr-home-165382
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.adobe.com/homepage/fragments/loggedout/pods/cc/link-pod-cclo-3-1-93214
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.adobe.com/homepage/fragments/loggedout/pods/ec/gen-studio-148581
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.adobe.com/homepage/fragments/loggedout/pods/max-london-tkdwn-2025/amazing-apps-catalog-152147
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.adobe.com/homepage/fragments/loggedout/row-custom-pods/marquee/marquee-post-max-london/marquee-post-max-london-ax-152147-link-cta
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.adobe.com/products/firefly/features/ai-video-generator.html
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.adobe.com/products/premiere
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.adobe.com/cc-shared/fragments/products/premiere/app/vertical-cards
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.adobe.com/cc-shared/fragments/products/premiere/app/trial
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.adobe.com/cc-shared/assets/img/product-icons/svg/premiere-pro-40.svg
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.adobe.com/cc-shared/fragments/merch/products/premiere/sticky-banner/app
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.adobe.com/creativecloud
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.adobe.com/go/video_beta
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.adobe.com/acrobat/features.html
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.adobe.com/acrobat/features
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.adobe.com/acrobat/pricing/students
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.adobe.com/dc-shared/fragments/acrobat/acrobat-subscription-features
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.adobe.com/dc-shared/fragments/faq/acrobat-overview-faq
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.adobe.com/acrobat/business
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.adobe.com/acrobat/generative-ai-pdf
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 3/3 key categories, 25 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 25 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 1.69s. Visited 25 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 31.26s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_job_scraper:No careers page found on website
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 54.54s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 No careers page found, trying Google job search...
INFO:agentic_service.tools.v2_google_search:🔍 Searching Google for Adobe job postings...
INFO:agentic_service.tools.v2_google_search:Found 0 unique job postings via Google search
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 60.74s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 30.02s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 85.08s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 126.34s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 9.99s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 31.26s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 85.08s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 32.5s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 42.9s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 43.2s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 43.2s: 'Winning the Moment: Real-Time Launch Insights for Nike'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 72.90s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 163.67s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 60.74s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 30.02s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 72.90s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:routes.provisioning:Created provisioning job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5 for https://www.airbnb.com/
INFO:routes.provisioning:Starting provisioning workflow for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.airbnb.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.airbnb.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.airbnb.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Airbnb
INFO:agentic_service.tools.web_research:Scraped 2892 characters from https://www.airbnb.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.airbnb.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 129 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.airbnb.com/porto-portugal/stays/monthly
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.airbnb.com/sitemaps/v2
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.airbnb.com/tampa-fl/stays/condos
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.airbnb.com/key-west-fl/stays/apartments
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.airbnb.com/new-york-ny/stays/monthly
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.airbnb.com/host/services
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.airbnb.com/sedona-az/stays/villas
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.airbnb.com/cleveland-oh/stays
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.airbnb.com/oklahoma-city-ok/stays/apartments
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.airbnb.com/playa-del-carmen-mexico/stays/cottages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.airbnb.com/charlotte-nc/stays/monthly
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.airbnb.com/signup_login
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.airbnb.com/release
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.airbnb.com/st-louis-mo/stays/monthly
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.airbnb.com/destin-fl/stays/apartments
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.airbnb.com/minneapolis-mn/stays
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.airbnb.com/orlando-fl/stays/apartments
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.airbnb.com/istanbul-turkiye/stays/apartments
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.airbnb.com/myrtle-beach-sc/stays/houses
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.airbnb.com/jersey-city-nj/stays/condos
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.airbnb.com/chicago-il/stays/condos
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.airbnb.com/albuquerque-nm/stays
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.airbnb.com/portland-me/stays/apartments
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.airbnb.com/portland-or/stays/cabins
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.airbnb.com/san-diego-ca/stays/cabins
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.airbnb.com/help/responsible-hosting
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.airbnb.com/kansas-city-mo/stays/condos
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.airbnb.com/washington-dc/stays/houses
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.airbnb.com/ocean-city-md/stays/houses
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.airbnb.com/pittsburgh-pa/stays
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 9.10s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 9.11s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 9.11s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 27.0s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 33.1s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 38.6s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 38.6s: 'From Data Delay to Creative Velocity: Unlocking Subscription Insights at Adobe with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 30.86s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 7 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 7 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 7 tables (customers, products, orders, order_items, campaigns, product_campaign_map, events)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 7 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 3,500 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ campaigns: 50 rows → /tmp/synthetic_data/campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_campaign_map: 800 rows → /tmp/synthetic_data/product_campaign_map.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ events: 15,000 rows → /tmp/synthetic_data/events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 3.96s. 7 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
ERROR:agentic_service.agents.infrastructure_agent_optimized:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 66, in execute
    dataset_ref = await self._create_dataset(dataset_id, customer_info, demo_story)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 252, in _create_dataset
    return await asyncio.to_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 312, in _create_dataset_sync
    dataset = self.client.create_dataset(dataset, exists_ok=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 66, in execute
    dataset_ref = await self._create_dataset(dataset_id, customer_info, demo_story)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 252, in _create_dataset
    return await asyncio.to_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 312, in _create_dataset_sync
    dataset = self.client.create_dataset(dataset, exists_ok=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 7a61773c-e3fc-4d8d-b12e-46f94b70e601: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 497, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 66, in execute
    dataset_ref = await self._create_dataset(dataset_id, customer_info, demo_story)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 252, in _create_dataset
    return await asyncio.to_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 312, in _create_dataset_sync
    dataset = self.client.create_dataset(dataset, exists_ok=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
During task with name 'infrastructure_node' and id '42103c0e-c50e-b57b-ea4f-ba191d9deb2c'
INFO:routes.provisioning:Orchestrator result status: failed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'error']
INFO:routes.provisioning:Has demo_title: False
INFO:routes.provisioning:Has golden_queries: False
INFO:routes.provisioning:Has schema: False
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 8 tables (dim_customers, dim_products, dim_plans, fact_subscriptions, fact_usage_events, fact_payments, dim_date, agg_customer_monthly_metrics)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 8 tables in PARALLEL
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 87.99s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 127.96s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 9.11s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 30.86s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 87.99s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ dim_customers: 3,000 rows → /tmp/synthetic_data/dim_customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ dim_products: 50 rows → /tmp/synthetic_data/dim_products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ dim_plans: 50 rows → /tmp/synthetic_data/dim_plans.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fact_subscriptions: 3,000 rows → /tmp/synthetic_data/fact_subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fact_usage_events: 15,000 rows → /tmp/synthetic_data/fact_usage_events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fact_payments: 3,500 rows → /tmp/synthetic_data/fact_payments.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ dim_date: 800 rows → /tmp/synthetic_data/dim_date.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ agg_customer_monthly_metrics: 15,000 rows → /tmp/synthetic_data/agg_customer_monthly_metrics.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 3.55s. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: adobe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 8 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: dim_products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: dim_plans
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fact_usage_events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fact_subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: dim_customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 15,000 rows into fact_usage_events
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into dim_plans
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into fact_subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fact_payments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: dim_date
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: agg_customer_monthly_metrics
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into dim_customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into dim_date
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into dim_products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into fact_payments
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 228 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-01-02 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 334 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-02 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 441 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-10-06 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 546 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-14 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 651 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-09-24 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 756 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-15 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 860 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-01-15 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 966 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-03 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1073 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-01-28 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1179 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-14 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1285 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-17 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1391 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-11 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1498 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-27 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 1602 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-16 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 1706 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-09-25 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 1808 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-18 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 1913 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-11-10 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2020 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-27 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 2126 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-04-11 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2232 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-05 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2337 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-09-15 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 2442 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-01-02 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 2549 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-29 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 2653 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-14 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 2760 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-10-06 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 2866 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-10-20 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 2971 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-08-11 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 3075 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-03 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 3181 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-25 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 3288 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-11-23 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 3392 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-10 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 3498 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-01-02 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 3603 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-01-02 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 3708 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-09 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 3813 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-08-14 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 3916 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-10-29 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 4021 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-04 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 4126 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-20 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 4233 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-11-17 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 4339 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-27 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 4444 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-09-12 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 4551 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-03 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 4657 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-04-22 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 4763 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-03 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 4868 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-10-26 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 4973 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-09-05 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 5078 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-26 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 5181 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-24 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 5287 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-04 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 5394 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-08 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 5499 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-27 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 5603 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-06-08 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 5707 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-06-06 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 5814 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-11-12 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 5919 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-08-17 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 6025 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-04-18 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 6131 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-24 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 6236 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-06-24 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 6343 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-19 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 6448 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-06-09 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 6553 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-11 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 6660 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-04-25 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 6765 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-01-11 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 6870 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-11-30 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 6975 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-18 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 7082 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-10-09 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 7186 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-06 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 7292 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-19 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 7399 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-04-26 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 7504 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-24 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 7608 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-27 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 7715 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-02 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 7820 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-04-11 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 7926 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-08-19 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 8031 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-19 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 8134 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-04-18 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 8239 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-23 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 8345 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-08 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 8450 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-05 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 8554 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-08 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 8657 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-01-24 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 8762 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-06-30 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 8868 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-08-29 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 8973 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-24 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 9080 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-10-05 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 9185 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-09-18 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 9289 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-07 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 9393 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-15 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 9498 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-11-05 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 9603 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-07-06 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 9710 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-10-15 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 9814 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-04-16 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 9919 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-16 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 10024 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-06-17 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 10127 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-05-15 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 10231 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2024-12-19 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 10337 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-06-23 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 10441 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-03-31 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 10548 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-09-05 00:28:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 10652 column_index: 11 column_name: "is_at_risk" column_type: BOOL value: "2025-02-26 00:28:..."
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_adobe_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: name 'schema' is not defined
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 213, in _create_capi_agent_sync
    table_names = [table["name"] for table in schema["tables"]]
                                              ^^^^^^
NameError: name 'schema' is not defined
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 9.30s: adobe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.adobe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 7
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 25,400
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 34.0s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 35.9s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 38.7s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 38.7s: 'From Dashboards to Dialogue: Unlocking Real-Time Marketplace Insights at Airbnb'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 3 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 6 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 2 tables (market_events, daily_market_metrics)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 6 tables (hosts, listings, guests, bookings, reviews, search_events)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 2 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ market_events: 800 rows → /tmp/synthetic_data/market_events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ daily_market_metrics: 40,000 rows → /tmp/synthetic_data/daily_market_metrics.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 6 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ hosts: 3,000 rows → /tmp/synthetic_data/hosts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ listings: 3,500 rows → /tmp/synthetic_data/listings.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ guests: 3,500 rows → /tmp/synthetic_data/guests.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ bookings: 3,500 rows → /tmp/synthetic_data/bookings.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ reviews: 3,500 rows → /tmp/synthetic_data/reviews.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ search_events: 40,000 rows → /tmp/synthetic_data/search_events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 12.41s. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: airbnb_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 8 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: listings
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: hosts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: search_events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: bookings
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: reviews
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: market_events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: guests
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: daily_market_metrics
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into bookings
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into listings
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into hosts
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 40,000 rows into search_events
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into guests
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into reviews
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 40,000 rows into daily_market_metrics
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 131 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-07 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 279 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-05-10 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 420 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-23 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 563 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-24 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 700 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-07-26 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 845 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-29 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 991 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-15 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1135 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-08-04 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1281 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-05 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1421 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-17 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1568 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-11 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1710 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-10-30 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1852 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-13 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 1990 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-28 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2130 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-08-19 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2274 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-12 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2414 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-23 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2558 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-07-06 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 2703 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-11-14 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2846 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-26 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2989 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-01 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3130 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-21 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3270 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-25 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3419 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-16 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 3556 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-28 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 3700 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-01 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 3850 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-14 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 3991 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-07-12 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4132 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-14 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4273 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-09 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 4408 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-26 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 4557 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-10-20 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 4701 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-11-17 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 4847 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-08-06 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 4985 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-23 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5124 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-08-29 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 5263 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-05-04 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 5408 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-05-24 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 5553 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-06 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 5693 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-16 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 5839 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-24 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 5985 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-01 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 6123 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-10-27 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 6270 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-07-04 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 6411 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-11-12 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 6554 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-12 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 6696 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-11-27 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 6838 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-16 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 6981 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-27 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 7118 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-24 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 7265 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-05-24 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 7403 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-08 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 7550 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-20 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 7691 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-05-14 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 7826 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-08 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 7970 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-10-06 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 8110 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-07-11 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 8253 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-10-02 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 8398 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-08 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 8544 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-08 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 8690 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-04 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 8834 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-30 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 8977 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-03 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 9126 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-14 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 9259 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-02-14 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 9406 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-11-06 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 9543 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-19 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 9679 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-24 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 9829 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-13 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 9975 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-28 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 10113 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-09 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 10251 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-10-10 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 10394 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-11-23 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 10538 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-17 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 10679 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-08 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 10822 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-21 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 10966 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-08-29 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 11107 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-15 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 11245 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-10-23 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 11386 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-07-10 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 11537 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-05-15 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 11680 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-10-17 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 11813 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-10 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 11955 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-17 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 12095 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-03-08 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 12239 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-30 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 12390 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-05-16 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 12536 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-11-06 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 12684 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-13 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 12825 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-21 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 12970 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-07-08 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 13108 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-21 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 13249 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-01-11 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 13386 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-30 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 13525 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-05-10 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 13662 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-04-05 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 13810 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-08-15 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 13966 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-09-08 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 14110 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2025-06-04 00:30:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 14258 column_index: 7 column_name: "expected_attendance" column_type: INT64 value: "2024-12-06 00:30:..."
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_airbnb_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: name 'schema' is not defined
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 213, in _create_capi_agent_sync
    table_names = [table["name"] for table in schema["tables"]]
                                              ^^^^^^
NameError: name 'schema' is not defined
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 7.45s: airbnb_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.airbnb_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 7
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 97,000
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:routes.provisioning:Created provisioning job 4e9f0397-4570-4551-b695-d68420729fcd for https://www.doordash.com/
INFO:routes.provisioning:Starting provisioning workflow for job 4e9f0397-4570-4551-b695-d68420729fcd
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 4e9f0397-4570-4551-b695-d68420729fcd
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 1 queries, 1 scenes, 4 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region us-east5
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.doordash.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.doordash.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.doordash.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Doordash
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.doordash.com/careers
INFO:agentic_service.tools.v2_job_scraper:No job listings found
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 0.46s. Visited 0 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 0.47s
WARNING:agentic_service.agents.research_agent_v2_gemini_pro:✗ Failed homepage: Failed to scrape https://www.doordash.com/: 403, message='Forbidden', url='https://www.doordash.com/'
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 2 succeeded, 1 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 0.47s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 10.92s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_adobe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 237.60s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_adobe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 65,927 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,701
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:adobe_analytics was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:adobe_analytics was not found in location US

Location: US
Job ID: 78771d91-b1be-4abc-a496-ad0b6062d398

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.30s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 0d0c5319-cb9d-478c-92f6-380b82c24ad1
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 0d0c5319-cb9d-478c-92f6-380b82c24ad1 with demo_title=From Data Delay to Creative Velocity: Unlocking Subscription Insights at Adobe with Conversational Analytics
INFO:routes.provisioning:✅ set_results completed for job 0d0c5319-cb9d-478c-92f6-380b82c24ad1
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 61.50s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 72.90s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 0.47s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 10.92s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 61.50s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 1 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 1 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 4 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 26.8s (4 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 31.2s (1 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 36.9s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 36.9s: 'From Static Reports to Strategic Insights in Seconds: Unlocking Data for Everyone'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 1 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_airbnb.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 271.11s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_airbnb.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 74,866 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 2,044
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 400 Invalid project ID 'your_project'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: your_project.airbnb_dataset.bookings, message: Invalid project ID 'your_project'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.

Location: US
Job ID: 22ca5b12-99af-4752-933c-d69dee9b932c

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.20s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5 with demo_title=From Dashboards to Dialogue: Unlocking Real-Time Marketplace Insights at Airbnb
INFO:routes.provisioning:✅ set_results completed for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:routes.provisioning:Job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5 finished with status completed
INFO:routes.provisioning:Client unsubscribed from job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 7 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 5 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 2 tables (marketing_campaigns, date_dimension)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 5 tables (customers, products, orders, customer_sessions, product_reviews)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 2 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_campaigns: 50 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ date_dimension: 800 rows → /tmp/synthetic_data/date_dimension.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 5 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 15,000 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customer_sessions: 40,000 rows → /tmp/synthetic_data/customer_sessions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_reviews: 3,500 rows → /tmp/synthetic_data/product_reviews.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 7.15s. 7 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 7 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: product_reviews
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customer_sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: date_dimension
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into date_dimension
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 15,000 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 40,000 rows into customer_sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into product_reviews
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_not_available_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: name 'schema' is not defined
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 213, in _create_capi_agent_sync
    schema = state.get("schema", {})
                                     
NameError: name 'schema' is not defined
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 4.11s: not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 7
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 63,150
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:routes.provisioning:SSE stream cancelled for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:routes.provisioning:Client unsubscribed from job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:routes.provisioning:Getting demo assets for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
INFO:root:Received request: Show me the weekly Gross Booking Value for Spain
INFO:root:Using agent: default, dataset: airbnb_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/shopify_demo_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/a6ed50b5-f5fb-437a-a1d9-b2de3e601b62'.
INFO:root:Received request: Compare the average monthly booking value for new hosts from Q1 2023 against experienced hosts for their first 6 months, broken down by city.
INFO:root:Using agent: default, dataset: airbnb_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/shopify_demo_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/83ca37d3-3190-4e12-bfee-289da2efe506'.
INFO:routes.provisioning:SSE stream cancelled for job 4e9f0397-4570-4551-b695-d68420729fcd
INFO:routes.provisioning:Client unsubscribed from job 4e9f0397-4570-4551-b695-d68420729fcd
INFO:routes.provisioning:SSE stream cancelled for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:routes.provisioning:Client unsubscribed from job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:routes.provisioning:SSE stream cancelled for job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:routes.provisioning:Client unsubscribed from job a1a1f2b9-dbbf-4273-bbf9-da7478d867c5
INFO:httpx:HTTP Request: POST https://us-east5-aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/us-east5/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 357.03s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 91,750 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 2,016
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 1 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:ecommerce was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:ecommerce was not found in location US

Location: US
Job ID: 8a92b901-df46-4134-930f-9a34c01a9bae

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.33s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 1
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 1
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 4e9f0397-4570-4551-b695-d68420729fcd
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 4e9f0397-4570-4551-b695-d68420729fcd with demo_title=From Static Reports to Strategic Insights in Seconds: Unlocking Data for Everyone
INFO:routes.provisioning:✅ set_results completed for job 4e9f0397-4570-4551-b695-d68420729fcd
INFO:root:🔧 Creating CAPI Data Agent...
INFO:routes.provisioning:Created provisioning job a1bf1541-b572-4aef-95f1-694dd6b4fba7 for https://www.doordash.com/
INFO:routes.provisioning:Starting provisioning workflow for job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.doordash.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.doordash.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.doordash.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Doordash
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.doordash.com/careers
INFO:agentic_service.tools.v2_job_scraper:No job listings found
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 0.46s. Visited 0 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 0.46s
WARNING:agentic_service.agents.research_agent_v2_gemini_pro:✗ Failed homepage: Failed to scrape https://www.doordash.com/: 403, message='Forbidden', url='https://www.doordash.com/'
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 2 succeeded, 1 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 0.46s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 9.97s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 67.68s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 78.12s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 0.46s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 9.97s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 67.68s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 32.4s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 35.1s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 44.4s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 44.4s: 'From Data Delays to Real-Time Decisions: Activating Your Business Intelligence with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 14 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 14 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 14 tables (users, plans, subscriptions, events, payments, products, orders, order_items, agents, conversations, conversation_topics, campaigns, campaign_attribution, returns)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 14 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ users: 3,000 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ plans: 50 rows → /tmp/synthetic_data/plans.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 3,000 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ events: 15,000 rows → /tmp/synthetic_data/events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ payments: 3,500 rows → /tmp/synthetic_data/payments.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,000 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 3,500 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ agents: 50 rows → /tmp/synthetic_data/agents.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversations: 3,500 rows → /tmp/synthetic_data/conversations.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversation_topics: 3,500 rows → /tmp/synthetic_data/conversation_topics.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ campaigns: 50 rows → /tmp/synthetic_data/campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ campaign_attribution: 3,000 rows → /tmp/synthetic_data/campaign_attribution.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ returns: 3,000 rows → /tmp/synthetic_data/returns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 2.01s. 14 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: information_not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 14 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: users
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: payments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: plans
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into plans
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 15,000 rows into events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: agents
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversation_topics
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: returns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: campaign_attribution
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into users
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into payments
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into agents
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into campaign_attribution
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into conversation_topics
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into returns
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_information_not_available_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: Unknown field for DataAgent: published_context
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 226, in _create_capi_agent_sync
    agent.published_context = published_context
    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/proto/message.py", line 902, in __setattr__
    raise AttributeError(
AttributeError: Unknown field for DataAgent: published_context
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 9.23s: information_not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.information_not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 14
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 44,950
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_information_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 205.21s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_information_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 59,087 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,477
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 400 Table "users" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: users, message: Table "users" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 596d665a-386d-4870-bb55-7f3dfa010447

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 400 Table "subscriptions" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: subscriptions, message: Table "subscriptions" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: aed229f4-6b7e-4fea-a84c-27da7267eed7

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 400 Table "payments" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: payments, message: Table "payments" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: d934e5d1-6bd6-4023-a0bc-c8cd6c10abc0

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 400 Table "events" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: events, message: Table "events" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 40fbfb5e-ddb2-4664-bda7-9a392a0b1399

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 400 Table "plans" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: plans, message: Table "plans" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 4fb2a1a0-8a42-49ee-b264-1cc68dcc9985

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.31s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job a1bf1541-b572-4aef-95f1-694dd6b4fba7 with demo_title=From Data Delays to Real-Time Decisions: Activating Your Business Intelligence with Conversational Analytics
INFO:routes.provisioning:✅ set_results completed for job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:routes.provisioning:Job a1bf1541-b572-4aef-95f1-694dd6b4fba7 finished with status completed
INFO:routes.provisioning:Client unsubscribed from job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:routes.provisioning:Job a1bf1541-b572-4aef-95f1-694dd6b4fba7 finished with status completed
INFO:routes.provisioning:Client unsubscribed from job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:routes.provisioning:SSE stream cancelled for job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:routes.provisioning:Client unsubscribed from job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:routes.provisioning:Getting demo assets for job a1bf1541-b572-4aef-95f1-694dd6b4fba7
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
INFO:root:Received request: How many total active subscriptions do we have right now?
INFO:root:Using agent: default_agent, dataset: information_not_available_capi_demo_20251006
INFO:root:Sending response: {'response': 'There are 380 active subscriptions right now.', 'chartData': None, 'sqlQuery': 'SELECT COUNT(DISTINCT t1.registration_id) AS count_of_active_registrations\nFROM `bq-demos-469816`.`leagueapps_demo`.`registrations` AS t1\nINNER JOIN `bq-demos-469816`.`leagueapps_demo`.`programs` AS t2\n  ON t1.program_id = t2.program_id\nWHERE t2.end_date > CURRENT_DATE();'}
INFO:root:🔧 Creating CAPI Data Agent...
INFO:routes.provisioning:Created provisioning job 81d4817e-b4e0-4272-ae38-717c05a3bd8b for https://www.shopify.com/
INFO:routes.provisioning:Starting provisioning workflow for job 81d4817e-b4e0-4272-ae38-717c05a3bd8b
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 81d4817e-b4e0-4272-ae38-717c05a3bd8b
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.shopify.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.shopify.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Shopify
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 50 URLs in sitemap
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.web_research:Scraped 4901 characters from https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 145 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.shopify.com/careers
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.shopify.com/at?country=at&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.shopify.com/es?country=us&lang=es
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.shopify.com/pl?country=pl&lang=pl
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.shopify.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.shopify.com/fulfillment
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.shopify.com/international
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.shopify.com/dk?country=dk&lang=da
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.shopify.com/nz?country=nz&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.shopify.com/bg?country=bg&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.shopify.com/plus/solutions/b2b-ecommerce
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.shopify.com/cl?country=cl&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.shopify.com/tour/ecommerce-website
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.shopify.com/legal/terms
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.shopify.com/partners
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.shopify.com/no?country=no&lang=nb
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.shopify.com/accessibility
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.shopify.com/orders
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.shopify.com/enterprise
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.shopify.com/blog/ecommerce-seo-beginners-guide
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.shopify.com/checkout
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.shopify.com/au?country=au&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.shopify.com/pt?country=pt&lang=pt
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.shopify.com/news
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.shopify.com/hu?country=hu&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.shopify.com/about
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.shopify.com/finance
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.shopify.com/fr?country=fr&lang=fr
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.shopify.com/legal
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.shopify.com/za?country=za&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 2/3 key categories, 29 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 29 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 6.41s. Visited 29 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 6.41s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 6.41s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 32.25s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 77.37s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 116.04s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 6.41s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 32.25s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 77.37s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 37.5s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 39.0s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 45.4s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 45.4s: 'Shopify: From Data Latency to Merchant Success with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 10 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 10 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 10 tables (merchants, subscriptions, subscription_history, stores, orders, merchant_admin_activity, support_tickets, app_installs, feature_adoptions, capital_loans)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 10 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ merchants: 3,000 rows → /tmp/synthetic_data/merchants.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 3,000 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscription_history: 3,000 rows → /tmp/synthetic_data/subscription_history.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ stores: 3,000 rows → /tmp/synthetic_data/stores.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ merchant_admin_activity: 3,500 rows → /tmp/synthetic_data/merchant_admin_activity.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,000 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ app_installs: 3,000 rows → /tmp/synthetic_data/app_installs.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ feature_adoptions: 3,000 rows → /tmp/synthetic_data/feature_adoptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ capital_loans: 800 rows → /tmp/synthetic_data/capital_loans.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 2.51s. 10 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: shopify_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 10 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: merchants
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: merchant_admin_activity
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscription_history
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: app_installs
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: stores
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: feature_adoptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into subscription_history
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into app_installs
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into merchant_admin_activity
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: capital_loans
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into merchants
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into stores
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into feature_adoptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into capital_loans
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_shopify_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
ERROR:agentic_service.agents.infrastructure_agent_optimized:Failed to create CAPI agent: 'Operation' object has no attribute 'name'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 165, in _create_capi_agent
    agent_id = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 240, in _create_capi_agent_sync
    agent_id = created_agent.name.split('/')[-1]
               ^^^^^^^^^^^^^^^^^^
AttributeError: 'Operation' object has no attribute 'name'
WARNING:agentic_service.agents.infrastructure_agent_optimized:Continuing without CAPI agent - must be created manually
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 7.14s: shopify_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.shopify_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 10
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 28,800
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: 
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_shopify.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 192.97s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_shopify.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 52,491 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,406
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:shopify_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:shopify_data was not found in location US

Location: US
Job ID: 746d0d91-5d46-4877-87cb-97cca15745b4

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:shopify_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:shopify_data was not found in location US

Location: US
Job ID: e4cdca42-d501-4b32-9c3c-2eddbf5787fa

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:shopify_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:shopify_data was not found in location US

Location: US
Job ID: f4079056-f1c9-4b92-b217-0821974b5f1e

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:shopify_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:shopify_data was not found in location US

Location: US
Job ID: 02d0d384-da93-4dc5-b271-b595c3f9e1b1

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:shopify_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:shopify_data was not found in location US

Location: US
Job ID: 94e7855e-3712-40df-a202-1b8243ec489a

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.43s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 81d4817e-b4e0-4272-ae38-717c05a3bd8b
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 81d4817e-b4e0-4272-ae38-717c05a3bd8b with demo_title=Shopify: From Data Latency to Merchant Success with Conversational Analytics
INFO:routes.provisioning:✅ set_results completed for job 81d4817e-b4e0-4272-ae38-717c05a3bd8b
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:routes.provisioning:Created provisioning job 00a7a2bf-c161-465d-b651-84a63caa5c49 for https://www.shopify.com/
INFO:routes.provisioning:Starting provisioning workflow for job 00a7a2bf-c161-465d-b651-84a63caa5c49
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 00a7a2bf-c161-465d-b651-84a63caa5c49
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.shopify.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.shopify.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Shopify
INFO:agentic_service.tools.web_research:Scraped 4901 characters from https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 50 URLs in sitemap
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.shopify.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 145 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.shopify.com/by?country=by&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.shopify.com/it?country=it&lang=it
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.shopify.com/tour/ecommerce-website
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.shopify.com/dk?country=dk&lang=da
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.shopify.com/blog/topics/founder-stories
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.shopify.com/blog/how-to-build-a-brand
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.shopify.com/plus/commerce-trends
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.shopify.com/it?country=it&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.shopify.com/gr?country=gr&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.shopify.com/lt?country=lt&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.shopify.com/se?country=se&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.shopify.com/stock-photos
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.shopify.com/kr?country=kr&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.shopify.com/bg?country=bg&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.shopify.com/be?country=be&lang=nl
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.shopify.com/channels
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.shopify.com/start
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.shopify.com/ca?country=ca&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.shopify.com/zh?country=us&lang=zh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.shopify.com/mx?country=mx&lang=es
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.shopify.com/br?country=br&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.shopify.com/cl?country=cl&lang=es
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.shopify.com/cz?country=cz&lang=cs
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.shopify.com/fulfillment
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.shopify.com/legal/privacy
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.shopify.com/za?country=za&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.shopify.com/mx?country=mx&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.shopify.com/international
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.shopify.com/at?country=at&lang=de
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.shopify.com/products
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 6.64s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 6.64s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 6.64s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 30.41s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 85.12s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 122.17s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 6.64s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 30.41s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 85.12s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 40.8s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 41.2s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 53.7s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 53.7s: 'From Dashboards to Decisions: Unlocking Merchant Success at Shopify with Conversational AI'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:routes.provisioning:Created provisioning job c0185d97-ef9d-49d8-9587-70da3e7db938 for https://www.nike.com/
INFO:routes.provisioning:Starting provisioning workflow for job c0185d97-ef9d-49d8-9587-70da3e7db938
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job c0185d97-ef9d-49d8-9587-70da3e7db938
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.nike.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.nike.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Nike
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.nike.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 335 header/footer navigation links
INFO:agentic_service.tools.web_research:Scraped 2067 characters from https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.nike.com/nl/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.nike.com/w/kids-jordan-shoes-37eefzv4dhzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.nike.com/fr/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.nike.com/w/mens-basketball-3glsmznik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.nike.com/w/big-kids-clothing-6ymx6zagibjzv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.nike.com/w/kids-sale-clothing-3yaepz6ymx6zv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.nike.com/w/jordan-sleeper-picks-3to65
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.nike.com/xl/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.nike.com/w/wnba-6ef6n
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.nike.com/help/a/change-cancel-order
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.nike.com/soccer
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.nike.com/teens
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.nike.com/il/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.nike.com/help
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.nike.com/se/en/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.nike.com/w/mens-pants-and-tights-2kq19znik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.nike.com/at/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.nike.com/w/socks-uwr3
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.nike.com/au/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.nike.com/w/womens-clothing-5e1x6z6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.nike.com/w/running-shoes-37v7jzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.nike.com/gb/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.nike.com/hu/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.nike.com/w/jordan-bags-and-backpacks-37eefz9xy71
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.nike.com/w/volleyball-tc2u
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.nike.com/w/clothing-6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.nike.com/w/baby-toddler-kids-shoes-2j488zv4dhzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.nike.com/w/pants-and-tights-2kq19
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.nike.com/tr/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 11.29s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 11.29s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 11.29s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 25.58s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 65.67s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 102.54s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 11.29s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 25.58s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 65.67s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 39.6s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 42.5s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 46.3s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 46.3s: 'From Dashboard to Dialogue: Winning the Moment with Conversational Analytics at Nike'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 8 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 8 tables (customers, products, orders, web_events, returns, promotions, campaigns, inventory_snapshots)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 8 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ web_events: 3,500 rows → /tmp/synthetic_data/web_events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ returns: 3,000 rows → /tmp/synthetic_data/returns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ promotions: 50 rows → /tmp/synthetic_data/promotions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ campaigns: 50 rows → /tmp/synthetic_data/campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ inventory_snapshots: 3,500 rows → /tmp/synthetic_data/inventory_snapshots.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 3.41s. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
ERROR:agentic_service.agents.infrastructure_agent_optimized:Infrastructure provisioning failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 66, in execute
    dataset_ref = await self._create_dataset(dataset_id, customer_info, demo_story)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 258, in _create_dataset
    return await asyncio.to_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 318, in _create_dataset_sync
    dataset = self.client.create_dataset(dataset, exists_ok=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
ERROR:agentic_service.demo_orchestrator:❌ Infrastructure Agent failed: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 66, in execute
    dataset_ref = await self._create_dataset(dataset_id, customer_info, demo_story)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 258, in _create_dataset
    return await asyncio.to_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 318, in _create_dataset_sync
    dataset = self.client.create_dataset(dataset, exists_ok=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job c0185d97-ef9d-49d8-9587-70da3e7db938: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 497, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 66, in execute
    dataset_ref = await self._create_dataset(dataset_id, customer_info, demo_story)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 258, in _create_dataset
    return await asyncio.to_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/infrastructure_agent_optimized.py", line 318, in _create_dataset_sync
    dataset = self.client.create_dataset(dataset, exists_ok=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 711, in create_dataset
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/bq-demos-469816/datasets?prettyPrint=false: Label value "nike,_inc." has invalid characters.
During task with name 'infrastructure_node' and id 'd4bea0c5-1dcc-b508-cf0b-94576873d764'
INFO:routes.provisioning:Orchestrator result status: failed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'error']
INFO:routes.provisioning:Has demo_title: False
INFO:routes.provisioning:Has golden_queries: False
INFO:routes.provisioning:Has schema: False
INFO:routes.provisioning:Created provisioning job cfcd899c-0b2e-496c-87ba-51d3f989e418 for https://www.adidas.com/
INFO:routes.provisioning:Starting provisioning workflow for job cfcd899c-0b2e-496c-87ba-51d3f989e418
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job cfcd899c-0b2e-496c-87ba-51d3f989e418
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.adidas.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.adidas.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.adidas.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Adidas
INFO:agentic_service.tools.v2_job_scraper:No careers page found on website
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 32.68s. Visited 0 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 32.68s
WARNING:agentic_service.agents.research_agent_v2_gemini_pro:✗ Failed homepage: Timeout while scraping https://www.adidas.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 2 succeeded, 1 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 No careers page found, trying Google job search...
INFO:agentic_service.tools.v2_google_search:🔍 Searching Google for Adidas job postings...
INFO:agentic_service.tools.v2_google_search:Found 0 unique job postings via Google search
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 38.89s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 9.90s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 73.80s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 122.60s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 38.89s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 9.90s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 73.80s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 32.9s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 38.4s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 42.8s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 42.8s: 'From Static Reports to Strategic Insights: Unlock Your E-commerce Data with Conversational AI'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 10 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 7 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 3 tables (marketing_campaigns, campaign_performance, support_agents)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 7 tables (customers, products, orders, order_items, conversations, conversation_topics, customer_segments_bridge)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 3 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_campaigns: 50 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ campaign_performance: 800 rows → /tmp/synthetic_data/campaign_performance.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_agents: 50 rows → /tmp/synthetic_data/support_agents.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 7 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 3,500 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversations: 3,500 rows → /tmp/synthetic_data/conversations.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversation_topics: 3,500 rows → /tmp/synthetic_data/conversation_topics.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customer_segments_bridge: 3,000 rows → /tmp/synthetic_data/customer_segments_bridge.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 0.96s. 10 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
WARNING:agentic_service.agents.infrastructure_agent_optimized:Dataset not_available_capi_demo_20251006 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 10 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: campaign_performance
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversation_topics
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_agents
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into conversation_topics
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customer_segments_bridge
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into campaign_performance
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into support_agents
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customer_segments_bridge
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_not_available_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: not_available_demo_20251006_0137
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: Not Available CAPI Demo Agent 20251006_0137
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: not_available_demo_20251006_0137
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 7.38s: not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 10
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 21,700
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: not_available_demo_20251006_0137
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 200.26s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 55,751 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,486
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:ecommerce was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:ecommerce was not found in location US

Location: US
Job ID: 47dfa8df-21e6-4314-b32d-23442c22c594

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:ecommerce was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:ecommerce was not found in location US

Location: US
Job ID: 9f226768-e0fb-4b38-9086-4ff694f722d4

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:ecommerce was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:ecommerce was not found in location US

Location: US
Job ID: a72b92d4-119f-45b9-bc99-343eb7eed43b

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:ecommerce was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:ecommerce was not found in location US

Location: US
Job ID: 5418d808-7a21-4345-a417-2c763c6b41fc

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:ecommerce was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:ecommerce was not found in location US

Location: US
Job ID: c9dfb227-11e0-46cc-a4dd-35d393236536

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.44s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job cfcd899c-0b2e-496c-87ba-51d3f989e418
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job cfcd899c-0b2e-496c-87ba-51d3f989e418 with demo_title=From Static Reports to Strategic Insights: Unlock Your E-commerce Data with Conversational AI
INFO:routes.provisioning:✅ set_results completed for job cfcd899c-0b2e-496c-87ba-51d3f989e418
INFO:routes.provisioning:Created provisioning job e2a5d145-1b8a-4696-a277-cd086b6d2823 for https://www.shopify.com/
INFO:routes.provisioning:Starting provisioning workflow for job e2a5d145-1b8a-4696-a277-cd086b6d2823
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job e2a5d145-1b8a-4696-a277-cd086b6d2823
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.shopify.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.shopify.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Shopify
INFO:agentic_service.tools.web_research:Scraped 4901 characters from https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 50 URLs in sitemap
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.shopify.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 145 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.shopify.com/ch?country=ch&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.shopify.com/news
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.shopify.com/no?country=no&lang=nb
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.shopify.com/ro?country=ro&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.shopify.com/kr?country=kr&lang=ko
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.shopify.com/es-es?country=es&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.shopify.com/ie?country=ie&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.shopify.com/th?country=th&lang=th
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.shopify.com/ng?country=ng&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.shopify.com/dk?country=dk&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.shopify.com/legal/privacy
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.shopify.com/enterprise
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.shopify.com/channels
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.shopify.com/plus
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.shopify.com/ro?country=ro&lang=ro
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.shopify.com/in-hi?country=in&lang=hi
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.shopify.com/be?country=be&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.shopify.com/ar?country=ar&lang=es
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.shopify.com/hk?country=hk&lang=zh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.shopify.com/segmentation
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.shopify.com/products
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.shopify.com/id-id?country=id&lang=id
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.shopify.com/nz?country=nz&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.shopify.com/at?country=at&lang=de
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.shopify.com/blog/how-to-scale-small-business
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.shopify.com/se?country=se&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.shopify.com/affiliates
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.shopify.com/ph?country=ph&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.shopify.com/pt?country=pt&lang=pt
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.shopify.com/hu?country=hu&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 8.25s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 8.25s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 8.25s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
ERROR:grpc._plugin_wrapping:AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x79537c5f43e0>" raised exception!
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 95, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 81, in _get_authorization_headers
    self._credentials.before_request(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 228, in before_request
    self._blocking_refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 365, in refresh
    self._refresh_token(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 140, in _refresh_token
    self._retrieve_info(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 112, in _retrieve_info
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.utils.vertex_llm_client:Generation failed with GEMINI_API: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
WARNING:agentic_service.utils.vertex_llm_client:Attempt 1 failed, retrying: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:grpc._plugin_wrapping:AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x79537c5f43e0>" raised exception!
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 95, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 81, in _get_authorization_headers
    self._credentials.before_request(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 228, in before_request
    self._blocking_refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 365, in refresh
    self._refresh_token(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 140, in _refresh_token
    self._retrieve_info(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 112, in _retrieve_info
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.utils.vertex_llm_client:Generation failed with GEMINI_API: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
WARNING:agentic_service.utils.vertex_llm_client:Attempt 2 failed, retrying: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:grpc._plugin_wrapping:AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x79537c5f43e0>" raised exception!
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 95, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 81, in _get_authorization_headers
    self._credentials.before_request(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 228, in before_request
    self._blocking_refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 365, in refresh
    self._refresh_token(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 140, in _refresh_token
    self._retrieve_info(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 112, in _retrieve_info
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.utils.vertex_llm_client:Generation failed with GEMINI_API: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.agents.research_agent_v2_gemini_pro:V2 Research (GEMINI PRO) failed: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 76, in error_remapped_callable
    return callable_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 277, in __call__
    response, ignored_call = self._with_call(
                             ^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 332, in _with_call
    return call.result(), call
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 440, in result
    raise self
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 315, in continuation
    response, call = self._thunk(new_method).with_call(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 1195, in with_call
    return _end_unary_response_blocking(state, call, True, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 1009, in _end_unary_response_blocking
    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field."
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_status:14, grpc_message:"Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing \'email\' field."}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent_v2_gemini_pro.py", line 165, in execute
    business_analysis = await self._analyze_business(intelligence_data, state)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent_v2_gemini_pro.py", line 352, in _analyze_business
    response_text = await self.client.generate_with_retry(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 204, in generate_with_retry
    return await self.generate_content(prompt, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 85, in generate_content
    return await self._generate_gemini_vertex(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 158, in _generate_gemini_vertex
    response = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/vertexai/generative_models/_generative_models.py", line 710, in generate_content
    return self._generate_content(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/vertexai/generative_models/_generative_models.py", line 833, in _generate_content
    gapic_response = self._prediction_client.generate_content(request=request)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/prediction_service/client.py", line 2302, in generate_content
    response = rpc(
               ^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ServiceUnavailable: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.demo_orchestrator:❌ Research Agent failed: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 76, in error_remapped_callable
    return callable_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 277, in __call__
    response, ignored_call = self._with_call(
                             ^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 332, in _with_call
    return call.result(), call
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 440, in result
    raise self
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 315, in continuation
    response, call = self._thunk(new_method).with_call(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 1195, in with_call
    return _end_unary_response_blocking(state, call, True, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 1009, in _end_unary_response_blocking
    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field."
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_status:14, grpc_message:"Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing \'email\' field."}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent_v2_gemini_pro.py", line 165, in execute
    business_analysis = await self._analyze_business(intelligence_data, state)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent_v2_gemini_pro.py", line 352, in _analyze_business
    response_text = await self.client.generate_with_retry(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 204, in generate_with_retry
    return await self.generate_content(prompt, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 85, in generate_content
    return await self._generate_gemini_vertex(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 158, in _generate_gemini_vertex
    response = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/vertexai/generative_models/_generative_models.py", line 710, in generate_content
    return self._generate_content(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/vertexai/generative_models/_generative_models.py", line 833, in _generate_content
    gapic_response = self._prediction_client.generate_content(request=request)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/prediction_service/client.py", line 2302, in generate_content
    response = rpc(
               ^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ServiceUnavailable: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job e2a5d145-1b8a-4696-a277-cd086b6d2823: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 76, in error_remapped_callable
    return callable_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 277, in __call__
    response, ignored_call = self._with_call(
                             ^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 332, in _with_call
    return call.result(), call
           ^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 440, in result
    raise self
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_interceptor.py", line 315, in continuation
    response, call = self._thunk(new_method).with_call(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 1195, in with_call
    return _end_unary_response_blocking(state, call, True, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_channel.py", line 1009, in _end_unary_response_blocking
    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field."
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_status:14, grpc_message:"Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing \'email\' field."}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 497, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent_v2_gemini_pro.py", line 165, in execute
    business_analysis = await self._analyze_business(intelligence_data, state)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/research_agent_v2_gemini_pro.py", line 352, in _analyze_business
    response_text = await self.client.generate_with_retry(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 204, in generate_with_retry
    return await self.generate_content(prompt, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 85, in generate_content
    return await self._generate_gemini_vertex(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 158, in _generate_gemini_vertex
    response = await asyncio.to_thread(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/vertexai/generative_models/_generative_models.py", line 710, in generate_content
    return self._generate_content(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/vertexai/generative_models/_generative_models.py", line 833, in _generate_content
    gapic_response = self._prediction_client.generate_content(request=request)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/prediction_service/client.py", line 2302, in generate_content
    response = rpc(
               ^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ServiceUnavailable: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
During task with name 'research_node' and id '6adff77b-e93f-65a0-22e1-024f893a6bf9'
INFO:routes.provisioning:Orchestrator result status: failed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'error']
INFO:routes.provisioning:Has demo_title: False
INFO:routes.provisioning:Has golden_queries: False
INFO:routes.provisioning:Has schema: False
INFO:routes.provisioning:Created provisioning job c4fda613-c6dc-44c7-8955-d15ce8f28e00 for https://www.stripe.com/
INFO:routes.provisioning:Starting provisioning workflow for job c4fda613-c6dc-44c7-8955-d15ce8f28e00
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job c4fda613-c6dc-44c7-8955-d15ce8f28e00
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.stripe.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.stripe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.stripe.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Stripe
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.stripe.com/careers
INFO:agentic_service.tools.web_research:Scraped 11076 characters from https://www.stripe.com/
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 65 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.stripe.com/use-cases/ai
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.stripe.com/climate
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.stripe.com/partners
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.stripe.com/use-cases/crypto
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.stripe.com/financial-accounts
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.stripe.com/use-cases/ecommerce
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.stripe.com/industries/nonprofits
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.stripe.com/pricing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.stripe.com/capital
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.stripe.com/professional-services
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.stripe.com/jobs
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.stripe.com/blog
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.stripe.com/customers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.stripe.com/identity
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.stripe.com/capital/platforms
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 2/3 key categories, 15 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 15 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 12.47s. Visited 15 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 12.47s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 12.47s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 31.66s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
WARNING:agentic_service.utils.vertex_llm_client:Initial JSON parse failed: Expecting value: line 95 column 17 (char 5630)
WARNING:agentic_service.utils.vertex_llm_client:Attempting JSON repair for unterminated strings/objects...
ERROR:agentic_service.utils.vertex_llm_client:JSON repair failed: Cannot repair JSON: Expecting value: line 95 column 17 (char 5630)
ERROR:agentic_service.utils.vertex_llm_client:Response text (first 500 chars): {
  "company_profile": {
    "name": "Stripe",
    "industry": "Financial Technology (Fintech)",
    "data_maturity_level": "expert"
  },
  "core_entities": [
    {
      "table_name": "accounts",
      "entity_type": "dimension",
      "description": "Represents a Stripe user, which can be a business, individual, or platform. This is the central entity for which all activity is tracked.",
      "estimated_rows": "10M-50M",
      "update_frequency": "real-time",
      "key_fields": [
        {"n...
ERROR:agentic_service.utils.vertex_llm_client:Extracted JSON text (first 500 chars): {
  "company_profile": {
    "name": "Stripe",
    "industry": "Financial Technology (Fintech)",
    "data_maturity_level": "expert"
  },
  "core_entities": [
    {
      "table_name": "accounts",
      "entity_type": "dimension",
      "description": "Represents a Stripe user, which can be a business, individual, or platform. This is the central entity for which all activity is tracked.",
      "estimated_rows": "10M-50M",
      "update_frequency": "real-time",
      "key_fields": [
        {"n...
ERROR:agentic_service.utils.vertex_llm_client:Extracted JSON text length: 23480
ERROR:agentic_service.utils.vertex_llm_client:Last 200 chars: ...nance across all analytical models.",
    "Prioritize the automation of KYC/AML document processing as it offers significant operational savings and improves the merchant onboarding experience."
  ]
}
ERROR:agentic_service.tools.v2_data_architect:Architecture inference failed: Invalid JSON response: Expecting value: line 95 column 17 (char 5630)
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 230, in parse_json_response
    return json.loads(json_text)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 95 column 17 (char 5630)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 237, in parse_json_response
    repaired = self._repair_json(json_text, e)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 290, in _repair_json
    raise ValueError(f"Cannot repair JSON: {error}")
ValueError: Cannot repair JSON: Expecting value: line 95 column 17 (char 5630)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/tools/v2_data_architect.py", line 58, in infer_architecture
    architecture = self.llm_client.parse_json_response(response)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 246, in parse_json_response
    raise ValueError(f"Invalid JSON response: {str(e)}")
ValueError: Invalid JSON response: Expecting value: line 95 column 17 (char 5630)
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 84.33s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 128.47s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 12.47s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 31.66s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 84.33s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 44.3s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 46.8s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 49.2s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 49.2s: 'Stripe: Supercharging Product Strategy with Conversational Intelligence'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 8 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 8 tables (accounts, products, transactions, product_usage, radar_assessments, disputes, payouts, support_tickets)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 8 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ accounts: 800 rows → /tmp/synthetic_data/accounts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 50 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ transactions: 3,500 rows → /tmp/synthetic_data/transactions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_usage: 3,000 rows → /tmp/synthetic_data/product_usage.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ radar_assessments: 3,500 rows → /tmp/synthetic_data/radar_assessments.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ disputes: 3,000 rows → /tmp/synthetic_data/disputes.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ payouts: 3,000 rows → /tmp/synthetic_data/payouts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,000 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 1.33s. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
WARNING:agentic_service.agents.infrastructure_agent_optimized:Dataset stripe_capi_demo_20251006 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 8 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: payouts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: product_usage
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: radar_assessments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: accounts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: disputes
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into accounts
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into radar_assessments
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into payouts
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into product_usage
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into disputes
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_stripe_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: stripe_demo_20251006_0206
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: Stripe CAPI Demo Agent 20251006_0206
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: stripe_demo_20251006_0206
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 5.41s: stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 8
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 19,850
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: stripe_demo_20251006_0206
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_stripe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 203.46s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_stripe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 55,601 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,409
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: 52091613-07fd-44a3-975c-b624ad827a1a

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: 857e4ce3-e539-450e-b374-61f9f117d6fd

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: c25945ae-f20a-4aa6-9c73-d7cf7abe11dc

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: 3ae20a5f-8d75-4687-814d-35843a2ade93

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: 816c805e-d039-4653-83e2-f0ec2c43bc27

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.78s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job c4fda613-c6dc-44c7-8955-d15ce8f28e00
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job c4fda613-c6dc-44c7-8955-d15ce8f28e00 with demo_title=Stripe: Supercharging Product Strategy with Conversational Intelligence
INFO:routes.provisioning:✅ set_results completed for job c4fda613-c6dc-44c7-8955-d15ce8f28e00
INFO:routes.provisioning:Created provisioning job 089da078-68cf-429b-96e5-2b611dda7dbd for https://www.lululemon.com/
INFO:routes.provisioning:Starting provisioning workflow for job 089da078-68cf-429b-96e5-2b611dda7dbd
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 089da078-68cf-429b-96e5-2b611dda7dbd
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.lululemon.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.lululemon.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.lululemon.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Lululemon
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.lululemon.com/careers
INFO:agentic_service.tools.v2_job_scraper:No job listings found
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 31.91s. Visited 0 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 31.92s
WARNING:agentic_service.agents.research_agent_v2_gemini_pro:✗ Failed homepage: Timeout while scraping https://www.lululemon.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 2 succeeded, 1 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 31.92s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 7.66s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 60.08s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 99.66s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 31.92s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 7.66s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 60.08s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 33.8s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 37.9s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 43.6s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 43.6s: 'From Data Delays to Real-Time Decisions: Unleash Your Business Teams with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 14 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 13 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 1 tables (marketing_campaigns)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 13 tables (customers, products, sales, campaign_attributions, support_tickets, forecasts, agents, conversations, cases, conversation_insights, orders, order_items, shipping_details)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 1 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_campaigns: 800 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 13 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ sales: 15,000 rows → /tmp/synthetic_data/sales.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ campaign_attributions: 3,500 rows → /tmp/synthetic_data/campaign_attributions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,000 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ forecasts: 3,500 rows → /tmp/synthetic_data/forecasts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ agents: 800 rows → /tmp/synthetic_data/agents.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversations: 3,500 rows → /tmp/synthetic_data/conversations.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ cases: 3,500 rows → /tmp/synthetic_data/cases.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversation_insights: 3,500 rows → /tmp/synthetic_data/conversation_insights.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 3,500 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ shipping_details: 3,500 rows → /tmp/synthetic_data/shipping_details.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 3.35s. 14 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
WARNING:agentic_service.agents.infrastructure_agent_optimized:Dataset not_available_capi_demo_20251006 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 14 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: sales
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: campaign_attributions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: agents
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: forecasts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: cases
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into campaign_attributions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversation_insights
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 201.43s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 57,165 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,388
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 400 Table "customers" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: customers, message: Table "customers" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 858ba1b9-051c-4d10-93d7-ed570c7d0b29

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 400 Table "customers" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: customers, message: Table "customers" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 49b6138f-456e-40f5-b0eb-48097b731784

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 400 Table "products" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: products, message: Table "products" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 6aaa2f1e-cf24-454e-bcd1-35b89bdfa2c1

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 400 Table "customers" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: customers, message: Table "customers" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: ed69eae7-b1ff-45f9-b8d6-67af4891199c

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 400 Table "products" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: products, message: Table "products" must be qualified with a dataset (e.g. dataset.table).

Location: US
Job ID: 5e217150-2a3a-4763-8ee7-8f56bc66ffc1

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.39s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 089da078-68cf-429b-96e5-2b611dda7dbd
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 089da078-68cf-429b-96e5-2b611dda7dbd with demo_title=From Data Delays to Real-Time Decisions: Unleash Your Business Teams with Conversational Analytics
INFO:routes.provisioning:✅ set_results completed for job 089da078-68cf-429b-96e5-2b611dda7dbd
INFO:routes.provisioning:Created provisioning job 63c7e982-e372-4849-8226-ebc730053e03 for https://www.nike.com/
INFO:routes.provisioning:Starting provisioning workflow for job 63c7e982-e372-4849-8226-ebc730053e03
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 63c7e982-e372-4849-8226-ebc730053e03
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.nike.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.nike.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Nike
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.nike.com/careers
INFO:agentic_service.tools.web_research:Scraped 2067 characters from https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 335 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.nike.com/nl/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.nike.com/w/kids-jordan-shoes-37eefzv4dhzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.nike.com/fr/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.nike.com/w/mens-basketball-3glsmznik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.nike.com/w/big-kids-clothing-6ymx6zagibjzv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.nike.com/w/kids-sale-clothing-3yaepz6ymx6zv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.nike.com/w/jordan-sleeper-picks-3to65
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.nike.com/xl/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.nike.com/w/wnba-6ef6n
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.nike.com/help/a/change-cancel-order
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.nike.com/soccer
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.nike.com/teens
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.nike.com/il/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.nike.com/help
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.nike.com/se/en/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.nike.com/w/mens-pants-and-tights-2kq19znik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.nike.com/at/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.nike.com/w/socks-uwr3
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.nike.com/au/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.nike.com/w/womens-clothing-5e1x6z6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.nike.com/w/running-shoes-37v7jzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.nike.com/gb/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.nike.com/hu/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.nike.com/w/jordan-bags-and-backpacks-37eefz9xy71
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.nike.com/w/volleyball-tc2u
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.nike.com/w/clothing-6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.nike.com/w/baby-toddler-kids-shoes-2j488zv4dhzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.nike.com/w/pants-and-tights-2kq19
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.nike.com/tr/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 13.00s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 13.04s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 13.04s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 29.15s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 76.53s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 118.74s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 13.04s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 29.15s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 76.53s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
WARNING:agentic_service.utils.vertex_llm_client:Initial JSON parse failed: Expecting value: line 15 column 1 (char 480)
WARNING:agentic_service.utils.vertex_llm_client:Attempting JSON repair for unterminated strings/objects...
ERROR:agentic_service.utils.vertex_llm_client:JSON repair failed: Cannot repair JSON: Expecting value: line 15 column 1 (char 480)
ERROR:agentic_service.utils.vertex_llm_client:Response text (first 500 chars): {
  "data_model_requirements": {
    "key_entities": [
      {
        "entity_name": "customers",
        "purpose": "Represents the core consumer base. Essential for segmentation, personalization, and CLV analysis. This entity helps answer 'Who are our most valuable customers?'",
        "key_metrics": [
          "customer_lifetime_value",
          "order_count",
          "average_order_value"
        ],
        "relationships": [
          "sales",
          "returns",
t          "customer...
ERROR:agentic_service.utils.vertex_llm_client:Extracted JSON text (first 500 chars): {
  "data_model_requirements": {
    "key_entities": [
      {
        "entity_name": "customers",
        "purpose": "Represents the core consumer base. Essential for segmentation, personalization, and CLV analysis. This entity helps answer 'Who are our most valuable customers?'",
        "key_metrics": [
          "customer_lifetime_value",
          "order_count",
          "average_order_value"
        ],
        "relationships": [
          "sales",
          "returns",
t          "customer...
ERROR:agentic_service.utils.vertex_llm_client:Extracted JSON text length: 8306
ERROR:agentic_service.utils.vertex_llm_client:Last 200 chars: ...0 (premium/launch footwear).",
      "returns.return_reason": "Categorical distribution: 40% 'Wrong Size', 20% 'Style not as Expected', 15% 'Color Mismatch', 10% 'Defective', 15% 'Other'."
    }
  }
}
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 47.3s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 58.0s (6 queries)
ERROR:agentic_service.agents.demo_story_agent_gemini_pro:Demo story creation failed: Data Specs generation failed: Invalid JSON response: Expecting value: line 15 column 1 (char 480)
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/demo_story_agent_gemini_pro.py", line 63, in execute
    demo_story = await self._create_demo_story_parallel(customer_info, state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/demo_story_agent_gemini_pro.py", line 234, in _create_demo_story_parallel
    raise ValueError(f"{task_names[i]} generation failed: {result}")
ValueError: Data Specs generation failed: Invalid JSON response: Expecting value: line 15 column 1 (char 480)
ERROR:agentic_service.demo_orchestrator:❌ Demo Story Agent failed: Data Specs generation failed: Invalid JSON response: Expecting value: line 15 column 1 (char 480)
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/demo_story_agent_gemini_pro.py", line 63, in execute
    demo_story = await self._create_demo_story_parallel(customer_info, state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/demo_story_agent_gemini_pro.py", line 234, in _create_demo_story_parallel
    raise ValueError(f"{task_names[i]} generation failed: {result}")
ValueError: Data Specs generation failed: Invalid JSON response: Expecting value: line 15 column 1 (char 480)
ERROR:agentic_service.demo_orchestrator:Demo orchestrator failed for job 63c7e982-e372-4849-8226-ebc730053e03: Data Specs generation failed: Invalid JSON response: Expecting value: line 15 column 1 (char 480)
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 497, in run_demo_orchestrator
    final_state = await graph.ainvoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3154, in ainvoke
    async for chunk in self.astream(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2976, in astream
    async for _ in runner.atick(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/demo_orchestrator.py", line 341, in wrapped
    updated_state = await agent.execute(state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/demo_story_agent_gemini_pro.py", line 63, in execute
    demo_story = await self._create_demo_story_parallel(customer_info, state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/agents/demo_story_agent_gemini_pro.py", line 234, in _create_demo_story_parallel
    raise ValueError(f"{task_names[i]} generation failed: {result}")
ValueError: Data Specs generation failed: Invalid JSON response: Expecting value: line 15 column 1 (char 480)
During task with name 'demo_story_node' and id '0e70e4bf-8795-0590-5b38-7381e10c2860'
INFO:routes.provisioning:Orchestrator result status: failed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'error']
INFO:routes.provisioning:Has demo_title: False
INFO:routes.provisioning:Has golden_queries: False
INFO:routes.provisioning:Has schema: False
INFO:routes.provisioning:Created provisioning job 0bc0ad48-b554-4aa3-96eb-d8a9e66cd2ce for https://www.adidas.com/
INFO:routes.provisioning:Starting provisioning workflow for job 0bc0ad48-b554-4aa3-96eb-d8a9e66cd2ce
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 0bc0ad48-b554-4aa3-96eb-d8a9e66cd2ce
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.adidas.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.adidas.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.adidas.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Adidas
INFO:agentic_service.tools.v2_job_scraper:No careers page found on website
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 32.21s. Visited 0 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 32.26s
WARNING:agentic_service.agents.research_agent_v2_gemini_pro:✗ Failed homepage: Timeout while scraping https://www.adidas.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 2 succeeded, 1 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 No careers page found, trying Google job search...
INFO:agentic_service.tools.v2_google_search:🔍 Searching Google for Adidas job postings...
INFO:agentic_service.tools.v2_google_search:Found 0 unique job postings via Google search
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 38.47s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 8.90s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 72.15s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 119.54s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 38.47s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 8.90s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 72.15s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 44.6s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 46.1s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 54.7s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 54.9s: 'From Data Delays to Real-Time Decisions: Unlocking Your E-commerce Growth Engine'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 14 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 12 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 2 tables (companies, marketing_campaigns)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 12 tables (plans, subscriptions, users, product_usage, support_tickets, customers, products, orders, order_items, web_sessions, product_reviews, returns)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 2 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ companies: 800 rows → /tmp/synthetic_data/companies.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_campaigns: 50 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 12 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ plans: 50 rows → /tmp/synthetic_data/plans.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 800 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ users: 3,000 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_usage: 40,000 rows → /tmp/synthetic_data/product_usage.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,000 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 3,500 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ web_sessions: 3,500 rows → /tmp/synthetic_data/web_sessions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_reviews: 3,000 rows → /tmp/synthetic_data/product_reviews.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ returns: 3,000 rows → /tmp/synthetic_data/returns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 5.99s. 14 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
WARNING:agentic_service.agents.infrastructure_agent_optimized:Dataset not_available_capi_demo_20251006 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 14 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: companies
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: plans
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: users
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: product_usage
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into users
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into plans
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 40,000 rows into product_usage
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: web_sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: product_reviews
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: returns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into companies
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into web_sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into product_reviews
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into returns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_not_available_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: not_available_demo_20251006_0233
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: Not Available CAPI Demo Agent 20251006_0233
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: not_available_demo_20251006_0233
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 9.17s: not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.not_available_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 14
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 68,000
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: not_available_demo_20251006_0233
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 215.01s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_not_available.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 63,817 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,834
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:saas_dataset was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:saas_dataset was not found in location US

Location: US
Job ID: dec69d94-4ab8-44fb-b0f0-6f2b33133036

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:saas_dataset was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:saas_dataset was not found in location US

Location: US
Job ID: fc8eb0e5-2294-4bbd-a253-5ccf4e165675

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:saas_dataset was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:saas_dataset was not found in location US

Location: US
Job ID: 3e519c85-1d08-430e-89dc-d51267c62a61

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:saas_dataset was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:saas_dataset was not found in location US

Location: US
Job ID: 3101bb8e-4f36-44f4-bbc1-ba8b6134404e

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:saas_dataset was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:saas_dataset was not found in location US

Location: US
Job ID: 56afdf1d-2a17-4ac8-9580-2e671d75d045

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.45s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 0bc0ad48-b554-4aa3-96eb-d8a9e66cd2ce
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 0bc0ad48-b554-4aa3-96eb-d8a9e66cd2ce with demo_title=From Data Delays to Real-Time Decisions: Unlocking Your E-commerce Growth Engine
INFO:routes.provisioning:✅ set_results completed for job 0bc0ad48-b554-4aa3-96eb-d8a9e66cd2ce
INFO:routes.provisioning:Getting demo assets for job c4fda613-c6dc-44c7-8955-d15ce8f28e00
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
INFO:routes.provisioning:Getting demo assets for job c4fda613-c6dc-44c7-8955-d15ce8f28e00
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:routes.provisioning:Created provisioning job b9d783bb-cc0b-4782-9dc1-48e5ee8e2fe7 for https://www.nike.com/
INFO:routes.provisioning:Starting provisioning workflow for job b9d783bb-cc0b-4782-9dc1-48e5ee8e2fe7
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job b9d783bb-cc0b-4782-9dc1-48e5ee8e2fe7
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.nike.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.nike.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Nike
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.nike.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.web_research:Scraped 2067 characters from https://www.nike.com/
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 335 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.nike.com/ch/fr/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.nike.com/launch?s=upcoming
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.nike.com/w/womens-jordan-shoes-37eefz5e1x6zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.nike.com/w/womens-hoodies-and-pullovers-5e1x6z6rive
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.nike.com/kids
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.nike.com/hu/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.nike.com/w/socks-7ny3q
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.nike.com/w/kids-hoodies-and-pullovers-6rivezv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.nike.com/w/clothing-6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.nike.com/help/a/payment-options
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.nike.com/w/mens-jordan-1-shoes-4fokyznik1zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.nike.com/w/sale-3yaep
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.nike.com/w/baby-toddler-kids-shoes-2j488zv4dhzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.nike.com/running
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.nike.com/il/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.nike.com/gift-cards
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.nike.com/ma/en/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.nike.com/za/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.nike.com/w/soccer-shoes-1gdj0zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.nike.com/react
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.nike.com/w/hoodies-and-pullovers-6rive
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.nike.com/orders/details/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.nike.com/w/mens-sale-clothing-3yaepz6ymx6znik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.nike.com/w/womens-jordan-clothing-37eefz5e1x6z6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.nike.com/w/kids-accessories-equipment-awwpwzv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.nike.com/w/mens-sale-accessories-equipment-3yaepzawwpwznik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.nike.com/w/womens-hats-visors-and-headbands-52r49z5e1x6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.nike.com/w/mens-retro-running-shoes-8kemkznik1zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.nike.com/sk/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.nike.com/id/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 11.43s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 11.45s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 11.45s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:root:Received request: Show me top 10 customers
INFO:root:Using agent: default_agent, dataset: leagueapps_demo
INFO:root:Type of m.chart.result: <class 'google.cloud.geminidataanalytics_v1alpha.types.data_chat_service.ChartResult'>
INFO:root:Value of m.chart.result: vega_config {
  fields {
    key: "transform"
    value {
      list_value {
        values {
          struct_value {
            fields {
              key: "calculate"
              value {
                string_value: "datum.first_name + \' \' + datum.last_name"
              }
            }
            fields {
              key: "as"
              value {
                string_value: "full_name"
              }
            }
          }
        }
        values {
          struct_value {
            fields {
              key: "window"
              value {
                list_value {
                  values {
                    struct_value {
                      fields {
                        key: "op"
                        value {
                          string_value: "rank"
                        }
                      }
                      fields {
                        key: "as"
                        value {
                          string_value: "rank"
                        }
                      }
                    }
                  }
                }
              }
            }
            fields {
              key: "sort"
              value {
                list_value {
                  values {
                    struct_value {
                      fields {
                        key: "order"
                        value {
                          string_value: "descending"
                        }
                      }
                      fields {
                        key: "field"
                        value {
                          string_value: "total_payment_amount"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  fields {
    key: "title"
    value {
      string_value: "Top 10 Customers by Total Payment Amount"
    }
  }
  fields {
    key: "mark"
    value {
      struct_value {
        fields {
          key: "type"
          value {
            string_value: "bar"
          }
        }
        fields {
          key: "tooltip"
          value {
            bool_value: true
          }
        }
      }
    }
  }
  fields {
    key: "encoding"
    value {
      struct_value {
        fields {
          key: "y"
          value {
            struct_value {
              fields {
                key: "type"
                value {
                  string_value: "quantitative"
                }
              }
              fields {
                key: "title"
                value {
                  string_value: "Total Payment Amount"
                }
              }
              fields {
                key: "sort"
                value {
                  struct_value {
                  }
                }
              }
              fields {
                key: "field"
                value {
                  string_value: "total_payment_amount"
                }
              }
              fields {
                key: "axis"
                value {
                  struct_value {
                    fields {
                      key: "labelOverlap"
                      value {
                        bool_value: true
                      }
                    }
                  }
                }
              }
            }
          }
        }
        fields {
          key: "x"
          value {
            struct_value {
              fields {
                key: "type"
                value {
                  string_value: "nominal"
                }
              }
              fields {
                key: "title"
                value {
                  string_value: "Customer Name"
                }
              }
              fields {
                key: "sort"
                value {
                  struct_value {
                    fields {
                      key: "order"
                      value {
                        string_value: "descending"
                      }
                    }
                    fields {
                      key: "field"
                      value {
                        string_value: "total_payment_amount"
                      }
                    }
                  }
                }
              }
              fields {
                key: "field"
                value {
                  string_value: "full_name"
                }
              }
              fields {
                key: "axis"
                value {
                  struct_value {
                    fields {
                      key: "labelOverlap"
                      value {
                        bool_value: true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  fields {
    key: "data"
    value {
      struct_value {
        fields {
          key: "values"
          value {
            list_value {
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 620
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Mueller"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Kayla"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "casey96@example.org"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 620
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Ramirez"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Hannah"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "tadams@example.com"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 616
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Stephens"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Kathleen"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "scottpatty@example.net"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 596
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Walsh"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Cheryl"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "wmartinez@example.net"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 596
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Yang"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Glenn"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "thomas75@example.net"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 579
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Dunn"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Deborah"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "justinsmith@example.org"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 576
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Miller"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Carlos"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "mwarner@example.net"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 538
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Booker"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Kristine"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "marcushayes@example.net"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 538
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Greene"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Rachel"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "elizabethobrien@example.org"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_payment_amount"
                    value {
                      number_value: 532
                    }
                  }
                  fields {
                    key: "last_name"
                    value {
                      string_value: "Jones"
                    }
                  }
                  fields {
                    key: "first_name"
                    value {
                      string_value: "Wendy"
                    }
                  }
                  fields {
                    key: "email"
                    value {
                      string_value: "torressamantha@example.net"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
image {
}

INFO:root:Type of m.chart.result.vega_config: <class 'proto.marshal.collections.maps.MapComposite'>
INFO:root:Value of m.chart.result.vega_config: <proto.marshal.collections.maps.MapComposite object at 0x783acc10b1a0>
INFO:root:Sending response: {'response': 'The chart above shows the top 10 customers by their total payment amount. The customer names are displayed on the x-axis and their total payment amounts are displayed on the y-axis. The customers are ordered by their total payment amount in descending order.', 'chartData': {'type': 'bar', 'title': 'Top 10 Customers by Total Payment Amount', 'data': [{'email': 'casey96@example.org', 'total_payment_amount': 620.0, 'first_name': 'Kayla', 'last_name': 'Mueller'}, {'email': 'tadams@example.com', 'total_payment_amount': 620.0, 'first_name': 'Hannah', 'last_name': 'Ramirez'}, {'email': 'scottpatty@example.net', 'total_payment_amount': 616.0, 'first_name': 'Kathleen', 'last_name': 'Stephens'}, {'email': 'wmartinez@example.net', 'total_payment_amount': 596.0, 'first_name': 'Cheryl', 'last_name': 'Walsh'}, {'email': 'thomas75@example.net', 'total_payment_amount': 596.0, 'first_name': 'Glenn', 'last_name': 'Yang'}, {'email': 'justinsmith@example.org', 'total_payment_amount': 579.0, 'first_name': 'Deborah', 'last_name': 'Dunn'}, {'email': 'mwarner@example.net', 'total_payment_amount': 576.0, 'first_name': 'Carlos', 'last_name': 'Miller'}, {'email': 'marcushayes@example.net', 'total_payment_amount': 538.0, 'first_name': 'Kristine', 'last_name': 'Booker'}, {'email': 'elizabethobrien@example.org', 'total_payment_amount': 538.0, 'first_name': 'Rachel', 'last_name': 'Greene'}, {'email': 'torressamantha@example.net', 'total_payment_amount': 532.0, 'first_name': 'Wendy', 'last_name': 'Jones'}], 'xKey': 'full_name', 'yKey': 'total_payment_amount', 'nameKey': None}, 'sqlQuery': 'SELECT\n  t1.first_name, t1.last_name, t1.email, SUM(t3.amount) AS total_payment_amount\nFROM `bq-demos-469816`.`leagueapps_demo`.`users` AS t1\nINNER JOIN `bq-demos-469816`.`leagueapps_demo`.`registrations` AS t2\n  ON t1.user_id = t2.user_id\nINNER JOIN `bq-demos-469816`.`leagueapps_demo`.`payments` AS t3\n  ON t2.registration_id = t3.registration_id\nGROUP BY t1.user_id, t1.first_name, t1.last_name, t1.email\nORDER BY SUM(t3.amount) DESC\nLIMIT 10;'}
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 30.68s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 82.87s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 125.00s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 11.45s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 30.68s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 82.87s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 35.7s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 41.9s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 44.2s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 44.2s: 'Nike: From Hype to Insight - Winning the Next Launch with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:routes.provisioning:Created provisioning job 27ddb089-43ca-4c84-83fe-10950a7b5664 for https://www.nike.com/
INFO:routes.provisioning:Starting provisioning workflow for job 27ddb089-43ca-4c84-83fe-10950a7b5664
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 27ddb089-43ca-4c84-83fe-10950a7b5664
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.nike.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.nike.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Nike
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.nike.com/careers
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.web_research:Scraped 2067 characters from https://www.nike.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 335 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.nike.com/ch/fr/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.nike.com/launch?s=upcoming
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.nike.com/w/womens-jordan-shoes-37eefz5e1x6zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.nike.com/w/womens-hoodies-and-pullovers-5e1x6z6rive
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.nike.com/kids
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.nike.com/hu/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.nike.com/w/socks-7ny3q
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.nike.com/w/kids-hoodies-and-pullovers-6rivezv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.nike.com/w/clothing-6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.nike.com/help/a/payment-options
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.nike.com/w/mens-jordan-1-shoes-4fokyznik1zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.nike.com/w/sale-3yaep
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.nike.com/w/baby-toddler-kids-shoes-2j488zv4dhzy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.nike.com/running
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.nike.com/il/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.nike.com/gift-cards
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.nike.com/ma/en/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.nike.com/za/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.nike.com/w/soccer-shoes-1gdj0zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.nike.com/react
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.nike.com/w/hoodies-and-pullovers-6rive
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.nike.com/orders/details/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.nike.com/w/mens-sale-clothing-3yaepz6ymx6znik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.nike.com/w/womens-jordan-clothing-37eefz5e1x6z6ymx6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.nike.com/w/kids-accessories-equipment-awwpwzv4dh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.nike.com/w/mens-sale-accessories-equipment-3yaepzawwpwznik1
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.nike.com/w/womens-hats-visors-and-headbands-52r49z5e1x6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.nike.com/w/mens-retro-running-shoes-8kemkznik1zy7ok
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.nike.com/sk/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.nike.com/id/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 14.25s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 14.25s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 14.25s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:routes.provisioning:Created provisioning job 765b09e5-64b0-4bad-8b0a-8656ecda640a for https://www.offerup.com/
INFO:routes.provisioning:Starting provisioning workflow for job 765b09e5-64b0-4bad-8b0a-8656ecda640a
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 765b09e5-64b0-4bad-8b0a-8656ecda640a
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.offerup.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.offerup.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.offerup.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Offerup
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_job_scraper:No careers page found on website
INFO:agentic_service.tools.web_research:Scraped 5570 characters from https://www.offerup.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 0 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.offerup.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.offerup.com/explore/state
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.offerup.com/item/detail/b0a09fa2-b7b4-302f-8d8b-9aee152b3ba8
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.offerup.com/item/detail/8a7d1ac5-85b2-3ca6-88b2-9744f231566f
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.offerup.com/item/detail/4d1d629c-e4d8-3f11-a074-2f00a52801f2
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.offerup.com/item/detail/1b001b56-11a2-3f91-8b8c-894203170317
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.offerup.com/item/detail/8dd4e65d-0de8-3210-8c68-4a11cb5abbb5
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.offerup.com/item/detail/911d9e06-e7f5-3ae7-b0ec-a8e37ed5a888
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.offerup.com/item/detail/f50b60b8-c92b-3797-973b-dfdef73cb3fb
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.offerup.com/item/detail/40603f97-6cbe-31b3-b44b-f76ad88af548
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.offerup.com/item/detail/61484968-a52c-38f0-844f-98f5fa4f19f8
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.offerup.com/explore/state/hi
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.offerup.com/explore/state/ca
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.offerup.com/explore/state/ne
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.offerup.com/explore/state/nc
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.offerup.com/explore/state/or
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.offerup.com/explore/state/mt
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.offerup.com/explore/state/ar
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.offerup.com/explore/k/11
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.offerup.com/explore/state/nm
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.offerup.com/explore/state/ny
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.offerup.com/explore/k/7
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.offerup.com/explore/k/3
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.offerup.com/explore/k/8
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.offerup.com/explore/k/13
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.offerup.com/explore/k/6
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.offerup.com/explore/k/12
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.offerup.com/explore/k/10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.offerup.com/explore/k/14
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/5
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/12
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/14
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/5
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/12
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/14
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/5
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/12
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/10
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.offerup.com/explore/k/14
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 6.84s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 6.84s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 No careers page found, trying Google job search...
INFO:agentic_service.tools.v2_google_search:🔍 Searching Google for Offerup job postings...
INFO:agentic_service.tools.v2_google_search:Found 0 unique job postings via Google search
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 13.07s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 27.89s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 27.26s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 10 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 8 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 2 tables (marketing_campaigns, customer_segments)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 8 tables (customers, products, orders, order_items, product_launches, customer_sessions, inventory_snapshots, customer_segment_membership)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 2 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_campaigns: 800 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customer_segments: 50 rows → /tmp/synthetic_data/customer_segments.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 8 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 15,000 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_launches: 50 rows → /tmp/synthetic_data/product_launches.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customer_sessions: 3,500 rows → /tmp/synthetic_data/customer_sessions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ inventory_snapshots: 3,000 rows → /tmp/synthetic_data/inventory_snapshots.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customer_segment_membership: 3,000 rows → /tmp/synthetic_data/customer_segment_membership.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 3.40s. 10 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: nike_inc_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 10 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: product_launches
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: inventory_snapshots
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customer_sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into product_launches
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customer_segments
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 15,000 rows into order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customer_segment_membership
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into inventory_snapshots
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into customer_segments
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into customer_sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customer_segment_membership
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_nike_inc_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: nike__inc__demo_20251006_0257
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: Nike, Inc. CAPI Demo Agent 20251006_0257
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.nike_inc_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: nike__inc__demo_20251006_0257
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 7.54s: nike_inc_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.nike_inc_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 10
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 32,700
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: nike__inc__demo_20251006_0257
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:routes.provisioning:SSE stream cancelled for job 765b09e5-64b0-4bad-8b0a-8656ecda640a
INFO:routes.provisioning:Client unsubscribed from job 765b09e5-64b0-4bad-8b0a-8656ecda640a
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 86.04s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 128.19s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 14.25s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 27.89s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 86.04s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 91.32s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 131.66s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 13.07s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 27.26s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 91.32s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 38.4s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 42.8s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 54.6s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 54.6s: 'Nike: From Hype to High Margin - Winning the Moment with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 41.1s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 41.9s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 44.7s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 44.7s: 'OfferUp: From Data Delays to Marketplace Velocity with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 10 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 6 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 4 tables (customer_segments, campaigns_launches, social_media_mentions, store_locations)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 6 tables (customers, products, orders, order_items, marketing_attribution, inventory_levels)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 4 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customer_segments: 50 rows → /tmp/synthetic_data/customer_segments.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ campaigns_launches: 50 rows → /tmp/synthetic_data/campaigns_launches.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ social_media_mentions: 3,500 rows → /tmp/synthetic_data/social_media_mentions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ store_locations: 800 rows → /tmp/synthetic_data/store_locations.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 6 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 3,000 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 15,000 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_attribution: 3,500 rows → /tmp/synthetic_data/marketing_attribution.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ inventory_levels: 3,000 rows → /tmp/synthetic_data/inventory_levels.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 2.40s. 10 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
WARNING:agentic_service.agents.infrastructure_agent_optimized:Dataset nike_inc_capi_demo_20251006 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 10 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: campaigns_launches
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customer_segments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_attribution
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: social_media_mentions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: store_locations
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into customer_segments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: inventory_levels
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into campaigns_launches
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into marketing_attribution
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into social_media_mentions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into store_locations
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into inventory_levels
ERROR:agentic_service.agents.infrastructure_agent_optimized:Table operation failed: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 121 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-03 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 244 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-21 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 367 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-04-16 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 489 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-17 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 611 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-02-25 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 732 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-03-27 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 854 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-29 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 975 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-12 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1097 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-07 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1222 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-10-09 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1345 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-10-13 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1470 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-09-05 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1594 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-04 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 1716 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-24 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 1840 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-06 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 1964 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-11 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2088 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-26 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2210 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-10-09 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 2334 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-12 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2459 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-03-01 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2580 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-15 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 2703 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-03-26 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 2826 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-10 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 2951 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-02 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 3073 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-10-23 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 3196 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-09-14 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 3318 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-02 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 3443 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-05 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 3566 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-30 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 3687 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-05-11 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 3810 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-12 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 3933 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-07-02 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 4055 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-09 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 4178 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-04-14 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 4302 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-20 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 4426 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-11 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 4551 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-04-21 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 4673 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-08-18 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 4794 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-09-03 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 4917 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-19 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 5041 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-05-22 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 5162 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-27 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 5284 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-09-22 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 5408 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-24 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 5533 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-25 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 5654 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-05-19 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 5778 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-10-07 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 5902 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-09-28 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 6025 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-01 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 6148 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-12 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 6269 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-04-17 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 6391 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-14 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 6514 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-16 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 6637 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-02-24 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 6761 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-05-31 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 6882 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-09-10 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 7003 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-10-31 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 7126 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-23 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 7247 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-05-19 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 7367 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-24 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 7489 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-16 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 7611 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-08-27 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 7736 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-07-10 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 7860 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-29 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 7982 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-04-22 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 8105 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-05-10 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 8228 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-02-28 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 8351 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-28 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 8473 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-10-06 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 8596 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-10-12 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 8718 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-28 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 8841 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-24 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 8963 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-08 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 9087 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-04-08 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 9210 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-03-19 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 9331 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-09-10 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 9451 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-03-01 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 9575 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-16 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 9696 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-08-08 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 9819 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-12-20 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 9942 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-03-13 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 10065 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-09-08 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 10189 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-18 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 10310 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-01-23 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 10433 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-20 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 10554 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-14 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 10677 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-03-29 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 10798 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-05-14 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 10921 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-07-16 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 11045 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-04-03 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 11169 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-14 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 11291 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-03-05 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 11414 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-01 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 11536 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-28 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 11658 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2024-11-26 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 11781 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-04-25 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 11905 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-02-22 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 12026 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-02-27 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 12149 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-07-08 03:00:..."; reason: invalid, message: Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 12271 column_index: 4 column_name: "price_at_sale" column_type: DOUBLE value: "2025-06-19 03:00:..."
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_nike_inc_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: nike__inc__demo_20251006_0300
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: Nike, Inc. CAPI Demo Agent 20251006_0300
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.nike_inc_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: nike__inc__demo_20251006_0300
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 7.76s: nike_inc_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.nike_inc_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 9
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 20,400
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: nike__inc__demo_20251006_0300
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 8 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 7 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 1 tables (categories)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 7 tables (users, listings, transactions, user_sessions, search_events, messages, support_tickets)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 1 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ categories: 50 rows → /tmp/synthetic_data/categories.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 7 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ users: 3,000 rows → /tmp/synthetic_data/users.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ listings: 3,000 rows → /tmp/synthetic_data/listings.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ transactions: 3,000 rows → /tmp/synthetic_data/transactions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ user_sessions: 3,500 rows → /tmp/synthetic_data/user_sessions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ search_events: 3,500 rows → /tmp/synthetic_data/search_events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ messages: 3,500 rows → /tmp/synthetic_data/messages.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 800 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 1.66s. 8 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
WARNING:agentic_service.agents.infrastructure_agent_optimized:Dataset offerup_capi_demo_20251006 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 8 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: categories
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: user_sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: users
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: search_events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: listings
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into user_sessions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: messages
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into categories
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into users
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into listings
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into search_events
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into messages
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_offerup_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: offerup_demo_20251006_0301
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: OfferUp CAPI Demo Agent 20251006_0301
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.offerup_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: offerup_demo_20251006_0301
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 7.47s: offerup_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.offerup_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 8
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 20,350
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: offerup_demo_20251006_0301
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_nike,_inc..yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 208.57s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_nike,_inc..yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 60,004 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,542
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:nike_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike_data was not found in location US

Location: US
Job ID: 74ea734d-b4c9-4c44-92b1-963cdfcc91e8

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:nike_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike_data was not found in location US

Location: US
Job ID: 36f496cb-7a65-44b8-a658-4d9173f1edb4

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:nike_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike_data was not found in location US

Location: US
Job ID: 820c4428-dcc7-4425-a0ec-e9dc093dc142

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:nike_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike_data was not found in location US

Location: US
Job ID: 658bd1ae-cd03-478b-9645-2bdf55faac0b

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:nike_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike_data was not found in location US

Location: US
Job ID: ba81f7fe-7d4c-4436-9d6d-e87253664c84

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 1.42s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job b9d783bb-cc0b-4782-9dc1-48e5ee8e2fe7
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job b9d783bb-cc0b-4782-9dc1-48e5ee8e2fe7 with demo_title=Nike: From Hype to Insight - Winning the Next Launch with Conversational Analytics
ERROR:routes.provisioning:Provisioning workflow error for job b9d783bb-cc0b-4782-9dc1-48e5ee8e2fe7: JobStateManager.set_results() got an unexpected keyword argument 'dataset_full_name'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/routes/provisioning.py", line 137, in run_provisioning_workflow
    job_manager.set_results(
TypeError: JobStateManager.set_results() got an unexpected keyword argument 'dataset_full_name'
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_nike,_inc..yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 204.01s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_nike,_inc..yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 55,303 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,337
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:nike was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike was not found in location US

Location: US
Job ID: b1a68d2a-2a1a-4105-a9e9-0822bbd88722

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:nike was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike was not found in location US

Location: US
Job ID: 6e693fb5-1551-4846-8b33-5a9135724cb9

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:nike was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike was not found in location US

Location: US
Job ID: 816a4bae-5b83-444b-85f7-27cad506d6d0

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:nike was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike was not found in location US

Location: US
Job ID: 0542175a-7766-4a9d-93a9-766b99b42735

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:nike was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:nike was not found in location US

Location: US
Job ID: 656a97e9-b298-4b12-89eb-388f67d149ef

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.43s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 27ddb089-43ca-4c84-83fe-10950a7b5664
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 27ddb089-43ca-4c84-83fe-10950a7b5664 with demo_title=Nike: From Hype to High Margin - Winning the Moment with Conversational Analytics
ERROR:routes.provisioning:Provisioning workflow error for job 27ddb089-43ca-4c84-83fe-10950a7b5664: JobStateManager.set_results() got an unexpected keyword argument 'dataset_full_name'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/routes/provisioning.py", line 137, in run_provisioning_workflow
    job_manager.set_results(
TypeError: JobStateManager.set_results() got an unexpected keyword argument 'dataset_full_name'
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_offerup.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 194.06s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_offerup.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 51,520 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,294
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US

Location: US
Job ID: 4ef2c97f-6490-41ee-9e87-e0f1cd8e2031

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US

Location: US
Job ID: e80affed-7709-46a7-b914-06c9ba31a6cf

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US

Location: US
Job ID: 7ac72e16-4f4e-46bc-9272-deafe2d66741

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US

Location: US
Job ID: 802f1d4b-7140-428f-aac2-4cf87d20dece

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:offerup_analytics was not found in location US

Location: US
Job ID: e5dd5c44-b286-4baa-bf72-1feee18304ba

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.44s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 765b09e5-64b0-4bad-8b0a-8656ecda640a
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 765b09e5-64b0-4bad-8b0a-8656ecda640a with demo_title=OfferUp: From Data Delays to Marketplace Velocity with Conversational Analytics
ERROR:routes.provisioning:Provisioning workflow error for job 765b09e5-64b0-4bad-8b0a-8656ecda640a: JobStateManager.set_results() got an unexpected keyword argument 'dataset_full_name'
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/routes/provisioning.py", line 137, in run_provisioning_workflow
    job_manager.set_results(
TypeError: JobStateManager.set_results() got an unexpected keyword argument 'dataset_full_name'
INFO:routes.provisioning:Job 765b09e5-64b0-4bad-8b0a-8656ecda640a finished with status failed
INFO:routes.provisioning:Client unsubscribed from job 765b09e5-64b0-4bad-8b0a-8656ecda640a
INFO:root:🔧 Creating CAPI Data Agent...
INFO:routes.provisioning:Created provisioning job 62edf36a-3768-4568-96a8-5d8d939ee7e4 for https://www.lululemon.com/
INFO:routes.provisioning:Starting provisioning workflow for job 62edf36a-3768-4568-96a8-5d8d939ee7e4
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 62edf36a-3768-4568-96a8-5d8d939ee7e4
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.lululemon.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.lululemon.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.lululemon.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Lululemon
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.lululemon.com/careers
INFO:agentic_service.tools.v2_job_scraper:No job listings found
INFO:routes.provisioning:Created provisioning job d25289df-abc7-4066-bb6c-38b9d1f85e12 for https://www.solarwinds.com/
INFO:routes.provisioning:Starting provisioning workflow for job d25289df-abc7-4066-bb6c-38b9d1f85e12
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job d25289df-abc7-4066-bb6c-38b9d1f85e12
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.solarwinds.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.solarwinds.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.solarwinds.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Solarwinds
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.solarwinds.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 50 URLs in sitemap
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.web_research:Scraped 6080 characters from https://www.solarwinds.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 85 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.solarwinds.com/solutions/cloud-migration
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.solarwinds.com/secure-by-design-resources
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.solarwinds.com/solutions/aws-monitoring
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.solarwinds.com/blog
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.solarwinds.com/solutions/postgres
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.solarwinds.com/database/monitoring
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.solarwinds.com/network-topology-mapper
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.solarwinds.com/itsm/esm
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.solarwinds.com/solutions/infrastructure-solutions
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.solarwinds.com/solutions/azure-monitoring
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.solarwinds.com/solarwinds-observability
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.solarwinds.com/company/contact-us
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.solarwinds.com/solutions/solarwinds-observability/devops
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.solarwinds.com/observability/infrastructure
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.solarwinds.com/solutions/sql-diagnostic-solutions
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.solarwinds.com/web-accessibility-statement
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.solarwinds.com/solutions
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.solarwinds.com/database/diagnose
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.solarwinds.com/pricing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.solarwinds.com/company
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.solarwinds.com/database/optimize
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.solarwinds.com/events
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.solarwinds.com/serv-u-managed-file-transfer-server
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.solarwinds.com/it-incident-response-software
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.solarwinds.com/solutions/user-experience-monitoring
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.solarwinds.com/incident-response
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.solarwinds.com/solutions/it-automation-software-solutions
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.solarwinds.com/resources
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.solarwinds.com/solarwinds-platform
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 3/3 key categories, 29 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 29 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 12.05s. Visited 29 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 12.05s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 12.05s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 32.52s. Visited 0 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 32.52s
WARNING:agentic_service.agents.research_agent_v2_gemini_pro:✗ Failed homepage: Timeout while scraping https://www.lululemon.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 2 succeeded, 1 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 32.52s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 10.14s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 32.85s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:routes.provisioning:Getting demo assets for job test-12345
ERROR:routes.provisioning:Job test-12345 not found
INFO:root:Received request: Show me top 10 customers
INFO:root:Using agent: nike_demo_agent, dataset: nike_capi_demo_20251005
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 70.50s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 113.17s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 32.52s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 10.14s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 70.50s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/e3c349db-9044-4b6b-b5ac-93fbf63afe7c'.
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 86.93s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 131.82s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 12.05s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 32.85s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 86.93s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:root:Received request: Show me total revenue
INFO:root:Using agent: default_agent, dataset: nike_capi_demo_20251005
INFO:root:Sending response: {'response': 'The total revenue is 75126.', 'chartData': None, 'sqlQuery': 'SELECT SUM(payments.amount) AS sum_of_amounts\nFROM `bq-demos-469816`.`leagueapps_demo`.`payments` AS payments;'}
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 40.3s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 40.8s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 41.6s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 41.6s: 'From Static Dashboards to Strategic Dialogue: Unlock Your Data's True Value'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:root:Received request: Show me top 10 customers
INFO:root:Using agent: nike_demo_20251005, dataset: nike_capi_demo_20251005
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/f2b46bb8-94db-42e2-9f99-e4b05ffab5f3'.
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 42.0s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 42.3s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 46.5s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 46.5s: 'SolarWinds: From Reactive Reports to Proactive Revenue with Conversational AI'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:root:Received request: Show me top 10 customers
INFO:root:Using agent: nike_demo_agent_20251005, dataset: nike_capi_demo_20251005
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/1912c4d3-dfd5-461f-80c9-ece6b39c732a'.
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 9 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 8 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 1 tables (agent_teams)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 8 tables (sales, products, customers, conversations, conversation_turns, agents, cases, orders)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 1 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ agent_teams: 50 rows → /tmp/synthetic_data/agent_teams.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 8 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ sales: 3,000 rows → /tmp/synthetic_data/sales.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 800 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversations: 3,000 rows → /tmp/synthetic_data/conversations.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ conversation_turns: 3,500 rows → /tmp/synthetic_data/conversation_turns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ agents: 50 rows → /tmp/synthetic_data/agents.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ cases: 3,000 rows → /tmp/synthetic_data/cases.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,000 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 1.74s. 9 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: information_not_found_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 9 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: sales
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversation_turns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: agents
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: agent_teams
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into sales
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: cases
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into conversation_turns
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into conversations
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into agents
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into agent_teams
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into cases
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_information_not_found_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: information_not_found_demo_20251006_0308
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: Information Not Found CAPI Demo Agent 20251006_0308
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.information_not_found_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: information_not_found_demo_20251006_0308
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 6.93s: information_not_found_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.information_not_found_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 9
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 19,400
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: information_not_found_demo_20251006_0308
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 10 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 9 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 2 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 1 tables (marketing_campaigns)
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 1: 9 tables (customers, products, subscriptions, monthly_subscription_snapshots, opportunities, support_tickets, user_activity, product_feature_usage, community_engagement)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/2: 1 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_campaigns: 800 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 2/2: 9 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 50 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 3,000 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ monthly_subscription_snapshots: 3,000 rows → /tmp/synthetic_data/monthly_subscription_snapshots.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ opportunities: 3,000 rows → /tmp/synthetic_data/opportunities.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,500 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ user_activity: 3,500 rows → /tmp/synthetic_data/user_activity.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_feature_usage: 3,500 rows → /tmp/synthetic_data/product_feature_usage.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ community_engagement: 3,500 rows → /tmp/synthetic_data/community_engagement.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 1.64s. 10 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: solarwinds_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 10 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: opportunities
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: monthly_subscription_snapshots
INFO:root:🔧 Creating CAPI Data Agent...
INFO:routes.provisioning:Getting demo assets for job test-12345
ERROR:routes.provisioning:Job test-12345 not found
INFO:root:Received request: Show me top 10 customers
INFO:root:Using agent: nike_demo_agent, dataset: nike_capi_demo_20251005
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/18002f39-884d-46d6-b476-fe16abe3b194'.
INFO:routes.provisioning:Created provisioning job 817608ac-0862-4cdb-a242-0a1d7dcf34bc for https://www.stripe.com/
INFO:routes.provisioning:Starting provisioning workflow for job 817608ac-0862-4cdb-a242-0a1d7dcf34bc
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 817608ac-0862-4cdb-a242-0a1d7dcf34bc
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.stripe.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.stripe.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.stripe.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Stripe
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.stripe.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.web_research:Scraped 11076 characters from https://www.stripe.com/
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 65 header/footer navigation links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.stripe.com/use-cases/saas
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.stripe.com/newsroom
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.stripe.com/payments/payment-links
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.stripe.com/use-cases/platforms
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.stripe.com/us/newsroom/news/bmw-and-stripe
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.stripe.com/apps
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.stripe.com/support-plans
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.stripe.com/use-cases/ai
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.stripe.com/billing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.stripe.com/enterprise
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.stripe.com/atlas
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.stripe.com/industries/retail
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.stripe.com/billing/usage-based-billing
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.stripe.com/payouts
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.stripe.com/sitemap
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 2/3 key categories, 15 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 15 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 10.90s. Visited 15 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 10.91s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 10.91s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 36.46s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 86.03s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 133.40s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 10.91s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 36.46s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 86.03s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 43.2s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 43.7s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 50.6s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 50.6s: 'Stripe: From Data Dashboards to Business Conversations at the Speed of Thought'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:routes.provisioning:Created provisioning job 73295ee6-56ae-4973-9fed-87dd3b133801 for https://www.solarwinds.com/
INFO:routes.provisioning:Starting provisioning workflow for job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.solarwinds.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.solarwinds.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.solarwinds.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Solarwinds
INFO:agentic_service.tools.web_research:Scraped 6080 characters from https://www.solarwinds.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 50 URLs in sitemap
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 85 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.solarwinds.com/careers
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.solarwinds.com/database/monitoring
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.solarwinds.com/solutions/azure-monitoring
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.solarwinds.com/partners
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.solarwinds.com/company/contact-us
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.solarwinds.com/solutions/it-automation-software-solutions
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.solarwinds.com/knowledge-hub
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.solarwinds.com/access-rights-manager
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.solarwinds.com/it-incident-response-software
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.solarwinds.com/general-data-protection-regulation-core-it
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.solarwinds.com/solutions/enterprise-solutions
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.solarwinds.com/observability/digital-experience-monitoring
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.solarwinds.com/solutions/aws-monitoring
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.solarwinds.com/partners/global-system-integrators
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.solarwinds.com/solutions/itsm-solutions
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.solarwinds.com/hybrid-cloud-observability
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.solarwinds.com/onlinequotes
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.solarwinds.com/observability/logs
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.solarwinds.com/information-security
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.solarwinds.com/engineers-toolset
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.solarwinds.com/public-sector/it-management-solutions-for-government
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.solarwinds.com/campaign/gartner-magic-quadrant-observability
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.solarwinds.com/solutions/mysql-solutions
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.solarwinds.com/solutions/it-asset-management
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.solarwinds.com/company/newsroom
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.solarwinds.com/network-topology-mapper
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.solarwinds.com/database/diagnose
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 2/3 key categories, 26 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 26 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 4.94s. Visited 26 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 4.94s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 4.94s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 24.86s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 12 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 12 tables (dim_merchants, dim_merchant_segments, dim_products, fct_transactions, fct_subscriptions, fct_disputes, fct_payouts, fct_connect_transactions, log_api_calls, fct_product_adoptions, fct_radar_events, fct_terminal_transactions)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 12 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ dim_merchants: 3,000 rows → /tmp/synthetic_data/dim_merchants.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ dim_merchant_segments: 50 rows → /tmp/synthetic_data/dim_merchant_segments.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ dim_products: 50 rows → /tmp/synthetic_data/dim_products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fct_transactions: 3,500 rows → /tmp/synthetic_data/fct_transactions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fct_subscriptions: 3,000 rows → /tmp/synthetic_data/fct_subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fct_disputes: 3,000 rows → /tmp/synthetic_data/fct_disputes.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fct_payouts: 3,000 rows → /tmp/synthetic_data/fct_payouts.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fct_connect_transactions: 3,000 rows → /tmp/synthetic_data/fct_connect_transactions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ log_api_calls: 3,500 rows → /tmp/synthetic_data/log_api_calls.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fct_product_adoptions: 3,000 rows → /tmp/synthetic_data/fct_product_adoptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fct_radar_events: 3,000 rows → /tmp/synthetic_data/fct_radar_events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ fct_terminal_transactions: 3,000 rows → /tmp/synthetic_data/fct_terminal_transactions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 2.26s. 12 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
WARNING:agentic_service.agents.infrastructure_agent_optimized:Dataset stripe_capi_demo_20251006 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 12 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: dim_products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: dim_merchant_segments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fct_subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fct_payouts
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fct_transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: dim_merchants
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fct_disputes
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into fct_payouts
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into fct_disputes
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into dim_merchant_segments
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fct_connect_transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: log_api_calls
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fct_product_adoptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into dim_merchants
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into fct_transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fct_radar_events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: fct_terminal_transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into fct_subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into log_api_calls
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into fct_radar_events
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into fct_product_adoptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into dim_products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into fct_connect_transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into fct_terminal_transactions
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_stripe_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: stripe_demo_20251006_0314
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: Stripe CAPI Demo Agent 20251006_0314
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: stripe_demo_20251006_0314
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 7.68s: stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.stripe_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 12
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 31,100
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: stripe_demo_20251006_0314
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
WARNING:agentic_service.utils.vertex_llm_client:Initial JSON parse failed: Expecting value: line 117 column 17 (char 6617)
WARNING:agentic_service.utils.vertex_llm_client:Attempting JSON repair for unterminated strings/objects...
ERROR:agentic_service.utils.vertex_llm_client:JSON repair failed: Cannot repair JSON: Expecting value: line 117 column 17 (char 6617)
ERROR:agentic_service.utils.vertex_llm_client:Response text (first 500 chars): {
  "company_profile": {
    "name": "SolarWinds",
    "industry": "IT Management Software",
    "data_maturity_level": "advanced"
  },
  "core_entities": [
    {
      "table_name": "customers",
      "entity_type": "dimension",
      "description": "Represents a business entity that purchases SolarWinds products. Master record for a customer account.",
      "estimated_rows": "500K - 1M",
      "update_frequency": "daily",
      "key_fields": [
        {"name": "customer_id", "type": "UUID", "...
ERROR:agentic_service.utils.vertex_llm_client:Extracted JSON text (first 500 chars): {
  "company_profile": {
    "name": "SolarWinds",
    "industry": "IT Management Software",
    "data_maturity_level": "advanced"
  },
  "core_entities": [
    {
      "table_name": "customers",
      "entity_type": "dimension",
      "description": "Represents a business entity that purchases SolarWinds products. Master record for a customer account.",
      "estimated_rows": "500K - 1M",
      "update_frequency": "daily",
      "key_fields": [
        {"name": "customer_id", "type": "UUID", "...
ERROR:agentic_service.utils.vertex_llm_client:Extracted JSON text length: 23781
ERROR:agentic_service.utils.vertex_llm_client:Last 200 chars: ... quality and schema stability from the source.",
    "Establish a data governance council with members from Product, Engineering, Sales, and Legal to oversee compliance and quality initiatives."
  ]
}
ERROR:agentic_service.tools.v2_data_architect:Architecture inference failed: Invalid JSON response: Expecting value: line 117 column 17 (char 6617)
Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 230, in parse_json_response
    return json.loads(json_text)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 117 column 17 (char 6617)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 237, in parse_json_response
    repaired = self._repair_json(json_text, e)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 290, in _repair_json
    raise ValueError(f"Cannot repair JSON: {error}")
ValueError: Cannot repair JSON: Expecting value: line 117 column 17 (char 6617)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/tools/v2_data_architect.py", line 58, in infer_architecture
    architecture = self.llm_client.parse_json_response(response)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/final_demo/capi/demo-gen-capi/backend/agentic_service/utils/vertex_llm_client.py", line 246, in parse_json_response
    raise ValueError(f"Invalid JSON response: {str(e)}")
ValueError: Invalid JSON response: Expecting value: line 117 column 17 (char 6617)
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 76.81s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 106.61s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 4.94s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 24.86s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 76.81s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 39.5s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 43.8s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 48.4s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 48.4s: 'SolarWinds: From Reactive Dashboards to Proactive Revenue with Conversational Analytics'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 9 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 9 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 9 tables (customers, products, subscriptions, product_usage, features, support_tickets, sales_opportunities, customer_assets, marketing_leads)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 9 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 50 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 3,000 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ product_usage: 3,500 rows → /tmp/synthetic_data/product_usage.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ features: 50 rows → /tmp/synthetic_data/features.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,000 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ sales_opportunities: 3,000 rows → /tmp/synthetic_data/sales_opportunities.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customer_assets: 3,500 rows → /tmp/synthetic_data/customer_assets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_leads: 3,000 rows → /tmp/synthetic_data/marketing_leads.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 2.09s. 9 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
INFO:agentic_service.agents.infrastructure_agent_optimized:Created dataset: solarwinds_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 9 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: product_usage
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: features
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: sales_opportunities
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 50 rows into features
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customer_assets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_leads
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into product_usage
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into customer_assets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into sales_opportunities
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into marketing_leads
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_solarwinds_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: solarwinds_demo_20251006_0317
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: SolarWinds CAPI Demo Agent 20251006_0317
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.solarwinds_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: solarwinds_demo_20251006_0317
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 10.49s: solarwinds_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.solarwinds_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 9
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 22,100
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: solarwinds_demo_20251006_0317
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_stripe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 251.70s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_stripe.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 68,317 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,647
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: 619c1c64-b376-4b01-a7b9-164a08a522c1

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: 4090c490-f5da-4d04-9cc7-2395af178985

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: b0dd0e11-7abc-4fbf-8507-73e26547a1f7

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: bde605e4-d284-4a7b-a5fa-68050f5eb252

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:stripe_data was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:stripe_data was not found in location US

Location: US
Job ID: 76499d02-b98b-4c3e-8c82-31d6747f8bcd

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.44s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 817608ac-0862-4cdb-a242-0a1d7dcf34bc
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 817608ac-0862-4cdb-a242-0a1d7dcf34bc with demo_title=Stripe: From Data Dashboards to Business Conversations at the Speed of Thought
INFO:routes.provisioning:✅ set_results completed for job 817608ac-0862-4cdb-a242-0a1d7dcf34bc
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.capi_instruction_generator_optimized:Saved YAML to /tmp/capi_instructions_solarwinds.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:✅ CAPI system instructions generated in 172.48s
INFO:agentic_service.agents.capi_instruction_generator_optimized:   YAML file: /tmp/capi_instructions_solarwinds.yaml
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Size: 48,714 characters
INFO:agentic_service.agents.capi_instruction_generator_optimized:   Lines: 1,257
INFO:agentic_service.demo_orchestrator:✅ CAPI Instruction Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 7/7: Demo Validator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_validator_optimized:🚀 Validating demo queries (OPTIMIZED - PARALLEL)
INFO:agentic_service.agents.demo_validator_optimized:⚡ Validating 5 queries IN PARALLEL...
ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 3: SQL failed - 404 Not found: Dataset bq-demos-469816:solarwinds was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:solarwinds was not found in location US

Location: US
Job ID: 8bcc3736-dbc9-4009-a52f-3e26dd4d5ad6

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 2: SQL failed - 404 Not found: Dataset bq-demos-469816:solarwinds was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:solarwinds was not found in location US

Location: US
Job ID: a7242dac-1fd6-4997-baee-0abbc2fb21bd

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 5: SQL failed - 404 Not found: Dataset bq-demos-469816:solarwinds was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:solarwinds was not found in location US

Location: US
Job ID: 539d11b1-f6ab-4f9f-99ea-cfc5bf5bb85c

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 4: SQL failed - 404 Not found: Dataset bq-demos-469816:solarwinds was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:solarwinds was not found in location US

Location: US
Job ID: 23ad7134-e69f-4cb0-82a0-ddeb2d452dd6

ERROR:agentic_service.agents.demo_validator_optimized:  ❌ Query 1: SQL failed - 404 Not found: Dataset bq-demos-469816:solarwinds was not found in location US; reason: notFound, message: Not found: Dataset bq-demos-469816:solarwinds was not found in location US

Location: US
Job ID: 48c2eca7-cb85-4509-9b32-daa734bc3074

INFO:agentic_service.agents.demo_validator_optimized:📄 Validation report saved: /tmp/demo_validation_report.md
INFO:agentic_service.agents.demo_validator_optimized:✅ Validation complete in 0.41s
INFO:agentic_service.agents.demo_validator_optimized:   Queries tested: 6
INFO:agentic_service.agents.demo_validator_optimized:   SQL validated: 0
INFO:agentic_service.agents.demo_validator_optimized:   SQL failed: 5
INFO:agentic_service.demo_orchestrator:✅ Demo Validator complete
INFO:agentic_service.demo_orchestrator:Demo orchestrator completed successfully for job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:routes.provisioning:Orchestrator result status: completed
INFO:routes.provisioning:Orchestrator result keys: ['status', 'dataset_id', 'demo_title', 'golden_queries', 'schema', 'metadata']
INFO:routes.provisioning:Has demo_title: True
INFO:routes.provisioning:Has golden_queries: True
INFO:routes.provisioning:Has schema: True
INFO:routes.provisioning:Calling set_results for job 73295ee6-56ae-4973-9fed-87dd3b133801 with demo_title=SolarWinds: From Reactive Dashboards to Proactive Revenue with Conversational Analytics
INFO:routes.provisioning:✅ set_results completed for job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 finished with status completed
INFO:routes.provisioning:Client unsubscribed from job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:routes.provisioning:SSE stream cancelled for job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:routes.provisioning:Client unsubscribed from job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
INFO:root:Received request: Show me MRR by product line
INFO:root:Using agent: default, dataset: solarwinds_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/0d8b4ccf-54e6-42f9-af4a-c29a332dc6cb'.
INFO:root:Received request: hi
INFO:root:Using agent: default, dataset: solarwinds_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/7cad13e7-6166-40d6-b3ce-5b049e4b3c4e'.
INFO:root:Received request: What is our total Monthly Recurring Revenue (MRR) for each product line?
INFO:root:Using agent: default, dataset: solarwinds_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/fb3238ca-d221-4538-a8ce-cb1678a98752'.
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
INFO:root:Received request: What is our total Monthly Recurring Revenue (MRR) for each product line?
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/7a6b1c90-061d-4ee9-8369-5a1ce3857a49'.
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
INFO:routes.provisioning:Job found: status=completed, has demo_title=True, has golden_queries=True
INFO:routes.provisioning:Returning demo assets response
INFO:root:Received request: What is our total Monthly Recurring Revenue (MRR) for each product line?
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/6fa23f46-304d-46d9-9036-0fb1782d5dfa'.
INFO:root:Received request: What is our total Monthly Recurring Revenue (MRR) for each product line?
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/c0c40058-0f5e-4e9c-b2ee-4eca0bbc74e9'.
INFO:root:Received request: What is our total Monthly Recurring Revenue (MRR) for each product line?
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
ERROR:root:Error processing chat request: 400 The agent 'projects/bq-demos-469816/locations/global/dataAgents/default_agent' in the request does not match the agent associated with the conversation 'projects/bq-demos-469816/locations/global/conversations/37fa8ce9-eed9-4708-82ee-1616f0154e3e'.
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:Received request: What is our total MRR by product?
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
INFO:root:Received request: What is our total Monthly Recurring Revenue (MRR) for each product line?
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
INFO:root:Type of m.chart.result: <class 'google.cloud.geminidataanalytics_v1alpha.types.data_chat_service.ChartResult'>
INFO:root:Value of m.chart.result: vega_config {
  fields {
    key: "title"
    value {
      string_value: "Total MRR for Each Product"
    }
  }
  fields {
    key: "mark"
    value {
      struct_value {
        fields {
          key: "type"
          value {
            string_value: "bar"
          }
        }
        fields {
          key: "tooltip"
          value {
            bool_value: true
          }
        }
      }
    }
  }
  fields {
    key: "encoding"
    value {
      struct_value {
        fields {
          key: "y"
          value {
            struct_value {
              fields {
                key: "type"
                value {
                  string_value: "quantitative"
                }
              }
              fields {
                key: "title"
                value {
                  string_value: "Total MRR"
                }
              }
              fields {
                key: "sort"
                value {
                  struct_value {
                  }
                }
              }
              fields {
                key: "field"
                value {
                  string_value: "total_mrr"
                }
              }
              fields {
                key: "axis"
                value {
                  struct_value {
                    fields {
                      key: "labelOverlap"
                      value {
                        bool_value: true
                      }
                    }
                  }
                }
              }
            }
          }
        }
        fields {
          key: "x"
          value {
            struct_value {
              fields {
                key: "type"
                value {
                  string_value: "nominal"
                }
              }
              fields {
                key: "title"
                value {
                  string_value: "Product Name"
                }
              }
              fields {
                key: "sort"
                value {
                  struct_value {
                    fields {
                      key: "order"
                      value {
                        string_value: "descending"
                      }
                    }
                    fields {
                      key: "op"
                      value {
                        string_value: "sum"
                      }
                    }
                    fields {
                      key: "field"
                      value {
                        string_value: "total_mrr"
                      }
                    }
                  }
                }
              }
              fields {
                key: "field"
                value {
                  string_value: "product_name"
                }
              }
              fields {
                key: "axis"
                value {
                  struct_value {
                    fields {
                      key: "labelOverlap"
                      value {
                        bool_value: true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  fields {
    key: "data"
    value {
      struct_value {
        fields {
          key: "values"
          value {
            list_value {
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 4659.9
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Classic Hoodie"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3916.2999999999997
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Casual Hoodie"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3680.7499999999995
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Vintage Jacket"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3500.55
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Formal Jacket"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3472.27
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Classic T-Shirt"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3224.81
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Formal Hoodie"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3041.86
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Modern Dress"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3039.18
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Formal Skirt"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3024.29
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Classic Shorts"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2990.36
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Modern Scarf"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2892.8700000000003
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Classic Sandals"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2672.77
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Vintage Boots"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2667.03
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Premium Sneakers"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2464.03
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Vintage Sneakers"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2419.0899999999997
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Classic Boots"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2366.3500000000004
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Formal Sandals"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2353.45
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Vintage Jeans"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2230.21
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Vintage Shorts"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2098.11
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Formal Hat"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2006.25
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Casual Skirt"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1981.58
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Premium Hat"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1784.62
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Casual Sneakers"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1776.8400000000001
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Formal Dress"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1704
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Modern Skirt"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1457.99
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Modern Sandals"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1424.75
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Casual Shorts"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1167.45
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Casual Scarf"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1131.11
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Modern Jeans"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1125.21
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Premium T-Shirt"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1113.85
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Premium Shorts"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 780.32999999999993
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Vintage Scarf"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 768.20999999999992
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Vintage Dress"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 422.39
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Formal Sneakers"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 259.87
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Premium Hoodie"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 172.95
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Casual Jacket"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 150.57
                    }
                  }
                  fields {
                    key: "product_name"
                    value {
                      string_value: "Classic Scarf"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
image {
}

INFO:root:Type of m.chart.result.vega_config: <class 'proto.marshal.collections.maps.MapComposite'>
INFO:root:Value of m.chart.result.vega_config: <proto.marshal.collections.maps.MapComposite object at 0x7ffbc9d4c2f0>
INFO:root:Sending response: {'response': 'The chart above displays the total Monthly Recurring Revenue (MRR) for each product. The products are sorted in descending order of their total MRR. You can see the exact MRR for each product by hovering over the bars in the chart.', 'chartData': {'type': 'bar', 'title': 'Total MRR for Each Product', 'data': [{'total_mrr': 4659.9, 'product_name': 'Classic Hoodie'}, {'total_mrr': 3916.2999999999997, 'product_name': 'Casual Hoodie'}, {'total_mrr': 3680.7499999999995, 'product_name': 'Vintage Jacket'}, {'total_mrr': 3500.55, 'product_name': 'Formal Jacket'}, {'total_mrr': 3472.27, 'product_name': 'Classic T-Shirt'}, {'total_mrr': 3224.81, 'product_name': 'Formal Hoodie'}, {'total_mrr': 3041.86, 'product_name': 'Modern Dress'}, {'total_mrr': 3039.18, 'product_name': 'Formal Skirt'}, {'total_mrr': 3024.29, 'product_name': 'Classic Shorts'}, {'total_mrr': 2990.36, 'product_name': 'Modern Scarf'}, {'total_mrr': 2892.8700000000003, 'product_name': 'Classic Sandals'}, {'total_mrr': 2672.77, 'product_name': 'Vintage Boots'}, {'total_mrr': 2667.03, 'product_name': 'Premium Sneakers'}, {'total_mrr': 2464.03, 'product_name': 'Vintage Sneakers'}, {'total_mrr': 2419.0899999999997, 'product_name': 'Classic Boots'}, {'total_mrr': 2366.3500000000004, 'product_name': 'Formal Sandals'}, {'total_mrr': 2353.45, 'product_name': 'Vintage Jeans'}, {'total_mrr': 2230.21, 'product_name': 'Vintage Shorts'}, {'total_mrr': 2098.11, 'product_name': 'Formal Hat'}, {'total_mrr': 2006.25, 'product_name': 'Casual Skirt'}, {'total_mrr': 1981.58, 'product_name': 'Premium Hat'}, {'total_mrr': 1784.62, 'product_name': 'Casual Sneakers'}, {'total_mrr': 1776.8400000000001, 'product_name': 'Formal Dress'}, {'total_mrr': 1704.0, 'product_name': 'Modern Skirt'}, {'total_mrr': 1457.99, 'product_name': 'Modern Sandals'}, {'total_mrr': 1424.75, 'product_name': 'Casual Shorts'}, {'total_mrr': 1167.45, 'product_name': 'Casual Scarf'}, {'total_mrr': 1131.11, 'product_name': 'Modern Jeans'}, {'total_mrr': 1125.21, 'product_name': 'Premium T-Shirt'}, {'total_mrr': 1113.85, 'product_name': 'Premium Shorts'}, {'total_mrr': 780.3299999999999, 'product_name': 'Vintage Scarf'}, {'total_mrr': 768.2099999999999, 'product_name': 'Vintage Dress'}, {'total_mrr': 422.39, 'product_name': 'Formal Sneakers'}, {'total_mrr': 259.87, 'product_name': 'Premium Hoodie'}, {'total_mrr': 172.95, 'product_name': 'Casual Jacket'}, {'total_mrr': 150.57, 'product_name': 'Classic Scarf'}], 'xKey': 'product_name', 'yKey': 'total_mrr', 'nameKey': None}, 'sqlQuery': 'SELECT t2.product_name, SUM(t1.mrr) AS total_mrr\nFROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t1\nINNER JOIN `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t2\n  ON t1.product_id = t2.product_id\nGROUP BY t2.product_name\nORDER BY total_mrr DESC;'}
INFO:root:Type of m.chart.result: <class 'google.cloud.geminidataanalytics_v1alpha.types.data_chat_service.ChartResult'>
INFO:root:Value of m.chart.result: vega_config {
  fields {
    key: "title"
    value {
      string_value: "Total MRR by Product Line"
    }
  }
  fields {
    key: "mark"
    value {
      struct_value {
        fields {
          key: "type"
          value {
            string_value: "bar"
          }
        }
        fields {
          key: "tooltip"
          value {
            bool_value: true
          }
        }
      }
    }
  }
  fields {
    key: "encoding"
    value {
      struct_value {
        fields {
          key: "y"
          value {
            struct_value {
              fields {
                key: "type"
                value {
                  string_value: "quantitative"
                }
              }
              fields {
                key: "title"
                value {
                  string_value: "Total MRR"
                }
              }
              fields {
                key: "sort"
                value {
                  struct_value {
                  }
                }
              }
              fields {
                key: "field"
                value {
                  string_value: "total_mrr"
                }
              }
              fields {
                key: "axis"
                value {
                  struct_value {
                    fields {
                      key: "labelOverlap"
                      value {
                        bool_value: true
                      }
                    }
                  }
                }
              }
            }
          }
        }
        fields {
          key: "x"
          value {
            struct_value {
              fields {
                key: "type"
                value {
                  string_value: "nominal"
                }
              }
              fields {
                key: "title"
                value {
                  string_value: "Product Line"
                }
              }
              fields {
                key: "sort"
                value {
                  struct_value {
                    fields {
                      key: "order"
                      value {
                        string_value: "descending"
                      }
                    }
                    fields {
                      key: "op"
                      value {
                        string_value: "sum"
                      }
                    }
                    fields {
                      key: "field"
                      value {
                        string_value: "total_mrr"
                      }
                    }
                  }
                }
              }
              fields {
                key: "field"
                value {
                  string_value: "product_line"
                }
              }
              fields {
                key: "axis"
                value {
                  struct_value {
                    fields {
                      key: "labelOverlap"
                      value {
                        bool_value: true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  fields {
    key: "data"
    value {
      struct_value {
        fields {
          key: "values"
          value {
            list_value {
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1113.85
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "born"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2366.3500000000004
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "safe"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2456.9700000000003
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "skill"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 736.5100000000001
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "risk"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 172.95
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "news"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3923.3900000000003
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "how"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1359.26
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "family"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 786.3900000000001
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "exactly"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1370.04
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "beautiful"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3500.55
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "however"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2035.48
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "economic"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3024.29
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "party"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1131.11
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "president"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 422.39
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "policy"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 383.61
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "a"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 259.87
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "allow"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1495.18
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "car"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1495.18
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "institution"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1443.57
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "draw"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2006.25
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "manage"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3472.27
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "suggest"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1519.66
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "power"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2106.48
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "site"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 150.57
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "available"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 606.88
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "from"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 768.20999999999992
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "blue"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1704
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "appear"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 4995.7
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "table"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1491.23
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "surface"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3916.2999999999997
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "already"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2512.5099999999998
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "society"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1981.58
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "expect"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2464.03
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "coach"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 904.59999999999991
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "address"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1125.21
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "water"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 526.67
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "break"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1307.77
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "guy"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1167.45
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "of"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1424.75
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "benefit"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1448.85
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "entire"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1181.54
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "leave"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 335.11
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "must"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 584.89
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "have"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 780.32999999999993
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "lead"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3680.7499999999995
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "ever"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1457.99
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "make"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 502.58
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "beyond"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 341.05
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "Mr"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
image {
}

INFO:root:Type of m.chart.result.vega_config: <class 'proto.marshal.collections.maps.MapComposite'>
INFO:root:Value of m.chart.result.vega_config: <proto.marshal.collections.maps.MapComposite object at 0x7ffbc9d2a8a0>
INFO:root:Sending response: {'response': "The total Monthly Recurring Revenue (MRR) for each product line is displayed in the bar chart. The chart is sorted by total MRR in descending order, allowing for easy comparison of MRR across different product lines. \n\nHere are the top 5 product lines by MRR:\n\n1. table: 4995.7\n2. how: 3923.39\n3. already: 3916.3\n4. ever: 3680.75\n5. however: 3500.55\n\nI can also provide a more detailed breakdown or focus on specific product lines if you'd like.", 'chartData': {'type': 'bar', 'title': 'Total MRR by Product Line', 'data': [{'total_mrr': 1113.85, 'product_line': 'born'}, {'total_mrr': 2366.3500000000004, 'product_line': 'safe'}, {'total_mrr': 2456.9700000000003, 'product_line': 'skill'}, {'total_mrr': 736.5100000000001, 'product_line': 'risk'}, {'total_mrr': 172.95, 'product_line': 'news'}, {'total_mrr': 3923.3900000000003, 'product_line': 'how'}, {'total_mrr': 1359.26, 'product_line': 'family'}, {'total_mrr': 786.3900000000001, 'product_line': 'exactly'}, {'total_mrr': 1370.04, 'product_line': 'beautiful'}, {'total_mrr': 3500.55, 'product_line': 'however'}, {'total_mrr': 2035.48, 'product_line': 'economic'}, {'total_mrr': 3024.29, 'product_line': 'party'}, {'total_mrr': 1131.11, 'product_line': 'president'}, {'total_mrr': 422.39, 'product_line': 'policy'}, {'total_mrr': 383.61, 'product_line': 'a'}, {'total_mrr': 259.87, 'product_line': 'allow'}, {'total_mrr': 1495.18, 'product_line': 'car'}, {'total_mrr': 1495.18, 'product_line': 'institution'}, {'total_mrr': 1443.57, 'product_line': 'draw'}, {'total_mrr': 2006.25, 'product_line': 'manage'}, {'total_mrr': 3472.27, 'product_line': 'suggest'}, {'total_mrr': 1519.66, 'product_line': 'power'}, {'total_mrr': 2106.48, 'product_line': 'site'}, {'total_mrr': 150.57, 'product_line': 'available'}, {'total_mrr': 606.88, 'product_line': 'from'}, {'total_mrr': 768.2099999999999, 'product_line': 'blue'}, {'total_mrr': 1704.0, 'product_line': 'appear'}, {'total_mrr': 4995.7, 'product_line': 'table'}, {'total_mrr': 1491.23, 'product_line': 'surface'}, {'total_mrr': 3916.2999999999997, 'product_line': 'already'}, {'total_mrr': 2512.5099999999998, 'product_line': 'society'}, {'total_mrr': 1981.58, 'product_line': 'expect'}, {'total_mrr': 2464.03, 'product_line': 'coach'}, {'total_mrr': 904.5999999999999, 'product_line': 'address'}, {'total_mrr': 1125.21, 'product_line': 'water'}, {'total_mrr': 526.67, 'product_line': 'break'}, {'total_mrr': 1307.77, 'product_line': 'guy'}, {'total_mrr': 1167.45, 'product_line': 'of'}, {'total_mrr': 1424.75, 'product_line': 'benefit'}, {'total_mrr': 1448.85, 'product_line': 'entire'}, {'total_mrr': 1181.54, 'product_line': 'leave'}, {'total_mrr': 335.11, 'product_line': 'must'}, {'total_mrr': 584.89, 'product_line': 'have'}, {'total_mrr': 780.3299999999999, 'product_line': 'lead'}, {'total_mrr': 3680.7499999999995, 'product_line': 'ever'}, {'total_mrr': 1457.99, 'product_line': 'make'}, {'total_mrr': 502.58, 'product_line': 'beyond'}, {'total_mrr': 341.05, 'product_line': 'Mr'}], 'xKey': 'product_line', 'yKey': 'total_mrr', 'nameKey': None}, 'sqlQuery': 'SELECT t2.product_line, SUM(t1.mrr) AS total_mrr\nFROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t1\nINNER JOIN `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t2\n  ON t1.product_id = t2.product_id\nGROUP BY t2.product_line;'}
INFO:root:Received request: Show me our top 10 customers by revenue who own an Observability product but have not purchased an IT Service Management (ITSM) solution
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
ERROR:grpc._plugin_wrapping:AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x7ffbc8449fd0>" raised exception!
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 95, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 81, in _get_authorization_headers
    self._credentials.before_request(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 228, in before_request
    self._blocking_refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 365, in refresh
    self._refresh_token(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 140, in _refresh_token
    self._retrieve_info(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 112, in _retrieve_info
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:root:Error processing chat request: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
INFO:root:Received request: Show me our top 10 customers by revenue who own an Observability product but have not purchased an IT Service Management (ITSM) solution
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
ERROR:grpc._plugin_wrapping:AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x7ffbc84643e0>" raised exception!
Traceback (most recent call last):
  File "/home/admin_/.local/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 95, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 81, in _get_authorization_headers
    self._credentials.before_request(
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 228, in before_request
    self._blocking_refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/credentials.py", line 365, in refresh
    self._refresh_token(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 140, in _refresh_token
    self._retrieve_info(request)
  File "/home/admin_/.local/lib/python3.12/site-packages/google/auth/compute_engine/credentials.py", line 112, in _retrieve_info
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: Unexpected response from metadata server: service account info is missing 'email' field.
ERROR:root:Error processing chat request: 503 Getting metadata from plugin failed with error: Unexpected response from metadata server: service account info is missing 'email' field.
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:root:Received request: Show me our top 10 customers by revenue who own an Observability product but have not purchased an IT Service Management (ITSM) solution.
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
INFO:root:Sending response: {'response': 'There is no data for customers who own an Observability product but have not purchased an IT Service Management (ITSM) solution.', 'chartData': None, 'sqlQuery': "SELECT t1.customer_name, t1.customer_id, SUM(t2.mrr) AS total_revenue\nFROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`customers` AS t1\nINNER JOIN\n  `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t2\n  ON t1.customer_id = t2.customer_id\nINNER JOIN `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t3\n  ON t2.product_id = t3.product_id\nWHERE\n  t1.customer_id IN (\n    SELECT DISTINCT t2.customer_id\n    FROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t2\n    INNER JOIN\n      `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t3\n      ON t2.product_id = t3.product_id\n    WHERE t3.product_line = 'Observability'\n  )\n  AND t1.customer_id NOT IN (\n    SELECT DISTINCT t2.customer_id\n    FROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t2\n    INNER JOIN\n      `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t3\n      ON t2.product_id = t3.product_id\n    WHERE t3.product_line = 'IT Service Management'\n  )\nGROUP BY t1.customer_name, t1.customer_id\nORDER BY total_revenue DESC\nLIMIT 10;"}
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:root:Received request: What is our total Monthly Recurring Revenue (MRR) for each product line?
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
INFO:root:Type of m.chart.result: <class 'google.cloud.geminidataanalytics_v1alpha.types.data_chat_service.ChartResult'>
INFO:root:Value of m.chart.result: vega_config {
  fields {
    key: "title"
    value {
      string_value: "Total MRR for Each Product Line"
    }
  }
  fields {
    key: "mark"
    value {
      struct_value {
        fields {
          key: "type"
          value {
            string_value: "bar"
          }
        }
        fields {
          key: "tooltip"
          value {
            bool_value: true
          }
        }
      }
    }
  }
  fields {
    key: "encoding"
    value {
      struct_value {
        fields {
          key: "y"
          value {
            struct_value {
              fields {
                key: "type"
                value {
                  string_value: "quantitative"
                }
              }
              fields {
                key: "title"
                value {
                  string_value: "Total MRR"
                }
              }
              fields {
                key: "sort"
                value {
                  struct_value {
                  }
                }
              }
              fields {
                key: "field"
                value {
                  string_value: "total_mrr"
                }
              }
              fields {
                key: "axis"
                value {
                  struct_value {
                    fields {
                      key: "labelOverlap"
                      value {
                        bool_value: true
                      }
                    }
                  }
                }
              }
            }
          }
        }
        fields {
          key: "x"
          value {
            struct_value {
              fields {
                key: "type"
                value {
                  string_value: "nominal"
                }
              }
              fields {
                key: "title"
                value {
                  string_value: "Product Line"
                }
              }
              fields {
                key: "sort"
                value {
                  struct_value {
                    fields {
                      key: "order"
                      value {
                        string_value: "descending"
                      }
                    }
                    fields {
                      key: "op"
                      value {
                        string_value: "sum"
                      }
                    }
                    fields {
                      key: "field"
                      value {
                        string_value: "total_mrr"
                      }
                    }
                  }
                }
              }
              fields {
                key: "field"
                value {
                  string_value: "product_line"
                }
              }
              fields {
                key: "axis"
                value {
                  struct_value {
                    fields {
                      key: "labelOverlap"
                      value {
                        bool_value: true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  fields {
    key: "data"
    value {
      struct_value {
        fields {
          key: "values"
          value {
            list_value {
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1113.85
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "born"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2366.3500000000004
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "safe"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2456.9700000000003
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "skill"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 736.5100000000001
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "risk"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 172.95
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "news"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3923.3900000000003
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "how"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1359.26
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "family"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 786.3900000000001
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "exactly"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1370.04
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "beautiful"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3500.55
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "however"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2035.48
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "economic"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3024.29
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "party"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1131.11
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "president"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 422.39
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "policy"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 383.61
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "a"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 259.87
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "allow"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1495.18
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "car"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1495.18
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "institution"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1443.57
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "draw"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2006.25
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "manage"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3472.27
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "suggest"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1519.66
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "power"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2106.48
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "site"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 150.57
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "available"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 606.88
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "from"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 768.20999999999992
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "blue"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1704
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "appear"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 4995.7
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "table"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1491.23
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "surface"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3916.2999999999997
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "already"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2512.5099999999998
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "society"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1981.58
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "expect"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 2464.03
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "coach"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 904.59999999999991
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "address"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1125.21
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "water"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 526.67
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "break"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1307.77
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "guy"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1167.45
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "of"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1424.75
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "benefit"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1448.85
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "entire"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1181.54
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "leave"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 335.11
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "must"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 584.89
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "have"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 780.32999999999993
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "lead"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 3680.7499999999995
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "ever"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 1457.99
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "make"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 502.58
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "beyond"
                    }
                  }
                }
              }
              values {
                struct_value {
                  fields {
                    key: "total_mrr"
                    value {
                      number_value: 341.05
                    }
                  }
                  fields {
                    key: "product_line"
                    value {
                      string_value: "Mr"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
image {
}

INFO:root:Type of m.chart.result.vega_config: <class 'proto.marshal.collections.maps.MapComposite'>
INFO:root:Value of m.chart.result.vega_config: <proto.marshal.collections.maps.MapComposite object at 0x7ffbc8466fc0>
INFO:root:Sending response: {'response': 'The total Monthly Recurring Revenue (MRR) for each product line is displayed in the bar chart. The chart is sorted by total MRR in descending order, allowing for easy comparison of MRR across different product lines.', 'chartData': {'type': 'bar', 'title': 'Total MRR for Each Product Line', 'data': [{'total_mrr': 1113.85, 'product_line': 'born'}, {'total_mrr': 2366.3500000000004, 'product_line': 'safe'}, {'total_mrr': 2456.9700000000003, 'product_line': 'skill'}, {'total_mrr': 736.5100000000001, 'product_line': 'risk'}, {'total_mrr': 172.95, 'product_line': 'news'}, {'total_mrr': 3923.3900000000003, 'product_line': 'how'}, {'total_mrr': 1359.26, 'product_line': 'family'}, {'total_mrr': 786.3900000000001, 'product_line': 'exactly'}, {'total_mrr': 1370.04, 'product_line': 'beautiful'}, {'total_mrr': 3500.55, 'product_line': 'however'}, {'total_mrr': 2035.48, 'product_line': 'economic'}, {'total_mrr': 3024.29, 'product_line': 'party'}, {'total_mrr': 1131.11, 'product_line': 'president'}, {'total_mrr': 422.39, 'product_line': 'policy'}, {'total_mrr': 383.61, 'product_line': 'a'}, {'total_mrr': 259.87, 'product_line': 'allow'}, {'total_mrr': 1495.18, 'product_line': 'car'}, {'total_mrr': 1495.18, 'product_line': 'institution'}, {'total_mrr': 1443.57, 'product_line': 'draw'}, {'total_mrr': 2006.25, 'product_line': 'manage'}, {'total_mrr': 3472.27, 'product_line': 'suggest'}, {'total_mrr': 1519.66, 'product_line': 'power'}, {'total_mrr': 2106.48, 'product_line': 'site'}, {'total_mrr': 150.57, 'product_line': 'available'}, {'total_mrr': 606.88, 'product_line': 'from'}, {'total_mrr': 768.2099999999999, 'product_line': 'blue'}, {'total_mrr': 1704.0, 'product_line': 'appear'}, {'total_mrr': 4995.7, 'product_line': 'table'}, {'total_mrr': 1491.23, 'product_line': 'surface'}, {'total_mrr': 3916.2999999999997, 'product_line': 'already'}, {'total_mrr': 2512.5099999999998, 'product_line': 'society'}, {'total_mrr': 1981.58, 'product_line': 'expect'}, {'total_mrr': 2464.03, 'product_line': 'coach'}, {'total_mrr': 904.5999999999999, 'product_line': 'address'}, {'total_mrr': 1125.21, 'product_line': 'water'}, {'total_mrr': 526.67, 'product_line': 'break'}, {'total_mrr': 1307.77, 'product_line': 'guy'}, {'total_mrr': 1167.45, 'product_line': 'of'}, {'total_mrr': 1424.75, 'product_line': 'benefit'}, {'total_mrr': 1448.85, 'product_line': 'entire'}, {'total_mrr': 1181.54, 'product_line': 'leave'}, {'total_mrr': 335.11, 'product_line': 'must'}, {'total_mrr': 584.89, 'product_line': 'have'}, {'total_mrr': 780.3299999999999, 'product_line': 'lead'}, {'total_mrr': 3680.7499999999995, 'product_line': 'ever'}, {'total_mrr': 1457.99, 'product_line': 'make'}, {'total_mrr': 502.58, 'product_line': 'beyond'}, {'total_mrr': 341.05, 'product_line': 'Mr'}], 'xKey': 'product_line', 'yKey': 'total_mrr', 'nameKey': None}, 'sqlQuery': 'SELECT t2.product_line, SUM(t1.mrr) AS total_mrr\nFROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t1\nINNER JOIN `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t2\n  ON t1.product_id = t2.product_id\nGROUP BY t2.product_line;'}
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:routes.provisioning:Getting demo assets for job 73295ee6-56ae-4973-9fed-87dd3b133801
ERROR:routes.provisioning:Job 73295ee6-56ae-4973-9fed-87dd3b133801 not found
INFO:root:Received request: Show me our top 10 customers by revenue who own an Observability product but have not purchased an IT Service Management (ITSM) solution
INFO:root:Using agent: solarwinds_demo_20251006_0317, dataset: solarwinds_capi_demo_20251006
INFO:root:Sending response: {'response': 'There are no customers who meet the criteria of owning an Observability product but not an IT Service Management (ITSM) solution.', 'chartData': None, 'sqlQuery': "SELECT t2.customer_id, t2.customer_name, SUM(t1.mrr) AS total_mrr\nFROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t1\nINNER JOIN `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`customers` AS t2\n  ON t1.customer_id = t2.customer_id\nINNER JOIN `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t3\n  ON t1.product_id = t3.product_id\nWHERE\n  t1.status = 'active'\n  AND t2.customer_id IN (\n    SELECT DISTINCT t1.customer_id\n    FROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t1\n    INNER JOIN\n      `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t3\n      ON t1.product_id = t3.product_id\n    WHERE t1.status = 'active' AND t3.product_line = 'Observability'\n    EXCEPT DISTINCT\n    SELECT DISTINCT t1.customer_id\n    FROM `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`subscriptions` AS t1\n    INNER JOIN\n      `bq-demos-469816`.`solarwinds_capi_demo_20251006`.`products` AS t3\n      ON t1.product_id = t3.product_id\n    WHERE t1.status = 'active' AND t3.product_line = 'IT Service Management'\n  )\nGROUP BY t2.customer_id, t2.customer_name\nORDER BY total_mrr DESC\nLIMIT 10;"}
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:routes.provisioning:Created provisioning job 659aff67-b70c-4281-b7cb-dcf276673127 for https://www.shopify.com/
INFO:routes.provisioning:Starting provisioning workflow for job 659aff67-b70c-4281-b7cb-dcf276673127
INFO:agentic_service.demo_orchestrator:Starting demo orchestrator for job 659aff67-b70c-4281-b7cb-dcf276673127
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:Demo Orchestrator initialized
INFO:agentic_service.config.agent_config:✅ RESEARCH Agent: CustomerResearchAgentV2GeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DEMO_STORY Agent: DemoStoryAgentGeminiPro (GEMINI) [source: default]
INFO:agentic_service.config.agent_config:✅ DATA_MODELING Agent: DataModelingAgent (CLAUDE) [source: default]
INFO:agentic_service.config.agent_config:✅ CAPI Agent: CAPIInstructionGeneratorOptimized (CLAUDE) [source: default]
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.research_agent_v2_gemini_pro:Research Agent V2 GEMINI PRO initialized (max_concurrent=15)
INFO:agentic_service.utils.vertex_llm_client:Initialized Gemini via Vertex AI: gemini-2.5-pro in project bq-demos-469816, region us-central1
INFO:agentic_service.agents.demo_story_agent_gemini_pro:Demo Story Agent initialized with Gemini 2.5 Pro (PARALLEL MODE)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  Config: 6 queries, 4 scenes, 8 entities
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.data_modeling_agent:Data Modeling Agent initialized with Claude Sonnet 4.5
INFO:agentic_service.utils.vertex_llm_client:Initialized Claude via Vertex AI in project bq-demos-469816, region global
INFO:agentic_service.agents.capi_instruction_generator_optimized:CAPI Instruction Generator OPTIMIZED initialized
INFO:agentic_service.agents.synthetic_data_generator_optimized:Synthetic Data Generator OPTIMIZED initialized. Output: /tmp/synthetic_data
INFO:agentic_service.agents.infrastructure_agent_optimized:Infrastructure Agent OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.agents.demo_validator_optimized:Demo Validator OPTIMIZED initialized for project bq-demos-469816
INFO:agentic_service.demo_orchestrator:🚀 Pipeline initialized with config-based agent selection
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 1/7: Research Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🔍 Starting V2 Research (GEMINI PRO) for https://www.shopify.com/
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Phase 1: Gathering intelligence from multiple sources (PARALLEL)...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🚀 Launching 3 intelligence scrapers in PARALLEL...
INFO:agentic_service.tools.web_research:Scraping https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Starting OPTIMIZED crawl of https://www.shopify.com/ (max 15 concurrent)
INFO:agentic_service.tools.v2_job_scraper:Searching for job postings for Shopify
INFO:agentic_service.tools.web_research:Scraped 4901 characters from https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 50 URLs in sitemap
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:⭐ Extracting header and footer navigation links...
INFO:agentic_service.tools.v2_job_scraper:Found careers page: https://www.shopify.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Found 145 header/footer navigation links
INFO:agentic_service.tools.v2_job_scraper:Analyzed 0 data-related jobs, found 0 technologies
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (1/30): https://www.shopify.com/ng?country=ng&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (2/30): https://www.shopify.com/de?country=de&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (3/30): https://www.shopify.com/cl?country=cl&lang=es
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (4/30): https://www.shopify.com/pt?country=pt&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (5/30): https://www.shopify.com/mx?country=mx&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (6/30): https://www.shopify.com/legal
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (7/30): https://www.shopify.com/id-id?country=id&lang=id
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (8/30): https://www.shopify.com/about
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (9/30): https://www.shopify.com/gr?country=gr&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (10/30): https://www.shopify.com/tools/qr-code-generator
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (11/30): https://www.shopify.com/blog/topics/founder-stories
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (12/30): https://www.shopify.com/facebook-instagram
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (13/30): https://www.shopify.com/hu?country=hu&lang=hu
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (14/30): https://www.shopify.com/se?country=se&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (15/30): https://www.shopify.com/pe?country=pe&lang=en
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (16/30): https://www.shopify.com/partners/directory
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (17/30): https://www.shopify.com/blog/business-plan-template
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (18/30): https://www.shopify.com/legal/terms
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (19/30): https://www.shopify.com/online
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (20/30): https://www.shopify.com/ro?country=ro&lang=ro
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (21/30): https://www.shopify.com/lt?country=lt&lang=lt
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (22/30): https://www.shopify.com/de?country=de&lang=de
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (23/30): https://www.shopify.com/zh?country=us&lang=zh
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (24/30): https://www.shopify.com/fulfillment
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (25/30): https://www.shopify.com/kr?country=kr&lang=ko
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (26/30): https://www.shopify.com/careers
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (27/30): https://www.shopify.com/
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (28/30): https://www.shopify.com/ch?country=ch&lang=de
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (29/30): https://www.shopify.com/nl?country=nl&lang=nl
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:Crawled (30/30): https://www.shopify.com/by?country=by&lang=ru
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✓ Sufficient coverage: 3/3 key categories, 30 pages
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ Early termination: 30 pages provides sufficient coverage
INFO:agentic_service.tools.v2_intelligent_crawler_optimized:✅ OPTIMIZED crawl complete in 7.49s. Visited 30 pages
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ All 3 scrapers completed in 7.49s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: homepage
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: crawl
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✓ Completed: jobs
INFO:agentic_service.agents.research_agent_v2_gemini_pro:📊 Scraping summary: 3 succeeded, 0 failed
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 1 complete in 7.49s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🤖 Phase 2: Analyzing business model with Gemini 2.5 Pro...
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 2 complete in 30.22s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:🏗️ Phase 3: Inferring data architecture...
INFO:agentic_service.tools.v2_data_architect:Starting data architecture inference...
INFO:agentic_service.tools.v2_data_architect:Data architecture inference complete
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ Phase 3 complete in 82.86s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:✅ V2 Research (GEMINI PRO) complete in 120.58s!
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 1 (Intelligence): 7.49s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 2 (Analysis): 30.22s
INFO:agentic_service.agents.research_agent_v2_gemini_pro:   Phase 3 (Architecture): 82.86s
INFO:agentic_service.demo_orchestrator:✅ Research Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 2/7: Demo Story Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.demo_story_agent_gemini_pro:🚀 Creating demo narrative with PARALLEL execution (3 concurrent Gemini 2.5 Pro calls)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  → Launching 3 parallel Gemini 2.5 Pro tasks...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Starting (target: 4 scenes)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Starting (target: 6 queries)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Starting (target: 8 entities)...
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 1/3] Core Narrative: Complete in 41.5s
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 3/3] Data Specifications: Complete in 43.4s (8 entities)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:    [Task 2/3] Golden Queries: Complete in 55.0s (6 queries)
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  ✓ All parallel tasks completed successfully
INFO:agentic_service.agents.demo_story_agent_gemini_pro:✅ Demo story complete in 55.0s: 'Shopify: From Dashboards to Decisions with Conversational Commerce Intelligence'
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 6 golden queries
INFO:agentic_service.agents.demo_story_agent_gemini_pro:  - 4 story scenes
INFO:agentic_service.demo_orchestrator:✅ Demo Story Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 3/7: Data Modeling Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.data_modeling_agent:Designing BigQuery schema with Claude Sonnet 4.5 (story-driven)
INFO:httpx:HTTP Request: POST https://aiplatform.googleapis.com/v1/projects/bq-demos-469816/locations/global/publishers/anthropic/models/claude-sonnet-4-5@20250929:rawPredict "HTTP/1.1 200 OK"
INFO:agentic_service.agents.data_modeling_agent:Schema design complete. Created 11 tables
INFO:agentic_service.demo_orchestrator:✅ Data Modeling Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 4/7: Synthetic Data Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.synthetic_data_generator_optimized:🚀 Generating synthetic data with PARALLEL processing
WARNING:agentic_service.agents.synthetic_data_generator_optimized:Circular dependency detected. Adding 11 tables to final batch
INFO:agentic_service.agents.synthetic_data_generator_optimized:📊 Dependency analysis: 1 levels for parallel processing
INFO:agentic_service.agents.synthetic_data_generator_optimized:   Level 0: 11 tables (merchants, subscriptions, customers, products, orders, order_items, marketing_campaigns, behavioral_events, apps, app_installations, support_tickets)
INFO:agentic_service.agents.synthetic_data_generator_optimized:⚡ Processing level 1/1: 11 tables in PARALLEL
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ merchants: 800 rows → /tmp/synthetic_data/merchants.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ subscriptions: 800 rows → /tmp/synthetic_data/subscriptions.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ customers: 3,000 rows → /tmp/synthetic_data/customers.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ products: 3,000 rows → /tmp/synthetic_data/products.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ orders: 3,500 rows → /tmp/synthetic_data/orders.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ order_items: 3,500 rows → /tmp/synthetic_data/order_items.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ marketing_campaigns: 800 rows → /tmp/synthetic_data/marketing_campaigns.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ behavioral_events: 15,000 rows → /tmp/synthetic_data/behavioral_events.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ apps: 800 rows → /tmp/synthetic_data/apps.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ app_installations: 3,000 rows → /tmp/synthetic_data/app_installations.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:  ✓ support_tickets: 3,000 rows → /tmp/synthetic_data/support_tickets.csv
INFO:agentic_service.agents.synthetic_data_generator_optimized:✅ Data generation complete in 2.23s. 11 CSV files created
INFO:agentic_service.demo_orchestrator:✅ Synthetic Data Generator complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 5/7: Infrastructure Agent
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.infrastructure_agent_optimized:🚀 Provisioning BigQuery infrastructure (OPTIMIZED)
WARNING:agentic_service.agents.infrastructure_agent_optimized:Dataset shopify_capi_demo_20251006 already exists, using existing
INFO:agentic_service.agents.infrastructure_agent_optimized:⚡ Processing 11 tables IN PARALLEL...
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: products
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: behavioral_events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: customers
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: merchants
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: orders
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 15,000 rows into behavioral_events
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: apps
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into orders
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: app_installations
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into subscriptions
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into marketing_campaigns
INFO:agentic_service.agents.infrastructure_agent_optimized:Created table: support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into customers
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into merchants
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into products
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,500 rows into order_items
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 800 rows into apps
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into app_installations
INFO:agentic_service.agents.infrastructure_agent_optimized:  ✓ Loaded 3,000 rows into support_tickets
INFO:agentic_service.agents.infrastructure_agent_optimized:Creating CAPI Data Agent...
INFO:agentic_service.agents.infrastructure_agent_optimized:📄 Demo report generated: /tmp/DEMO_REPORT_shopify_capi_demo_20251006.md
WARNING:agentic_service.agents.infrastructure_agent_optimized:No YAML system instructions found, using basic config
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: shopify_demo_20251006_0358
INFO:agentic_service.agents.infrastructure_agent_optimized:   Display Name: Shopify CAPI Demo Agent 20251006_0358
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.shopify_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Created CAPI Data Agent: shopify_demo_20251006_0358
INFO:agentic_service.agents.infrastructure_agent_optimized:✅ Infrastructure provisioned in 7.05s: shopify_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Dataset: bq-demos-469816.shopify_capi_demo_20251006
INFO:agentic_service.agents.infrastructure_agent_optimized:   Tables: 11
INFO:agentic_service.agents.infrastructure_agent_optimized:   Total rows: 37,200
INFO:agentic_service.agents.infrastructure_agent_optimized:   CAPI Agent: shopify_demo_20251006_0358
INFO:agentic_service.demo_orchestrator:✅ Infrastructure Agent complete
INFO:agentic_service.demo_orchestrator:
================================================================================
INFO:agentic_service.demo_orchestrator:STAGE 6/7: CAPI Instruction Generator
INFO:agentic_service.demo_orchestrator:================================================================================
INFO:agentic_service.agents.capi_instruction_generator_optimized:🚀 Generating CAPI system instructions (YAML) - OPTIMIZED
INFO:agentic_service.agents.capi_instruction_generator_optimized:Calling Claude 4.5 to generate YAML...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
INFO:root:🔧 Creating CAPI Data Agent...
